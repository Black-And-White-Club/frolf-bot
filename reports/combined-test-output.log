	github.com/Black-And-White-Club/frolf-bot/app		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard		coverage: 0.0% of statements
=== RUN   TestLeaderboardService_ProcessTagAssignments
=== RUN   TestLeaderboardService_ProcessTagAssignments/Successfully_assigns_tags_in_batch
=== RUN   TestLeaderboardService_ProcessTagAssignments/Single_user_creation_returns_TagAssigned_event
=== RUN   TestLeaderboardService_ProcessTagAssignments/Score_processing_returns_LeaderboardUpdated_event
=== RUN   TestLeaderboardService_ProcessTagAssignments/Single_assignment_with_swap_needed
=== RUN   TestLeaderboardService_ProcessTagAssignments/Invalid_tag_assignments_filtered_out_in_batch
=== RUN   TestLeaderboardService_ProcessTagAssignments/Database_error_on_UpdateLeaderboard
=== RUN   TestLeaderboardService_ProcessTagAssignments/No_valid_assignments_in_batch
=== RUN   TestLeaderboardService_ProcessTagAssignments/Empty_assignments_list
=== RUN   TestLeaderboardService_ProcessTagAssignments/GetActiveLeaderboard_fails
=== RUN   TestLeaderboardService_ProcessTagAssignments/String_source_type_-_user_creation
=== RUN   TestLeaderboardService_ProcessTagAssignments/String_source_type_-_defaults_to_manual
=== RUN   TestLeaderboardService_ProcessTagAssignments/Invalid_source_type
=== RUN   TestLeaderboardService_ProcessTagAssignments/Batch_operation_with_swap_needed_-_should_skip
=== RUN   TestLeaderboardService_ProcessTagAssignments/Single_assignment_with_prepare_failure_for_existing_user
=== RUN   TestLeaderboardService_ProcessTagAssignments/Single_assignment_-_user_already_has_tag_(no-op)
=== RUN   TestLeaderboardService_ProcessTagAssignments/Multiple_user_creation_uses_batch_response
=== RUN   TestLeaderboardService_ProcessTagAssignments/Unknown_source_type_uses_fallback_batch_response
=== RUN   TestLeaderboardService_ProcessTagAssignments/Validation_uses_PrepareTagUpdateForExistingUser_path
=== RUN   TestLeaderboardService_ProcessTagAssignments/Score_processing_with_UpdateLeaderboard_failure
--- PASS: TestLeaderboardService_ProcessTagAssignments (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Successfully_assigns_tags_in_batch (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Single_user_creation_returns_TagAssigned_event (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Score_processing_returns_LeaderboardUpdated_event (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Single_assignment_with_swap_needed (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Invalid_tag_assignments_filtered_out_in_batch (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Database_error_on_UpdateLeaderboard (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/No_valid_assignments_in_batch (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Empty_assignments_list (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/GetActiveLeaderboard_fails (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/String_source_type_-_user_creation (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/String_source_type_-_defaults_to_manual (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Invalid_source_type (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Batch_operation_with_swap_needed_-_should_skip (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Single_assignment_with_prepare_failure_for_existing_user (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Single_assignment_-_user_already_has_tag_(no-op) (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Multiple_user_creation_uses_batch_response (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Unknown_source_type_uses_fallback_batch_response (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Validation_uses_PrepareTagUpdateForExistingUser_path (0.00s)
    --- PASS: TestLeaderboardService_ProcessTagAssignments/Score_processing_with_UpdateLeaderboard_failure (0.00s)
=== RUN   TestLeaderboardService_GetLeaderboard
=== RUN   TestLeaderboardService_GetLeaderboard/Successfully_retrieves_leaderboard
=== RUN   TestLeaderboardService_GetLeaderboard/Fails_to_fetch_active_leaderboard
=== RUN   TestLeaderboardService_GetLeaderboard/Successfully_retrieves_empty_leaderboard
=== RUN   TestLeaderboardService_GetLeaderboard/Successfully_retrieves_leaderboard_with_mixed_tag_numbers
=== RUN   TestLeaderboardService_GetLeaderboard/Handles_no_active_leaderboard
--- PASS: TestLeaderboardService_GetLeaderboard (0.00s)
    --- PASS: TestLeaderboardService_GetLeaderboard/Successfully_retrieves_leaderboard (0.00s)
    --- PASS: TestLeaderboardService_GetLeaderboard/Fails_to_fetch_active_leaderboard (0.00s)
    --- PASS: TestLeaderboardService_GetLeaderboard/Successfully_retrieves_empty_leaderboard (0.00s)
    --- PASS: TestLeaderboardService_GetLeaderboard/Successfully_retrieves_leaderboard_with_mixed_tag_numbers (0.00s)
    --- PASS: TestLeaderboardService_GetLeaderboard/Handles_no_active_leaderboard (0.00s)
=== RUN   TestLeaderboardService_GetTagByUserID
=== RUN   TestLeaderboardService_GetTagByUserID/Successfully_retrieves_tag_number
=== RUN   TestLeaderboardService_GetTagByUserID/Fails_to_retrieve_tag_number_due_to_unexpected_DB_error
=== RUN   TestLeaderboardService_GetTagByUserID/User_ID_not_found_in_database_(sql.ErrNoRows)
=== RUN   TestLeaderboardService_GetTagByUserID/No_active_leaderboard_found
=== RUN   TestLeaderboardService_GetTagByUserID/Nil_tag_number_returned_(should_not_happen_with_sql.ErrNoRows_handling,_but_testing_robustness)
--- PASS: TestLeaderboardService_GetTagByUserID (0.00s)
    --- PASS: TestLeaderboardService_GetTagByUserID/Successfully_retrieves_tag_number (0.00s)
    --- PASS: TestLeaderboardService_GetTagByUserID/Fails_to_retrieve_tag_number_due_to_unexpected_DB_error (0.00s)
    --- PASS: TestLeaderboardService_GetTagByUserID/User_ID_not_found_in_database_(sql.ErrNoRows) (0.00s)
    --- PASS: TestLeaderboardService_GetTagByUserID/No_active_leaderboard_found (0.00s)
    --- PASS: TestLeaderboardService_GetTagByUserID/Nil_tag_number_returned_(should_not_happen_with_sql.ErrNoRows_handling,_but_testing_robustness) (0.00s)
=== RUN   TestLeaderboardService_RoundGetTagByUserID
=== RUN   TestLeaderboardService_RoundGetTagByUserID/Successfully_retrieves_tag_number
=== RUN   TestLeaderboardService_RoundGetTagByUserID/Fails_to_retrieve_tag_number_(operational_error)
=== RUN   TestLeaderboardService_RoundGetTagByUserID/User_ID_not_found_in_database_(sql.ErrNoRows)
=== RUN   TestLeaderboardService_RoundGetTagByUserID/User_ID_not_found_in_database_(string_match)
=== RUN   TestLeaderboardService_RoundGetTagByUserID/Nil_tag_number_returned_from_database
=== RUN   TestLeaderboardService_RoundGetTagByUserID/Handles_no_active_leaderboard_(Round)
--- PASS: TestLeaderboardService_RoundGetTagByUserID (0.00s)
    --- PASS: TestLeaderboardService_RoundGetTagByUserID/Successfully_retrieves_tag_number (0.00s)
    --- PASS: TestLeaderboardService_RoundGetTagByUserID/Fails_to_retrieve_tag_number_(operational_error) (0.00s)
    --- PASS: TestLeaderboardService_RoundGetTagByUserID/User_ID_not_found_in_database_(sql.ErrNoRows) (0.00s)
    --- PASS: TestLeaderboardService_RoundGetTagByUserID/User_ID_not_found_in_database_(string_match) (0.00s)
    --- PASS: TestLeaderboardService_RoundGetTagByUserID/Nil_tag_number_returned_from_database (0.00s)
    --- PASS: TestLeaderboardService_RoundGetTagByUserID/Handles_no_active_leaderboard_(Round) (0.00s)
=== RUN   TestNewLeaderboardService
=== RUN   TestNewLeaderboardService/Creates_service_with_all_dependencies
=== RUN   TestNewLeaderboardService/Handles_nil_dependencies
--- PASS: TestNewLeaderboardService (0.00s)
    --- PASS: TestNewLeaderboardService/Creates_service_with_all_dependencies (0.00s)
    --- PASS: TestNewLeaderboardService/Handles_nil_dependencies (0.00s)
=== RUN   Test_serviceWrapper
=== RUN   Test_serviceWrapper/successful_operation
=== RUN   Test_serviceWrapper/failed_operation
=== RUN   Test_serviceWrapper/panic_recovery
=== RUN   Test_serviceWrapper/nil_service_function
--- PASS: Test_serviceWrapper (0.00s)
    --- PASS: Test_serviceWrapper/successful_operation (0.00s)
    --- PASS: Test_serviceWrapper/failed_operation (0.00s)
    --- PASS: Test_serviceWrapper/panic_recovery (0.00s)
    --- PASS: Test_serviceWrapper/nil_service_function (0.00s)
=== RUN   TestLeaderboardService_CheckTagAvailability
=== RUN   TestLeaderboardService_CheckTagAvailability/Successfully_checks_available_tag
=== RUN   TestLeaderboardService_CheckTagAvailability/Successfully_checks_unavailable_tag
=== RUN   TestLeaderboardService_CheckTagAvailability/Database_error_when_checking_tag
--- PASS: TestLeaderboardService_CheckTagAvailability (0.00s)
    --- PASS: TestLeaderboardService_CheckTagAvailability/Successfully_checks_available_tag (0.00s)
    --- PASS: TestLeaderboardService_CheckTagAvailability/Successfully_checks_unavailable_tag (0.00s)
    --- PASS: TestLeaderboardService_CheckTagAvailability/Database_error_when_checking_tag (0.00s)
=== RUN   TestLeaderboardService_TagSwapRequested
=== RUN   TestLeaderboardService_TagSwapRequested/Successful_tag_swap
=== RUN   TestLeaderboardService_TagSwapRequested/Cannot_swap_tag_with_self
=== RUN   TestLeaderboardService_TagSwapRequested/No_active_leaderboard_found
=== RUN   TestLeaderboardService_TagSwapRequested/Database_error_while_fetching_leaderboard
=== RUN   TestLeaderboardService_TagSwapRequested/Requestor_does_not_have_a_tag
=== RUN   TestLeaderboardService_TagSwapRequested/Target_does_not_have_a_tag
=== RUN   TestLeaderboardService_TagSwapRequested/Neither_user_has_a_tag
=== RUN   TestLeaderboardService_TagSwapRequested/Database_error_while_swapping_tags
--- PASS: TestLeaderboardService_TagSwapRequested (0.00s)
    --- PASS: TestLeaderboardService_TagSwapRequested/Successful_tag_swap (0.00s)
    --- PASS: TestLeaderboardService_TagSwapRequested/Cannot_swap_tag_with_self (0.00s)
    --- PASS: TestLeaderboardService_TagSwapRequested/No_active_leaderboard_found (0.00s)
    --- PASS: TestLeaderboardService_TagSwapRequested/Database_error_while_fetching_leaderboard (0.00s)
    --- PASS: TestLeaderboardService_TagSwapRequested/Requestor_does_not_have_a_tag (0.00s)
    --- PASS: TestLeaderboardService_TagSwapRequested/Target_does_not_have_a_tag (0.00s)
    --- PASS: TestLeaderboardService_TagSwapRequested/Neither_user_has_a_tag (0.00s)
    --- PASS: TestLeaderboardService_TagSwapRequested/Database_error_while_swapping_tags (0.00s)
=== RUN   TestGenerateUpdatedLeaderboardData
=== RUN   TestGenerateUpdatedLeaderboardData/Basic_redistribution_with_existing_users
=== RUN   TestGenerateUpdatedLeaderboardData/Scenario_with_gaps_in_tag_numbers_and_non-participants
=== RUN   TestGenerateUpdatedLeaderboardData/Empty_participant_tags
=== RUN   TestGenerateUpdatedLeaderboardData/Invalid_tag_format_in_participant_tags
time=2025-05-31T08:59:09.142-05:00 level=ERROR msg="Invalid sorted participant tag format" tag_user_string=invalid-tag-user
=== RUN   TestGenerateUpdatedLeaderboardData/Invalid_tag_number_in_participant_tags
time=2025-05-31T08:59:09.142-05:00 level=ERROR msg="Failed to parse tag number from sorted participant tag" tag_string=abc error="strconv.Atoi: parsing \"abc\": invalid syntax"
--- PASS: TestGenerateUpdatedLeaderboardData (0.00s)
    --- PASS: TestGenerateUpdatedLeaderboardData/Basic_redistribution_with_existing_users (0.00s)
    --- PASS: TestGenerateUpdatedLeaderboardData/Scenario_with_gaps_in_tag_numbers_and_non-participants (0.00s)
    --- PASS: TestGenerateUpdatedLeaderboardData/Empty_participant_tags (0.00s)
    --- PASS: TestGenerateUpdatedLeaderboardData/Invalid_tag_format_in_participant_tags (0.00s)
    --- PASS: TestGenerateUpdatedLeaderboardData/Invalid_tag_number_in_participant_tags (0.00s)
=== RUN   TestGenerateUpdatedLeaderboardData_LargeNumberOfParticipants
--- PASS: TestGenerateUpdatedLeaderboardData_LargeNumberOfParticipants (0.00s)
PASS
coverage: 8.8% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard/application	0.535s	coverage: 8.8% of statements in ./app/...
	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard/application/mocks		coverage: 0.0% of statements
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Successfully_handle_BatchTagAssignmentRequested
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Fail_to_unmarshal_payload
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Invalid_batch_ID_format
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Service_failure_in_ProcessTagAssignments
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Service_success_but_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Service_failure_with_custom_failure_payload
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Service_failure_with_error_and_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Unknown_result_from_ProcessTagAssignments
=== RUN   TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Empty_assignments_batch
--- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Successfully_handle_BatchTagAssignmentRequested (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Invalid_batch_ID_format (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Service_failure_in_ProcessTagAssignments (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Service_failure_with_custom_failure_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Service_failure_with_error_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Unknown_result_from_ProcessTagAssignments (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleBatchTagAssignmentRequested/Empty_assignments_batch (0.00s)
=== RUN   TestNewLeaderboardHandlers
=== RUN   TestNewLeaderboardHandlers/Creates_handlers_with_all_dependencies
=== RUN   TestNewLeaderboardHandlers/Handles_nil_dependencies
--- PASS: TestNewLeaderboardHandlers (0.00s)
    --- PASS: TestNewLeaderboardHandlers/Creates_handlers_with_all_dependencies (0.00s)
    --- PASS: TestNewLeaderboardHandlers/Handles_nil_dependencies (0.00s)
=== RUN   Test_handlerWrapper
=== RUN   Test_handlerWrapper/Successful_handler_execution
=== RUN   Test_handlerWrapper/Handler_returns_error
=== RUN   Test_handlerWrapper/Unmarshal_payload_fails
=== RUN   Test_handlerWrapper/Unmarshal_payload_succeeds
--- PASS: Test_handlerWrapper (0.00s)
    --- PASS: Test_handlerWrapper/Successful_handler_execution (0.00s)
    --- PASS: Test_handlerWrapper/Handler_returns_error (0.00s)
    --- PASS: Test_handlerWrapper/Unmarshal_payload_fails (0.00s)
    --- PASS: Test_handlerWrapper/Unmarshal_payload_succeeds (0.00s)
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Successfully_handle_LeaderboardUpdateRequested
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Fail_to_unmarshal_payload
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Invalid_tag_format_-_missing_colon
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Invalid_tag_number_format
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Service_failure_in_ProcessTagAssignments
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Service_success_but_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Service_failure_with_custom_failure_payload
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Service_failure_with_error_and_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Unknown_result_from_ProcessTagAssignments
--- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Successfully_handle_LeaderboardUpdateRequested (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Invalid_tag_format_-_missing_colon (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Invalid_tag_number_format (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Service_failure_in_ProcessTagAssignments (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Service_failure_with_custom_failure_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Service_failure_with_error_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleLeaderboardUpdateRequested/Unknown_result_from_ProcessTagAssignments (0.00s)
=== RUN   TestLeaderboardHandlers_HandleGetLeaderboardRequest
=== RUN   TestLeaderboardHandlers_HandleGetLeaderboardRequest/Successfully_handle_GetLeaderboardRequest
=== RUN   TestLeaderboardHandlers_HandleGetLeaderboardRequest/Fail_to_unmarshal_payload
=== RUN   TestLeaderboardHandlers_HandleGetLeaderboardRequest/Service_failure_in_GetLeaderboard
=== RUN   TestLeaderboardHandlers_HandleGetLeaderboardRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleGetLeaderboardRequest/Service_failure_with_non-error_result
=== RUN   TestLeaderboardHandlers_HandleGetLeaderboardRequest/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleGetLeaderboardRequest/Unknown_result_from_GetLeaderboard
--- PASS: TestLeaderboardHandlers_HandleGetLeaderboardRequest (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetLeaderboardRequest/Successfully_handle_GetLeaderboardRequest (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetLeaderboardRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetLeaderboardRequest/Service_failure_in_GetLeaderboard (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetLeaderboardRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetLeaderboardRequest/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetLeaderboardRequest/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetLeaderboardRequest/Unknown_result_from_GetLeaderboard (0.00s)
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Successfully_handle_RoundGetTagRequest_-_Tag_Found
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Successfully_handle_RoundGetTagRequest_-_Tag_Not_Found
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Fail_to_unmarshal_payload
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_unexpected_system_error
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_success_but_CreateResultMessage_fails_(Tag_Found)
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_success_but_CreateResultMessage_fails_(Tag_Not_Found)
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_business_failure_(Failure_field)
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_business_failure_but_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_system_error_within_result_(Error_field)
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_system_error_within_result_but_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_unexpected_nil_result_fields
=== RUN   TestLeaderboardHandlers_HandleRoundGetTagRequest/Invalid_payload_type_from_UnmarshalPayload
--- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Successfully_handle_RoundGetTagRequest_-_Tag_Found (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Successfully_handle_RoundGetTagRequest_-_Tag_Not_Found (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_unexpected_system_error (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_success_but_CreateResultMessage_fails_(Tag_Found) (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_success_but_CreateResultMessage_fails_(Tag_Not_Found) (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_business_failure_(Failure_field) (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_business_failure_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_system_error_within_result_(Error_field) (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_system_error_within_result_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Service_returns_unexpected_nil_result_fields (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleRoundGetTagRequest/Invalid_payload_type_from_UnmarshalPayload (0.00s)
=== RUN   TestLeaderboardHandlers_HandleGetTagByUserIDRequest
=== RUN   TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Successfully_handle_GetTagByUserIDRequest_-_Tag_Found
=== RUN   TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Successfully_handle_GetTagByUserIDRequest_-_Tag_Not_Found
=== RUN   TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Fail_to_unmarshal_payload
=== RUN   TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_returns_unexpected_system_error
=== RUN   TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_returns_business_failure_(Failure_field)
=== RUN   TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_returns_system_error_within_result_(Error_field)
=== RUN   TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_returns_unexpected_nil_result_fields
--- PASS: TestLeaderboardHandlers_HandleGetTagByUserIDRequest (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Successfully_handle_GetTagByUserIDRequest_-_Tag_Found (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Successfully_handle_GetTagByUserIDRequest_-_Tag_Not_Found (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_returns_unexpected_system_error (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_returns_business_failure_(Failure_field) (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_returns_system_error_within_result_(Error_field) (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleGetTagByUserIDRequest/Service_returns_unexpected_nil_result_fields (0.00s)
=== RUN   TestLeaderboardHandlers_HandleTagAssignment
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Successfully_handle_TagAssignmentRequested_-_manual_source
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Successfully_handle_TagAssignmentRequested_-_user_creation_source
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Handles_tag_swap_flow
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Handles_tag_swap_flow_but_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Fail_to_unmarshal_payload
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Service_failure_in_ProcessTagAssignments
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Service_success_but_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Service_failure_with_non-error_result
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleTagAssignment/Unknown_result_from_ProcessTagAssignments
--- PASS: TestLeaderboardHandlers_HandleTagAssignment (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Successfully_handle_TagAssignmentRequested_-_manual_source (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Successfully_handle_TagAssignmentRequested_-_user_creation_source (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Handles_tag_swap_flow (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Handles_tag_swap_flow_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Service_failure_in_ProcessTagAssignments (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAssignment/Unknown_result_from_ProcessTagAssignments (0.00s)
=== RUN   TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested
=== RUN   TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Successfully_handle_TagAvailabilityCheckRequested_-_Tag_Available
=== RUN   TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Fail_to_unmarshal_payload
=== RUN   TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Service_failure_in_CheckTagAvailability
=== RUN   TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Service_success_but_first_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Service_success_but_second_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Tag_is_not_available
=== RUN   TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Service_failure_with_failure_payload
--- PASS: TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Successfully_handle_TagAvailabilityCheckRequested_-_Tag_Available (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Service_failure_in_CheckTagAvailability (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Service_success_but_first_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Service_success_but_second_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Tag_is_not_available (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagAvailabilityCheckRequested/Service_failure_with_failure_payload (0.00s)
=== RUN   TestLeaderboardHandlers_HandleTagSwapRequested
=== RUN   TestLeaderboardHandlers_HandleTagSwapRequested/Successfully_handle_TagSwapRequested
=== RUN   TestLeaderboardHandlers_HandleTagSwapRequested/Fail_to_unmarshal_payload
=== RUN   TestLeaderboardHandlers_HandleTagSwapRequested/Service_failure_in_TagSwapRequested
=== RUN   TestLeaderboardHandlers_HandleTagSwapRequested/Service_success_but_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleTagSwapRequested/Service_failure_with_non-error_result
=== RUN   TestLeaderboardHandlers_HandleTagSwapRequested/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestLeaderboardHandlers_HandleTagSwapRequested/Unknown_result_from_TagSwapRequested
--- PASS: TestLeaderboardHandlers_HandleTagSwapRequested (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagSwapRequested/Successfully_handle_TagSwapRequested (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagSwapRequested/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagSwapRequested/Service_failure_in_TagSwapRequested (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagSwapRequested/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagSwapRequested/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagSwapRequested/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestLeaderboardHandlers_HandleTagSwapRequested/Unknown_result_from_TagSwapRequested (0.00s)
PASS
coverage: 7.2% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard/infrastructure/handlers	0.943s	coverage: 7.2% of statements in ./app/...
	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard/infrastructure/handlers/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard/infrastructure/repositories		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard/infrastructure/repositories/migrations		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard/infrastructure/repositories/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard/infrastructure/router		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/leaderboard/infrastructure/router/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/round		coverage: 0.0% of statements
=== RUN   TestRoundService_ValidateAndProcessRound
=== RUN   TestRoundService_ValidateAndProcessRound/valid_round
=== RUN   TestRoundService_ValidateAndProcessRound/invalid_round
=== RUN   TestRoundService_ValidateAndProcessRound/invalid_timezone
=== RUN   TestRoundService_ValidateAndProcessRound/start_time_in_the_past
--- PASS: TestRoundService_ValidateAndProcessRound (0.00s)
    --- PASS: TestRoundService_ValidateAndProcessRound/valid_round (0.00s)
    --- PASS: TestRoundService_ValidateAndProcessRound/invalid_round (0.00s)
    --- PASS: TestRoundService_ValidateAndProcessRound/invalid_timezone (0.00s)
    --- PASS: TestRoundService_ValidateAndProcessRound/start_time_in_the_past (0.00s)
=== RUN   TestRoundService_StoreRound
=== RUN   TestRoundService_StoreRound/store_round_successfully
=== RUN   TestRoundService_StoreRound/store_round_fails
=== RUN   TestRoundService_StoreRound/database_error
=== RUN   TestRoundService_StoreRound/invalid_round_data
--- PASS: TestRoundService_StoreRound (0.00s)
    --- PASS: TestRoundService_StoreRound/store_round_successfully (0.00s)
    --- PASS: TestRoundService_StoreRound/store_round_fails (0.00s)
    --- PASS: TestRoundService_StoreRound/database_error (0.00s)
    --- PASS: TestRoundService_StoreRound/invalid_round_data (0.00s)
=== RUN   TestRoundService_ValidateRoundDeleteRequest
=== RUN   TestRoundService_ValidateRoundDeleteRequest/valid_round_delete_request
=== RUN   TestRoundService_ValidateRoundDeleteRequest/invalid_round_delete_request_-_zero_round_ID
=== RUN   TestRoundService_ValidateRoundDeleteRequest/invalid_round_delete_request_-_empty_requesting_user_ID
--- PASS: TestRoundService_ValidateRoundDeleteRequest (0.00s)
    --- PASS: TestRoundService_ValidateRoundDeleteRequest/valid_round_delete_request (0.00s)
    --- PASS: TestRoundService_ValidateRoundDeleteRequest/invalid_round_delete_request_-_zero_round_ID (0.00s)
    --- PASS: TestRoundService_ValidateRoundDeleteRequest/invalid_round_delete_request_-_empty_requesting_user_ID (0.00s)
=== RUN   TestRoundService_DeleteRound
=== RUN   TestRoundService_DeleteRound/delete_round_successfully
=== RUN   TestRoundService_DeleteRound/delete_round_fails_-_delete_round_error
=== RUN   TestRoundService_DeleteRound/delete_round_succeeds_despite_cancel_scheduled_message_error
=== RUN   TestRoundService_DeleteRound/delete_round_fails_-_nil_UUID_provided
--- PASS: TestRoundService_DeleteRound (0.00s)
    --- PASS: TestRoundService_DeleteRound/delete_round_successfully (0.00s)
    --- PASS: TestRoundService_DeleteRound/delete_round_fails_-_delete_round_error (0.00s)
    --- PASS: TestRoundService_DeleteRound/delete_round_succeeds_despite_cancel_scheduled_message_error (0.00s)
    --- PASS: TestRoundService_DeleteRound/delete_round_fails_-_nil_UUID_provided (0.00s)
=== RUN   TestRoundService_FinalizeRound
=== RUN   TestRoundService_FinalizeRound/success_finalizing_round
=== RUN   TestRoundService_FinalizeRound/failure_updating_round_state
=== RUN   TestRoundService_FinalizeRound/failure_fetching_round_after_update
--- PASS: TestRoundService_FinalizeRound (0.00s)
    --- PASS: TestRoundService_FinalizeRound/success_finalizing_round (0.00s)
    --- PASS: TestRoundService_FinalizeRound/failure_updating_round_state (0.00s)
    --- PASS: TestRoundService_FinalizeRound/failure_fetching_round_after_update (0.00s)
=== RUN   TestRoundService_NotifyScoreModule
=== RUN   TestRoundService_NotifyScoreModule/success_notifying_score_module_with_various_participants
=== RUN   TestRoundService_NotifyScoreModule/success_notifying_score_module_with_no_participants
=== RUN   TestRoundService_NotifyScoreModule/success_notifying_score_module_with_nil_participants
--- PASS: TestRoundService_NotifyScoreModule (0.00s)
    --- PASS: TestRoundService_NotifyScoreModule/success_notifying_score_module_with_various_participants (0.00s)
    --- PASS: TestRoundService_NotifyScoreModule/success_notifying_score_module_with_no_participants (0.00s)
    --- PASS: TestRoundService_NotifyScoreModule/success_notifying_score_module_with_nil_participants (0.00s)
=== RUN   TestRoundService_CheckParticipantStatus
=== RUN   TestRoundService_CheckParticipantStatus/new_participant_joining
=== RUN   TestRoundService_CheckParticipantStatus/participant_changing_status
=== RUN   TestRoundService_CheckParticipantStatus/toggle_participant_status_(same_status_clicked)
=== RUN   TestRoundService_CheckParticipantStatus/failure_checking_participant_status
--- PASS: TestRoundService_CheckParticipantStatus (0.00s)
    --- PASS: TestRoundService_CheckParticipantStatus/new_participant_joining (0.00s)
    --- PASS: TestRoundService_CheckParticipantStatus/participant_changing_status (0.00s)
    --- PASS: TestRoundService_CheckParticipantStatus/toggle_participant_status_(same_status_clicked) (0.00s)
    --- PASS: TestRoundService_CheckParticipantStatus/failure_checking_participant_status (0.00s)
=== RUN   TestRoundService_ValidateParticipantJoinRequest
=== RUN   TestRoundService_ValidateParticipantJoinRequest/success_validating_participant_join_request
=== RUN   TestRoundService_ValidateParticipantJoinRequest/failure_validating_participant_join_request
--- PASS: TestRoundService_ValidateParticipantJoinRequest (0.00s)
    --- PASS: TestRoundService_ValidateParticipantJoinRequest/success_validating_participant_join_request (0.00s)
    --- PASS: TestRoundService_ValidateParticipantJoinRequest/failure_validating_participant_join_request (0.00s)
=== RUN   TestRoundService_ParticipantRemoval
=== RUN   TestRoundService_ParticipantRemoval/success_removing_participant
=== RUN   TestRoundService_ParticipantRemoval/success_when_participant_not_found
=== RUN   TestRoundService_ParticipantRemoval/failure_fetching_round_details_before_removal
=== RUN   TestRoundService_ParticipantRemoval/failure_removing_participant_from_database
--- PASS: TestRoundService_ParticipantRemoval (0.00s)
    --- PASS: TestRoundService_ParticipantRemoval/success_removing_participant (0.00s)
    --- PASS: TestRoundService_ParticipantRemoval/success_when_participant_not_found (0.00s)
    --- PASS: TestRoundService_ParticipantRemoval/failure_fetching_round_details_before_removal (0.00s)
    --- PASS: TestRoundService_ParticipantRemoval/failure_removing_participant_from_database (0.00s)
=== RUN   TestRoundService_UpdateParticipantStatus
=== RUN   TestRoundService_UpdateParticipantStatus/success_updating_participant_status_(Decline)
=== RUN   TestRoundService_UpdateParticipantStatus/success_updating_participant_status_with_tag_(Accept)
=== RUN   TestRoundService_UpdateParticipantStatus/success_triggering_tag_lookup_(Accept_without_tag)
=== RUN   TestRoundService_UpdateParticipantStatus/failure_fetching_round_details_for_decline_update
=== RUN   TestRoundService_UpdateParticipantStatus/failure_updating_participant_status_in_DB_(Decline)
=== RUN   TestRoundService_UpdateParticipantStatus/failure_fetching_round_details_for_tag_update
=== RUN   TestRoundService_UpdateParticipantStatus/failure_updating_participant_with_tag_in_DB
=== RUN   TestRoundService_UpdateParticipantStatus/unknown_response_type
--- PASS: TestRoundService_UpdateParticipantStatus (0.00s)
    --- PASS: TestRoundService_UpdateParticipantStatus/success_updating_participant_status_(Decline) (0.00s)
    --- PASS: TestRoundService_UpdateParticipantStatus/success_updating_participant_status_with_tag_(Accept) (0.00s)
    --- PASS: TestRoundService_UpdateParticipantStatus/success_triggering_tag_lookup_(Accept_without_tag) (0.00s)
    --- PASS: TestRoundService_UpdateParticipantStatus/failure_fetching_round_details_for_decline_update (0.00s)
    --- PASS: TestRoundService_UpdateParticipantStatus/failure_updating_participant_status_in_DB_(Decline) (0.00s)
    --- PASS: TestRoundService_UpdateParticipantStatus/failure_fetching_round_details_for_tag_update (0.00s)
    --- PASS: TestRoundService_UpdateParticipantStatus/failure_updating_participant_with_tag_in_DB (0.00s)
    --- PASS: TestRoundService_UpdateParticipantStatus/unknown_response_type (0.00s)
=== RUN   TestRoundService_UpdateScheduledRoundsWithNewTags
=== RUN   TestRoundService_UpdateScheduledRoundsWithNewTags/successful_update_with_valid_tags
=== RUN   TestRoundService_UpdateScheduledRoundsWithNewTags/error_fetching_rounds
=== RUN   TestRoundService_UpdateScheduledRoundsWithNewTags/error_updating_rounds
=== RUN   TestRoundService_UpdateScheduledRoundsWithNewTags/no_updates_needed_-_empty_changedTags
--- PASS: TestRoundService_UpdateScheduledRoundsWithNewTags (0.00s)
    --- PASS: TestRoundService_UpdateScheduledRoundsWithNewTags/successful_update_with_valid_tags (0.00s)
    --- PASS: TestRoundService_UpdateScheduledRoundsWithNewTags/error_fetching_rounds (0.00s)
    --- PASS: TestRoundService_UpdateScheduledRoundsWithNewTags/error_updating_rounds (0.00s)
    --- PASS: TestRoundService_UpdateScheduledRoundsWithNewTags/no_updates_needed_-_empty_changedTags (0.00s)
=== RUN   TestRoundService_GetRound
=== RUN   TestRoundService_GetRound/successful_retrieval
=== RUN   TestRoundService_GetRound/error_retrieving_round
--- PASS: TestRoundService_GetRound (0.00s)
    --- PASS: TestRoundService_GetRound/successful_retrieval (0.00s)
    --- PASS: TestRoundService_GetRound/error_retrieving_round (0.00s)
=== RUN   TestRoundService_ProcessRoundReminder
=== RUN   TestRoundService_ProcessRoundReminder/successful_processing_with_participants
=== RUN   TestRoundService_ProcessRoundReminder/successful_processing_with_no_participants
=== RUN   TestRoundService_ProcessRoundReminder/error_retrieving_participants
--- PASS: TestRoundService_ProcessRoundReminder (0.00s)
    --- PASS: TestRoundService_ProcessRoundReminder/successful_processing_with_participants (0.00s)
    --- PASS: TestRoundService_ProcessRoundReminder/successful_processing_with_no_participants (0.00s)
    --- PASS: TestRoundService_ProcessRoundReminder/error_retrieving_participants (0.00s)
=== RUN   TestRoundService_ScheduleRoundEvents
=== RUN   TestRoundService_ScheduleRoundEvents/successful_scheduling
=== RUN   TestRoundService_ScheduleRoundEvents/error_creating_consumer
=== RUN   TestRoundService_ScheduleRoundEvents/error_scheduling_reminder
=== RUN   TestRoundService_ScheduleRoundEvents/error_scheduling_round_start
=== RUN   TestRoundService_ScheduleRoundEvents/past_start_time
=== RUN   TestRoundService_ScheduleRoundEvents/far_future_start_time
=== RUN   TestRoundService_ScheduleRoundEvents/zero_start_time
=== RUN   TestRoundService_ScheduleRoundEvents/empty_event_message_ID
=== RUN   TestRoundService_ScheduleRoundEvents/with_description_in_payload
=== RUN   TestRoundService_ScheduleRoundEvents/with_UserID_in_payload
=== RUN   TestRoundService_ScheduleRoundEvents/reminder_time_equals_start_time
=== RUN   TestRoundService_ScheduleRoundEvents/missing_channel_ID_in_payload
=== RUN   TestRoundService_ScheduleRoundEvents/nil_start_time_in_payload
=== RUN   TestRoundService_ScheduleRoundEvents/nil_description_in_payload
--- PASS: TestRoundService_ScheduleRoundEvents (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/successful_scheduling (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/error_creating_consumer (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/error_scheduling_reminder (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/error_scheduling_round_start (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/past_start_time (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/far_future_start_time (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/zero_start_time (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/empty_event_message_ID (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/with_description_in_payload (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/with_UserID_in_payload (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/reminder_time_equals_start_time (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/missing_channel_ID_in_payload (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/nil_start_time_in_payload (0.00s)
    --- PASS: TestRoundService_ScheduleRoundEvents/nil_description_in_payload (0.00s)
=== RUN   TestRoundService_ValidateScoreUpdateRequest
=== RUN   TestRoundService_ValidateScoreUpdateRequest/successful_validation
=== RUN   TestRoundService_ValidateScoreUpdateRequest/invalid_round_ID
=== RUN   TestRoundService_ValidateScoreUpdateRequest/empty_participant
=== RUN   TestRoundService_ValidateScoreUpdateRequest/nil_score
=== RUN   TestRoundService_ValidateScoreUpdateRequest/multiple_validation_errors
--- PASS: TestRoundService_ValidateScoreUpdateRequest (0.00s)
    --- PASS: TestRoundService_ValidateScoreUpdateRequest/successful_validation (0.00s)
    --- PASS: TestRoundService_ValidateScoreUpdateRequest/invalid_round_ID (0.00s)
    --- PASS: TestRoundService_ValidateScoreUpdateRequest/empty_participant (0.00s)
    --- PASS: TestRoundService_ValidateScoreUpdateRequest/nil_score (0.00s)
    --- PASS: TestRoundService_ValidateScoreUpdateRequest/multiple_validation_errors (0.00s)
=== RUN   TestRoundService_UpdateParticipantScore
=== RUN   TestRoundService_UpdateParticipantScore/successful_update
=== RUN   TestRoundService_UpdateParticipantScore/error_updating_score
=== RUN   TestRoundService_UpdateParticipantScore/error_getting_participants_after_update
=== RUN   TestRoundService_UpdateParticipantScore/error_getting_round
--- PASS: TestRoundService_UpdateParticipantScore (0.00s)
    --- PASS: TestRoundService_UpdateParticipantScore/successful_update (0.00s)
    --- PASS: TestRoundService_UpdateParticipantScore/error_updating_score (0.00s)
    --- PASS: TestRoundService_UpdateParticipantScore/error_getting_participants_after_update (0.00s)
    --- PASS: TestRoundService_UpdateParticipantScore/error_getting_round (0.00s)
=== RUN   TestRoundService_CheckAllScoresSubmitted
=== RUN   TestRoundService_CheckAllScoresSubmitted/all_scores_submitted
=== RUN   TestRoundService_CheckAllScoresSubmitted/not_all_scores_submitted
=== RUN   TestRoundService_CheckAllScoresSubmitted/error_checking_if_all_scores_submitted_(GetParticipants_fails_in_checkIfAllScoresSubmitted)
=== RUN   TestRoundService_CheckAllScoresSubmitted/error_getting_participants_for_success_payload_(GetParticipants_fails_after_checkIfAllScoresSubmitted)
--- PASS: TestRoundService_CheckAllScoresSubmitted (0.00s)
    --- PASS: TestRoundService_CheckAllScoresSubmitted/all_scores_submitted (0.00s)
    --- PASS: TestRoundService_CheckAllScoresSubmitted/not_all_scores_submitted (0.00s)
    --- PASS: TestRoundService_CheckAllScoresSubmitted/error_checking_if_all_scores_submitted_(GetParticipants_fails_in_checkIfAllScoresSubmitted) (0.00s)
    --- PASS: TestRoundService_CheckAllScoresSubmitted/error_getting_participants_for_success_payload_(GetParticipants_fails_after_checkIfAllScoresSubmitted) (0.00s)
=== RUN   Test_serviceWrapper
=== RUN   Test_serviceWrapper/successful_operation
=== RUN   Test_serviceWrapper/failed_operation
=== RUN   Test_serviceWrapper/panic_recovery
=== RUN   Test_serviceWrapper/nil_service_function
--- PASS: Test_serviceWrapper (0.00s)
    --- PASS: Test_serviceWrapper/successful_operation (0.00s)
    --- PASS: Test_serviceWrapper/failed_operation (0.00s)
    --- PASS: Test_serviceWrapper/panic_recovery (0.00s)
    --- PASS: Test_serviceWrapper/nil_service_function (0.00s)
=== RUN   TestNewRoundService
=== RUN   TestNewRoundService/Creates_service_with_all_dependencies
=== RUN   TestNewRoundService/Handles_nil_dependencies
--- PASS: TestNewRoundService (0.00s)
    --- PASS: TestNewRoundService/Creates_service_with_all_dependencies (0.00s)
    --- PASS: TestNewRoundService/Handles_nil_dependencies (0.00s)
=== RUN   TestRoundService_ProcessRoundStart
=== RUN   TestRoundService_ProcessRoundStart/successful_processing
=== RUN   TestRoundService_ProcessRoundStart/error_getting_round
=== RUN   TestRoundService_ProcessRoundStart/error_updating_round
--- PASS: TestRoundService_ProcessRoundStart (0.00s)
    --- PASS: TestRoundService_ProcessRoundStart/successful_processing (0.00s)
    --- PASS: TestRoundService_ProcessRoundStart/error_getting_round (0.00s)
    --- PASS: TestRoundService_ProcessRoundStart/error_updating_round (0.00s)
=== RUN   TestRoundService_ValidateRoundUpdateRequest
=== RUN   TestRoundService_ValidateRoundUpdateRequest/valid_request
=== RUN   TestRoundService_ValidateRoundUpdateRequest/invalid_request_-_zero_round_ID
=== RUN   TestRoundService_ValidateRoundUpdateRequest/invalid_request_-_no_fields_to_update
--- PASS: TestRoundService_ValidateRoundUpdateRequest (0.00s)
    --- PASS: TestRoundService_ValidateRoundUpdateRequest/valid_request (0.00s)
    --- PASS: TestRoundService_ValidateRoundUpdateRequest/invalid_request_-_zero_round_ID (0.00s)
    --- PASS: TestRoundService_ValidateRoundUpdateRequest/invalid_request_-_no_fields_to_update (0.00s)
=== RUN   TestRoundService_UpdateRoundEntity
=== RUN   TestRoundService_UpdateRoundEntity/valid_update
=== RUN   TestRoundService_UpdateRoundEntity/invalid_update_-_round_not_found
=== RUN   TestRoundService_UpdateRoundEntity/invalid_update_-_update_failed
--- PASS: TestRoundService_UpdateRoundEntity (0.00s)
    --- PASS: TestRoundService_UpdateRoundEntity/valid_update (0.00s)
    --- PASS: TestRoundService_UpdateRoundEntity/invalid_update_-_round_not_found (0.00s)
    --- PASS: TestRoundService_UpdateRoundEntity/invalid_update_-_update_failed (0.00s)
=== RUN   TestRoundService_UpdateScheduledRoundEvents
=== RUN   TestRoundService_UpdateScheduledRoundEvents/valid_update
=== RUN   TestRoundService_UpdateScheduledRoundEvents/invalid_update_-_round_not_found
=== RUN   TestRoundService_UpdateScheduledRoundEvents/invalid_update_-_cancel_scheduled_events_failed
--- PASS: TestRoundService_UpdateScheduledRoundEvents (0.00s)
    --- PASS: TestRoundService_UpdateScheduledRoundEvents/valid_update (0.00s)
    --- PASS: TestRoundService_UpdateScheduledRoundEvents/invalid_update_-_round_not_found (0.00s)
    --- PASS: TestRoundService_UpdateScheduledRoundEvents/invalid_update_-_cancel_scheduled_events_failed (0.00s)
PASS
coverage: 12.5% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/app/modules/round/application	1.301s	coverage: 12.5% of statements in ./app/...
	github.com/Black-And-White-Club/frolf-bot/app/modules/round/application/mocks		coverage: 0.0% of statements
=== RUN   TestRoundHandlers_HandleCreateRoundRequest
=== RUN   TestRoundHandlers_HandleCreateRoundRequest/Successfully_handle_CreateRoundRequest
=== RUN   TestRoundHandlers_HandleCreateRoundRequest/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleCreateRoundRequest/Service_failure_in_ValidateAndProcessRound
=== RUN   TestRoundHandlers_HandleCreateRoundRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleCreateRoundRequest/Service_failure_with_non-error_result
=== RUN   TestRoundHandlers_HandleCreateRoundRequest/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleCreateRoundRequest/Unknown_result_from_ValidateAndProcessRound
=== RUN   TestRoundHandlers_HandleCreateRoundRequest/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleCreateRoundRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleCreateRoundRequest/Successfully_handle_CreateRoundRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleCreateRoundRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleCreateRoundRequest/Service_failure_in_ValidateAndProcessRound (0.00s)
    --- PASS: TestRoundHandlers_HandleCreateRoundRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleCreateRoundRequest/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestRoundHandlers_HandleCreateRoundRequest/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleCreateRoundRequest/Unknown_result_from_ValidateAndProcessRound (0.00s)
    --- PASS: TestRoundHandlers_HandleCreateRoundRequest/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleRoundEntityCreated
=== RUN   TestRoundHandlers_HandleRoundEntityCreated/Successfully_handle_RoundEntityCreated
=== RUN   TestRoundHandlers_HandleRoundEntityCreated/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleRoundEntityCreated/Service_failure_in_StoreRound
=== RUN   TestRoundHandlers_HandleRoundEntityCreated/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundEntityCreated/Service_failure_with_non-error_result
=== RUN   TestRoundHandlers_HandleRoundEntityCreated/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundEntityCreated/Unknown_result_from_StoreRound
=== RUN   TestRoundHandlers_HandleRoundEntityCreated/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleRoundEntityCreated (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundEntityCreated/Successfully_handle_RoundEntityCreated (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundEntityCreated/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundEntityCreated/Service_failure_in_StoreRound (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundEntityCreated/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundEntityCreated/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundEntityCreated/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundEntityCreated/Unknown_result_from_StoreRound (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundEntityCreated/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleRoundDeleteRequest
=== RUN   TestRoundHandlers_HandleRoundDeleteRequest/Successfully_handle_RoundDeleteRequest
=== RUN   TestRoundHandlers_HandleRoundDeleteRequest/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleRoundDeleteRequest/Service_failure_in_ValidateRoundDeleteRequest
=== RUN   TestRoundHandlers_HandleRoundDeleteRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundDeleteRequest/Service_failure_with_non-error_result
=== RUN   TestRoundHandlers_HandleRoundDeleteRequest/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundDeleteRequest/Unknown_result_from_ValidateRoundDeleteRequest
=== RUN   TestRoundHandlers_HandleRoundDeleteRequest/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleRoundDeleteRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteRequest/Successfully_handle_RoundDeleteRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteRequest/Service_failure_in_ValidateRoundDeleteRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteRequest/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteRequest/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteRequest/Unknown_result_from_ValidateRoundDeleteRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteRequest/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleRoundDeleteAuthorized
=== RUN   TestRoundHandlers_HandleRoundDeleteAuthorized/Successfully_handle_RoundDeleteAuthorized
=== RUN   TestRoundHandlers_HandleRoundDeleteAuthorized/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleRoundDeleteAuthorized/Service_failure_in_DeleteRound
=== RUN   TestRoundHandlers_HandleRoundDeleteAuthorized/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundDeleteAuthorized/Service_failure_with_database_error
=== RUN   TestRoundHandlers_HandleRoundDeleteAuthorized/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundDeleteAuthorized/Unknown_result_from_DeleteRound
--- PASS: TestRoundHandlers_HandleRoundDeleteAuthorized (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteAuthorized/Successfully_handle_RoundDeleteAuthorized (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteAuthorized/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteAuthorized/Service_failure_in_DeleteRound (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteAuthorized/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteAuthorized/Service_failure_with_database_error (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteAuthorized/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundDeleteAuthorized/Unknown_result_from_DeleteRound (0.00s)
=== RUN   TestRoundHandlers_HandleAllScoresSubmitted
=== RUN   TestRoundHandlers_HandleAllScoresSubmitted/Successfully_handle_AllScoresSubmitted
=== RUN   TestRoundHandlers_HandleAllScoresSubmitted/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleAllScoresSubmitted/Service_failure_in_FinalizeRound
=== RUN   TestRoundHandlers_HandleAllScoresSubmitted/Service_failure_with_non-error_result
=== RUN   TestRoundHandlers_HandleAllScoresSubmitted/CreateResultMessage_fails_for_Discord_finalization
=== RUN   TestRoundHandlers_HandleAllScoresSubmitted/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleAllScoresSubmitted (0.00s)
    --- PASS: TestRoundHandlers_HandleAllScoresSubmitted/Successfully_handle_AllScoresSubmitted (0.00s)
    --- PASS: TestRoundHandlers_HandleAllScoresSubmitted/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleAllScoresSubmitted/Service_failure_in_FinalizeRound (0.00s)
    --- PASS: TestRoundHandlers_HandleAllScoresSubmitted/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestRoundHandlers_HandleAllScoresSubmitted/CreateResultMessage_fails_for_Discord_finalization (0.00s)
    --- PASS: TestRoundHandlers_HandleAllScoresSubmitted/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleRoundFinalized
=== RUN   TestRoundHandlers_HandleRoundFinalized/Successfully_handle_RoundFinalized
=== RUN   TestRoundHandlers_HandleRoundFinalized/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleRoundFinalized/Service_failure_in_NotifyScoreModule
=== RUN   TestRoundHandlers_HandleRoundFinalized/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundFinalized/Service_failure_with_non-error_result
=== RUN   TestRoundHandlers_HandleRoundFinalized/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundFinalized/Unknown_result_from_NotifyScoreModule
=== RUN   TestRoundHandlers_HandleRoundFinalized/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleRoundFinalized (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundFinalized/Successfully_handle_RoundFinalized (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundFinalized/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundFinalized/Service_failure_in_NotifyScoreModule (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundFinalized/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundFinalized/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundFinalized/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundFinalized/Unknown_result_from_NotifyScoreModule (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundFinalized/Invalid_payload_type (0.00s)
=== RUN   TestNewRoundHandlers
=== RUN   TestNewRoundHandlers/Creates_handlers_with_all_dependencies
=== RUN   TestNewRoundHandlers/Handles_nil_dependencies
--- PASS: TestNewRoundHandlers (0.00s)
    --- PASS: TestNewRoundHandlers/Creates_handlers_with_all_dependencies (0.00s)
    --- PASS: TestNewRoundHandlers/Handles_nil_dependencies (0.00s)
=== RUN   TestHandlerWrapper
=== RUN   TestHandlerWrapper/Successful_handler_execution
=== RUN   TestHandlerWrapper/Handler_returns_error
=== RUN   TestHandlerWrapper/Unmarshal_payload_fails
=== RUN   TestHandlerWrapper/Unmarshal_payload_succeeds
--- PASS: TestHandlerWrapper (0.00s)
    --- PASS: TestHandlerWrapper/Successful_handler_execution (0.00s)
    --- PASS: TestHandlerWrapper/Handler_returns_error (0.00s)
    --- PASS: TestHandlerWrapper/Unmarshal_payload_fails (0.00s)
    --- PASS: TestHandlerWrapper/Unmarshal_payload_succeeds (0.00s)
=== RUN   TestRoundHandlers_HandleTagNumberFound
=== RUN   TestRoundHandlers_HandleTagNumberFound/Successfully_handle_TagNumberFound
=== RUN   TestRoundHandlers_HandleTagNumberFound/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleTagNumberFound/Service_failure_in_handleParticipantUpdate
=== RUN   TestRoundHandlers_HandleTagNumberFound/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleTagNumberFound/Unknown_result_from_UpdateParticipantStatus
=== RUN   TestRoundHandlers_HandleTagNumberFound/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleTagNumberFound (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberFound/Successfully_handle_TagNumberFound (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberFound/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberFound/Service_failure_in_handleParticipantUpdate (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberFound/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberFound/Unknown_result_from_UpdateParticipantStatus (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberFound/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleTagNumberNotFound
=== RUN   TestRoundHandlers_HandleTagNumberNotFound/Successfully_handle_TagNumberNotFound
=== RUN   TestRoundHandlers_HandleTagNumberNotFound/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleTagNumberNotFound/Service_failure_in_handleParticipantUpdate
=== RUN   TestRoundHandlers_HandleTagNumberNotFound/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleTagNumberNotFound/Unknown_result_from_UpdateParticipantStatus
=== RUN   TestRoundHandlers_HandleTagNumberNotFound/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleTagNumberNotFound (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberNotFound/Successfully_handle_TagNumberNotFound (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberNotFound/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberNotFound/Service_failure_in_handleParticipantUpdate (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberNotFound/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberNotFound/Unknown_result_from_UpdateParticipantStatus (0.00s)
    --- PASS: TestRoundHandlers_HandleTagNumberNotFound/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleParticipantDeclined
=== RUN   TestRoundHandlers_HandleParticipantDeclined/Successfully_handle_ParticipantDeclined
=== RUN   TestRoundHandlers_HandleParticipantDeclined/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleParticipantDeclined/Service_failure_in_UpdateParticipantStatus
=== RUN   TestRoundHandlers_HandleParticipantDeclined/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleParticipantDeclined/Unknown_result_from_UpdateParticipantStatus
=== RUN   TestRoundHandlers_HandleParticipantDeclined/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleParticipantDeclined (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantDeclined/Successfully_handle_ParticipantDeclined (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantDeclined/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantDeclined/Service_failure_in_UpdateParticipantStatus (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantDeclined/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantDeclined/Unknown_result_from_UpdateParticipantStatus (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantDeclined/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleParticipantJoinRequest
=== RUN   TestRoundHandlers_HandleParticipantJoinRequest/Successfully_handle_ParticipantJoinRequest
=== RUN   TestRoundHandlers_HandleParticipantJoinRequest/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleParticipantJoinRequest/Service_failure_in_CheckParticipantStatus
=== RUN   TestRoundHandlers_HandleParticipantJoinRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleParticipantJoinRequest/Service_failure_with_non-error_result
=== RUN   TestRoundHandlers_HandleParticipantJoinRequest/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleParticipantJoinRequest/Unknown_result_from_CheckParticipantStatus
=== RUN   TestRoundHandlers_HandleParticipantJoinRequest/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleParticipantJoinRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinRequest/Successfully_handle_ParticipantJoinRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinRequest/Service_failure_in_CheckParticipantStatus (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinRequest/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinRequest/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinRequest/Unknown_result_from_CheckParticipantStatus (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinRequest/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleParticipantJoinValidationRequest
=== RUN   TestRoundHandlers_HandleParticipantJoinValidationRequest/Successfully_handle_ParticipantJoinValidationRequest
=== RUN   TestRoundHandlers_HandleParticipantJoinValidationRequest/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleParticipantJoinValidationRequest/Service_failure_in_ValidateParticipantJoinRequest
=== RUN   TestRoundHandlers_HandleParticipantJoinValidationRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleParticipantJoinValidationRequest/Service_failure_with_non-error_result
=== RUN   TestRoundHandlers_HandleParticipantJoinValidationRequest/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleParticipantJoinValidationRequest/Unknown_result_from_ValidateParticipantJoinRequest
=== RUN   TestRoundHandlers_HandleParticipantJoinValidationRequest/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleParticipantJoinValidationRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinValidationRequest/Successfully_handle_ParticipantJoinValidationRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinValidationRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinValidationRequest/Service_failure_in_ValidateParticipantJoinRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinValidationRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinValidationRequest/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinValidationRequest/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinValidationRequest/Unknown_result_from_ValidateParticipantJoinRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantJoinValidationRequest/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleParticipantRemovalRequest
=== RUN   TestRoundHandlers_HandleParticipantRemovalRequest/Successfully_handle_ParticipantRemovalRequest
=== RUN   TestRoundHandlers_HandleParticipantRemovalRequest/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleParticipantRemovalRequest/Service_failure_in_ParticipantRemoval
=== RUN   TestRoundHandlers_HandleParticipantRemovalRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleParticipantRemovalRequest/Service_failure_with_non-error_result
=== RUN   TestRoundHandlers_HandleParticipantRemovalRequest/Service_failure_with_error_result_and_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleParticipantRemovalRequest/Unknown_result_from_ParticipantRemoval
=== RUN   TestRoundHandlers_HandleParticipantRemovalRequest/Invalid_payload_type
--- PASS: TestRoundHandlers_HandleParticipantRemovalRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantRemovalRequest/Successfully_handle_ParticipantRemovalRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantRemovalRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantRemovalRequest/Service_failure_in_ParticipantRemoval (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantRemovalRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantRemovalRequest/Service_failure_with_non-error_result (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantRemovalRequest/Service_failure_with_error_result_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantRemovalRequest/Unknown_result_from_ParticipantRemoval (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantRemovalRequest/Invalid_payload_type (0.00s)
=== RUN   TestRoundHandlers_HandleScheduledRoundTagUpdate
=== RUN   TestRoundHandlers_HandleScheduledRoundTagUpdate/Successfully_handle_ScheduledRoundTagUpdate
=== RUN   TestRoundHandlers_HandleScheduledRoundTagUpdate/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleScheduledRoundTagUpdate/Service_failure_in_UpdateScheduledRoundsWithNewTags
=== RUN   TestRoundHandlers_HandleScheduledRoundTagUpdate/Service_returns_failure_payload
=== RUN   TestRoundHandlers_HandleScheduledRoundTagUpdate/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleScheduledRoundTagUpdate/Unknown_result_from_UpdateScheduledRoundsWithNewTags
--- PASS: TestRoundHandlers_HandleScheduledRoundTagUpdate (0.00s)
    --- PASS: TestRoundHandlers_HandleScheduledRoundTagUpdate/Successfully_handle_ScheduledRoundTagUpdate (0.00s)
    --- PASS: TestRoundHandlers_HandleScheduledRoundTagUpdate/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleScheduledRoundTagUpdate/Service_failure_in_UpdateScheduledRoundsWithNewTags (0.00s)
    --- PASS: TestRoundHandlers_HandleScheduledRoundTagUpdate/Service_returns_failure_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleScheduledRoundTagUpdate/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleScheduledRoundTagUpdate/Unknown_result_from_UpdateScheduledRoundsWithNewTags (0.00s)
=== RUN   TestRoundHandlers_HandleRoundReminder
=== RUN   TestRoundHandlers_HandleRoundReminder/Successfully_handle_RoundReminder
=== RUN   TestRoundHandlers_HandleRoundReminder/Successfully_handle_RoundReminder_with_no_participants
=== RUN   TestRoundHandlers_HandleRoundReminder/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleRoundReminder/Service_failure_in_ProcessRoundReminder
=== RUN   TestRoundHandlers_HandleRoundReminder/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundReminder/Unknown_result_from_ProcessRoundReminder
=== RUN   TestRoundHandlers_HandleRoundReminder/Failure_result_from_ProcessRoundReminder
--- PASS: TestRoundHandlers_HandleRoundReminder (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundReminder/Successfully_handle_RoundReminder (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundReminder/Successfully_handle_RoundReminder_with_no_participants (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundReminder/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundReminder/Service_failure_in_ProcessRoundReminder (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundReminder/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundReminder/Unknown_result_from_ProcessRoundReminder (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundReminder/Failure_result_from_ProcessRoundReminder (0.00s)
=== RUN   TestRoundHandlers_HandleGetRoundRequest
=== RUN   TestRoundHandlers_HandleGetRoundRequest/Successfully_handle_GetRoundRequest
=== RUN   TestRoundHandlers_HandleGetRoundRequest/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleGetRoundRequest/Service_failure_in_GetRound
=== RUN   TestRoundHandlers_HandleGetRoundRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleGetRoundRequest/Unknown_result_from_GetRound
=== RUN   TestRoundHandlers_HandleGetRoundRequest/Failure_result_from_GetRound
--- PASS: TestRoundHandlers_HandleGetRoundRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleGetRoundRequest/Successfully_handle_GetRoundRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleGetRoundRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleGetRoundRequest/Service_failure_in_GetRound (0.00s)
    --- PASS: TestRoundHandlers_HandleGetRoundRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleGetRoundRequest/Unknown_result_from_GetRound (0.00s)
    --- PASS: TestRoundHandlers_HandleGetRoundRequest/Failure_result_from_GetRound (0.00s)
=== RUN   TestRoundHandlers_HandleDiscordMessageIDUpdated
=== RUN   TestRoundHandlers_HandleDiscordMessageIDUpdated/Successfully_handle_DiscordMessageIDUpdated
=== RUN   TestRoundHandlers_HandleDiscordMessageIDUpdated/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleDiscordMessageIDUpdated/Service_failure_in_ScheduleRoundEvents
=== RUN   TestRoundHandlers_HandleDiscordMessageIDUpdated/Unknown_result_from_ScheduleRoundEvents
=== RUN   TestRoundHandlers_HandleDiscordMessageIDUpdated/Failure_result_from_ScheduleRoundEvents
=== RUN   TestRoundHandlers_HandleDiscordMessageIDUpdated/Failure_result_from_ScheduleRoundEvents_and_CreateResultMessage_fails
--- PASS: TestRoundHandlers_HandleDiscordMessageIDUpdated (0.00s)
    --- PASS: TestRoundHandlers_HandleDiscordMessageIDUpdated/Successfully_handle_DiscordMessageIDUpdated (0.00s)
    --- PASS: TestRoundHandlers_HandleDiscordMessageIDUpdated/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleDiscordMessageIDUpdated/Service_failure_in_ScheduleRoundEvents (0.00s)
    --- PASS: TestRoundHandlers_HandleDiscordMessageIDUpdated/Unknown_result_from_ScheduleRoundEvents (0.00s)
    --- PASS: TestRoundHandlers_HandleDiscordMessageIDUpdated/Failure_result_from_ScheduleRoundEvents (0.00s)
    --- PASS: TestRoundHandlers_HandleDiscordMessageIDUpdated/Failure_result_from_ScheduleRoundEvents_and_CreateResultMessage_fails (0.00s)
=== RUN   TestRoundHandlers_HandleScoreUpdateRequest
=== RUN   TestRoundHandlers_HandleScoreUpdateRequest/Successfully_handle_ScoreUpdateRequest
=== RUN   TestRoundHandlers_HandleScoreUpdateRequest/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleScoreUpdateRequest/Service_failure_in_ValidateScoreUpdateRequest
=== RUN   TestRoundHandlers_HandleScoreUpdateRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleScoreUpdateRequest/Unknown_result_from_ValidateScoreUpdateRequest
=== RUN   TestRoundHandlers_HandleScoreUpdateRequest/Failure_result_from_ValidateScoreUpdateRequest
--- PASS: TestRoundHandlers_HandleScoreUpdateRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateRequest/Successfully_handle_ScoreUpdateRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateRequest/Service_failure_in_ValidateScoreUpdateRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateRequest/Unknown_result_from_ValidateScoreUpdateRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateRequest/Failure_result_from_ValidateScoreUpdateRequest (0.00s)
=== RUN   TestRoundHandlers_HandleScoreUpdateValidated
=== RUN   TestRoundHandlers_HandleScoreUpdateValidated/Successfully_handle_ScoreUpdateValidated
=== RUN   TestRoundHandlers_HandleScoreUpdateValidated/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleScoreUpdateValidated/Service_failure_in_UpdateParticipantScore
=== RUN   TestRoundHandlers_HandleScoreUpdateValidated/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleScoreUpdateValidated/Unknown_result_from_UpdateParticipantScore
=== RUN   TestRoundHandlers_HandleScoreUpdateValidated/Failure_result_from_UpdateParticipantScore
--- PASS: TestRoundHandlers_HandleScoreUpdateValidated (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateValidated/Successfully_handle_ScoreUpdateValidated (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateValidated/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateValidated/Service_failure_in_UpdateParticipantScore (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateValidated/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateValidated/Unknown_result_from_UpdateParticipantScore (0.00s)
    --- PASS: TestRoundHandlers_HandleScoreUpdateValidated/Failure_result_from_UpdateParticipantScore (0.00s)
=== RUN   TestRoundHandlers_HandleParticipantScoreUpdated
=== RUN   TestRoundHandlers_HandleParticipantScoreUpdated/Successfully_handle_ParticipantScoreUpdated
=== RUN   TestRoundHandlers_HandleParticipantScoreUpdated/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleParticipantScoreUpdated/Service_failure_in_CheckAllScoresSubmitted
=== RUN   TestRoundHandlers_HandleParticipantScoreUpdated/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleParticipantScoreUpdated/Unknown_result_from_CheckAllScoresSubmitted
=== RUN   TestRoundHandlers_HandleParticipantScoreUpdated/Failure_result_from_CheckAllScoresSubmitted
--- PASS: TestRoundHandlers_HandleParticipantScoreUpdated (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantScoreUpdated/Successfully_handle_ParticipantScoreUpdated (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantScoreUpdated/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantScoreUpdated/Service_failure_in_CheckAllScoresSubmitted (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantScoreUpdated/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantScoreUpdated/Unknown_result_from_CheckAllScoresSubmitted (0.00s)
    --- PASS: TestRoundHandlers_HandleParticipantScoreUpdated/Failure_result_from_CheckAllScoresSubmitted (0.00s)
=== RUN   TestRoundHandlers_HandleRoundStarted
=== RUN   TestRoundHandlers_HandleRoundStarted/Successfully_handle_RoundStarted
=== RUN   TestRoundHandlers_HandleRoundStarted/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleRoundStarted/Service_failure_in_ProcessRoundStart
=== RUN   TestRoundHandlers_HandleRoundStarted/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundStarted/Unknown_result_from_ProcessRoundStart
=== RUN   TestRoundHandlers_HandleRoundStarted/Failure_result_from_ProcessRoundStart
--- PASS: TestRoundHandlers_HandleRoundStarted (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundStarted/Successfully_handle_RoundStarted (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundStarted/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundStarted/Service_failure_in_ProcessRoundStart (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundStarted/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundStarted/Unknown_result_from_ProcessRoundStart (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundStarted/Failure_result_from_ProcessRoundStart (0.00s)
=== RUN   TestRoundHandlers_HandleRoundUpdateRequest
=== RUN   TestRoundHandlers_HandleRoundUpdateRequest/Successfully_handle_RoundUpdateRequest
=== RUN   TestRoundHandlers_HandleRoundUpdateRequest/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleRoundUpdateRequest/Service_failure_in_ValidateRoundUpdateRequest
=== RUN   TestRoundHandlers_HandleRoundUpdateRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundUpdateRequest/Unknown_result_from_ValidateRoundUpdateRequest
=== RUN   TestRoundHandlers_HandleRoundUpdateRequest/Failure_result_from_ValidateRoundUpdateRequest
--- PASS: TestRoundHandlers_HandleRoundUpdateRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateRequest/Successfully_handle_RoundUpdateRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateRequest/Service_failure_in_ValidateRoundUpdateRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateRequest/Unknown_result_from_ValidateRoundUpdateRequest (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateRequest/Failure_result_from_ValidateRoundUpdateRequest (0.00s)
=== RUN   TestRoundHandlers_HandleRoundUpdateValidated
=== RUN   TestRoundHandlers_HandleRoundUpdateValidated/Successfully_handle_RoundUpdateValidated
=== RUN   TestRoundHandlers_HandleRoundUpdateValidated/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleRoundUpdateValidated/Service_failure_in_UpdateRoundEntity
=== RUN   TestRoundHandlers_HandleRoundUpdateValidated/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundUpdateValidated/Unknown_result_from_UpdateRoundEntity
=== RUN   TestRoundHandlers_HandleRoundUpdateValidated/Failure_result_from_UpdateRoundEntity
--- PASS: TestRoundHandlers_HandleRoundUpdateValidated (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateValidated/Successfully_handle_RoundUpdateValidated (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateValidated/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateValidated/Service_failure_in_UpdateRoundEntity (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateValidated/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateValidated/Unknown_result_from_UpdateRoundEntity (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundUpdateValidated/Failure_result_from_UpdateRoundEntity (0.00s)
=== RUN   TestRoundHandlers_HandleRoundScheduleUpdate
=== RUN   TestRoundHandlers_HandleRoundScheduleUpdate/Successfully_handle_RoundScheduleUpdate
=== RUN   TestRoundHandlers_HandleRoundScheduleUpdate/Fail_to_unmarshal_payload
=== RUN   TestRoundHandlers_HandleRoundScheduleUpdate/Service_failure_in_UpdateScheduledRoundEvents
=== RUN   TestRoundHandlers_HandleRoundScheduleUpdate/Service_success_but_CreateResultMessage_fails
=== RUN   TestRoundHandlers_HandleRoundScheduleUpdate/Unknown_result_from_UpdateScheduledRoundEvents
=== RUN   TestRoundHandlers_HandleRoundScheduleUpdate/Failure_result_from_UpdateScheduledRoundEvents
--- PASS: TestRoundHandlers_HandleRoundScheduleUpdate (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundScheduleUpdate/Successfully_handle_RoundScheduleUpdate (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundScheduleUpdate/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundScheduleUpdate/Service_failure_in_UpdateScheduledRoundEvents (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundScheduleUpdate/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundScheduleUpdate/Unknown_result_from_UpdateScheduledRoundEvents (0.00s)
    --- PASS: TestRoundHandlers_HandleRoundScheduleUpdate/Failure_result_from_UpdateScheduledRoundEvents (0.00s)
PASS
coverage: 15.3% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/app/modules/round/infrastructure/handlers	1.801s	coverage: 15.3% of statements in ./app/...
	github.com/Black-And-White-Club/frolf-bot/app/modules/round/infrastructure/handlers/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/round/infrastructure/repositories		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/round/infrastructure/repositories/migrations		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/round/infrastructure/repositories/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/round/infrastructure/router		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/round/infrastructure/router/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/round/mocks		coverage: 0.0% of statements
=== RUN   TestNewTimeParser
=== RUN   TestNewTimeParser/Create_TimeParser
--- PASS: TestNewTimeParser (0.00s)
    --- PASS: TestNewTimeParser/Create_TimeParser (0.00s)
=== RUN   TestTimeParser_GetTimezoneFromInput
=== RUN   TestTimeParser_GetTimezoneFromInput/Valid_timezone_PST
=== RUN   TestTimeParser_GetTimezoneFromInput/Valid_timezone_EST
=== RUN   TestTimeParser_GetTimezoneFromInput/Invalid_timezone
2025/05/31 08:59:11 WARN Unknown timezone, falling back to default input="What time is it?"
=== RUN   TestTimeParser_GetTimezoneFromInput/Mixed_case_timezone
=== RUN   TestTimeParser_GetTimezoneFromInput/Valid_full_timezone_name
=== RUN   TestTimeParser_GetTimezoneFromInput/Unknown_abbreviation
2025/05/31 08:59:11 WARN Unknown timezone, falling back to default input=XYZ
--- PASS: TestTimeParser_GetTimezoneFromInput (0.01s)
    --- PASS: TestTimeParser_GetTimezoneFromInput/Valid_timezone_PST (0.00s)
    --- PASS: TestTimeParser_GetTimezoneFromInput/Valid_timezone_EST (0.00s)
    --- PASS: TestTimeParser_GetTimezoneFromInput/Invalid_timezone (0.00s)
    --- PASS: TestTimeParser_GetTimezoneFromInput/Mixed_case_timezone (0.00s)
    --- PASS: TestTimeParser_GetTimezoneFromInput/Valid_full_timezone_name (0.00s)
    --- PASS: TestTimeParser_GetTimezoneFromInput/Unknown_abbreviation (0.00s)
=== RUN   TestTimeParser_ParseUserTimeInput
=== RUN   TestTimeParser_ParseUserTimeInput/Valid_time_in_PDT
2025/05/31 08:59:11 INFO Timezone override user_timezone=America/Los_Angeles
2025/05/31 08:59:11 INFO Parsed time using when parsed_time=2027-06-06T17:00:00-07:00
=== RUN   TestTimeParser_ParseUserTimeInput/Unknown_timezone_uses_fallback
2025/05/31 08:59:11 WARN Unknown timezone, falling back to default input=XYZ
2025/05/31 08:59:11 INFO Timezone override user_timezone=America/Chicago
2025/05/31 08:59:11 INFO Parsed time using when parsed_time=2027-06-06T17:00:00-05:00
=== RUN   TestTimeParser_ParseUserTimeInput/Invalid_date_format
2025/05/31 08:59:11 INFO Timezone override user_timezone=America/Chicago
2025/05/31 08:59:11 WARN `when` failed to parse input, falling back to manual parsing input="invalid date"
=== RUN   TestTimeParser_ParseUserTimeInput/6am_(time_already_passed)
2025/05/31 08:59:11 INFO Timezone override user_timezone=America/Chicago
2025/05/31 08:59:11 INFO Parsed time using when parsed_time=2027-06-05T06:00:00-05:00
=== RUN   TestTimeParser_ParseUserTimeInput/7pm_(time_not_yet_passed)
2025/05/31 08:59:11 INFO Timezone override user_timezone=America/Chicago
2025/05/31 08:59:11 INFO Parsed time using when parsed_time=2027-06-05T19:00:00-05:00
=== RUN   TestTimeParser_ParseUserTimeInput/Empty_timezone_string_uses_fallback
2025/05/31 08:59:11 WARN Empty timezone input, falling back to default input=""
2025/05/31 08:59:11 INFO Timezone override user_timezone=America/Chicago
2025/05/31 08:59:11 INFO Parsed time using when parsed_time=2027-06-06T17:00:00-05:00
=== RUN   TestTimeParser_ParseUserTimeInput/Malformed_time_string
2025/05/31 08:59:11 INFO Timezone override user_timezone=America/Los_Angeles
2025/05/31 08:59:11 WARN `when` failed to parse input, falling back to manual parsing input="25 pm"
=== RUN   TestTimeParser_ParseUserTimeInput/DST_Transition
2025/05/31 08:59:11 INFO Timezone override user_timezone=America/Los_Angeles
2025/05/31 08:59:11 INFO Parsed time using when parsed_time=2027-11-05T01:30:00-07:00
=== RUN   TestTimeParser_ParseUserTimeInput/Empty_startTimeStr
=== RUN   TestTimeParser_ParseUserTimeInput/Whitespace_only_startTimeStr
=== RUN   TestTimeParser_ParseUserTimeInput/Valid_time_format_932am
2025/05/31 08:59:11 INFO Timezone override user_timezone=America/Chicago
2025/05/31 08:59:11 INFO Parsed time using when parsed_time=2027-06-05T09:32:00-05:00
=== RUN   TestTimeParser_ParseUserTimeInput/Today_at_format
2025/05/31 08:59:11 INFO Timezone override user_timezone=EST
2025/05/31 08:59:11 INFO Parsed time using when parsed_time=2027-06-05T15:00:00-05:00
--- PASS: TestTimeParser_ParseUserTimeInput (0.01s)
    --- PASS: TestTimeParser_ParseUserTimeInput/Valid_time_in_PDT (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/Unknown_timezone_uses_fallback (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/Invalid_date_format (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/6am_(time_already_passed) (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/7pm_(time_not_yet_passed) (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/Empty_timezone_string_uses_fallback (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/Malformed_time_string (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/DST_Transition (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/Empty_startTimeStr (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/Whitespace_only_startTimeStr (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/Valid_time_format_932am (0.00s)
    --- PASS: TestTimeParser_ParseUserTimeInput/Today_at_format (0.00s)
PASS
coverage: 1.1% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/app/modules/round/time_utils	2.033s	coverage: 1.1% of statements in ./app/...
	github.com/Black-And-White-Club/frolf-bot/app/modules/round/utils		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/score		coverage: 0.0% of statements
=== RUN   TestScoreService_CorrectScore
=== RUN   TestScoreService_CorrectScore/Successfully_corrects_score
=== RUN   TestScoreService_CorrectScore/Successfully_corrects_score_with_tag_number
=== RUN   TestScoreService_CorrectScore/Fails_due_to_database_error
=== RUN   TestScoreService_CorrectScore/Fails_due_to_invalid_tag_number
--- PASS: TestScoreService_CorrectScore (0.00s)
    --- PASS: TestScoreService_CorrectScore/Successfully_corrects_score (0.00s)
    --- PASS: TestScoreService_CorrectScore/Successfully_corrects_score_with_tag_number (0.00s)
    --- PASS: TestScoreService_CorrectScore/Fails_due_to_database_error (0.00s)
    --- PASS: TestScoreService_CorrectScore/Fails_due_to_invalid_tag_number (0.00s)
=== RUN   TestScoreService_ProcessRoundScores
=== RUN   TestScoreService_ProcessRoundScores/Successfully_processes_round_scores
=== RUN   TestScoreService_ProcessRoundScores/Fails_due_to_database_error
=== RUN   TestScoreService_ProcessRoundScores/Fails_due_to_invalid_round_ID
=== RUN   TestScoreService_ProcessRoundScores/Fails_with_empty_score_list
=== RUN   TestScoreService_ProcessRoundScores/Handles_extreme_score_values_(expects_validation_error)
--- PASS: TestScoreService_ProcessRoundScores (0.00s)
    --- PASS: TestScoreService_ProcessRoundScores/Successfully_processes_round_scores (0.00s)
    --- PASS: TestScoreService_ProcessRoundScores/Fails_due_to_database_error (0.00s)
    --- PASS: TestScoreService_ProcessRoundScores/Fails_due_to_invalid_round_ID (0.00s)
    --- PASS: TestScoreService_ProcessRoundScores/Fails_with_empty_score_list (0.00s)
    --- PASS: TestScoreService_ProcessRoundScores/Handles_extreme_score_values_(expects_validation_error) (0.00s)
=== RUN   TestNewScoreService
=== RUN   TestNewScoreService/Creates_service_with_all_dependencies
=== RUN   TestNewScoreService/Handles_nil_dependencies
--- PASS: TestNewScoreService (0.00s)
    --- PASS: TestNewScoreService/Creates_service_with_all_dependencies (0.00s)
    --- PASS: TestNewScoreService/Handles_nil_dependencies (0.00s)
=== RUN   Test_serviceWrapper
=== RUN   Test_serviceWrapper/Successful_operation
=== RUN   Test_serviceWrapper/Handles_panic_in_service_function
=== RUN   Test_serviceWrapper/Handles_service_function_returning_an_error
--- PASS: Test_serviceWrapper (0.00s)
    --- PASS: Test_serviceWrapper/Successful_operation (0.00s)
    --- PASS: Test_serviceWrapper/Handles_panic_in_service_function (0.00s)
    --- PASS: Test_serviceWrapper/Handles_service_function_returning_an_error (0.00s)
PASS
coverage: 2.7% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/app/modules/score/application	2.394s	coverage: 2.7% of statements in ./app/...
	github.com/Black-And-White-Club/frolf-bot/app/modules/score/application/mocks		coverage: 0.0% of statements
=== RUN   TestScoreHandlers_HandleCorrectScoreRequest
=== RUN   TestScoreHandlers_HandleCorrectScoreRequest/Successfully_handle_CorrectScoreRequest
=== RUN   TestScoreHandlers_HandleCorrectScoreRequest/Fail_to_unmarshal_payload
=== RUN   TestScoreHandlers_HandleCorrectScoreRequest/Service_failure_in_CorrectScore
=== RUN   TestScoreHandlers_HandleCorrectScoreRequest/Service_returns_error
=== RUN   TestScoreHandlers_HandleCorrectScoreRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestScoreHandlers_HandleCorrectScoreRequest/Service_failure_but_CreateResultMessage_fails
=== RUN   TestScoreHandlers_HandleCorrectScoreRequest/Unknown_result_from_CorrectScore
--- PASS: TestScoreHandlers_HandleCorrectScoreRequest (0.00s)
    --- PASS: TestScoreHandlers_HandleCorrectScoreRequest/Successfully_handle_CorrectScoreRequest (0.00s)
    --- PASS: TestScoreHandlers_HandleCorrectScoreRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestScoreHandlers_HandleCorrectScoreRequest/Service_failure_in_CorrectScore (0.00s)
    --- PASS: TestScoreHandlers_HandleCorrectScoreRequest/Service_returns_error (0.00s)
    --- PASS: TestScoreHandlers_HandleCorrectScoreRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestScoreHandlers_HandleCorrectScoreRequest/Service_failure_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestScoreHandlers_HandleCorrectScoreRequest/Unknown_result_from_CorrectScore (0.00s)
=== RUN   TestNewScoreHandlers
=== RUN   TestNewScoreHandlers/Creates_handlers_with_all_dependencies
=== RUN   TestNewScoreHandlers/Handles_nil_dependencies
--- PASS: TestNewScoreHandlers (0.00s)
    --- PASS: TestNewScoreHandlers/Creates_handlers_with_all_dependencies (0.00s)
    --- PASS: TestNewScoreHandlers/Handles_nil_dependencies (0.00s)
=== RUN   TestHandlerWrapper
=== RUN   TestHandlerWrapper/Successful_handler_execution
=== RUN   TestHandlerWrapper/Handler_returns_error
=== RUN   TestHandlerWrapper/Unmarshal_payload_fails
=== RUN   TestHandlerWrapper/Unmarshal_payload_succeeds
--- PASS: TestHandlerWrapper (0.00s)
    --- PASS: TestHandlerWrapper/Successful_handler_execution (0.00s)
    --- PASS: TestHandlerWrapper/Handler_returns_error (0.00s)
    --- PASS: TestHandlerWrapper/Unmarshal_payload_fails (0.00s)
    --- PASS: TestHandlerWrapper/Unmarshal_payload_succeeds (0.00s)
=== RUN   TestScoreHandlers_HandleProcessRoundScoresRequest
=== RUN   TestScoreHandlers_HandleProcessRoundScoresRequest/Successfully_handle_ProcessRoundScoresRequest
=== RUN   TestScoreHandlers_HandleProcessRoundScoresRequest/Fail_to_unmarshal_payload
=== RUN   TestScoreHandlers_HandleProcessRoundScoresRequest/Service_failure_in_ProcessRoundScores
=== RUN   TestScoreHandlers_HandleProcessRoundScoresRequest/Service_success_but_CreateResultMessage_fails
=== RUN   TestScoreHandlers_HandleProcessRoundScoresRequest/Service_failure_and_CreateResultMessage_fails
=== RUN   TestScoreHandlers_HandleProcessRoundScoresRequest/Unknown_result_from_ProcessRoundScores
=== RUN   TestScoreHandlers_HandleProcessRoundScoresRequest/Service_returns_direct_error
=== RUN   TestScoreHandlers_HandleProcessRoundScoresRequest/Service_returns_wrong_failure_payload_type
--- PASS: TestScoreHandlers_HandleProcessRoundScoresRequest (0.00s)
    --- PASS: TestScoreHandlers_HandleProcessRoundScoresRequest/Successfully_handle_ProcessRoundScoresRequest (0.00s)
    --- PASS: TestScoreHandlers_HandleProcessRoundScoresRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestScoreHandlers_HandleProcessRoundScoresRequest/Service_failure_in_ProcessRoundScores (0.00s)
    --- PASS: TestScoreHandlers_HandleProcessRoundScoresRequest/Service_success_but_CreateResultMessage_fails (0.00s)
    --- PASS: TestScoreHandlers_HandleProcessRoundScoresRequest/Service_failure_and_CreateResultMessage_fails (0.00s)
    --- PASS: TestScoreHandlers_HandleProcessRoundScoresRequest/Unknown_result_from_ProcessRoundScores (0.00s)
    --- PASS: TestScoreHandlers_HandleProcessRoundScoresRequest/Service_returns_direct_error (0.00s)
    --- PASS: TestScoreHandlers_HandleProcessRoundScoresRequest/Service_returns_wrong_failure_payload_type (0.00s)
PASS
coverage: 2.3% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/app/modules/score/infrastructure/handlers	2.860s	coverage: 2.3% of statements in ./app/...
	github.com/Black-And-White-Club/frolf-bot/app/modules/score/infrastructure/handlers/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/score/infrastructure/repositories		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/score/infrastructure/repositories/migrations		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/score/infrastructure/repositories/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/score/infrastructure/router		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/score/infrastructure/router/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/user		coverage: 0.0% of statements
=== RUN   TestNewUserService
=== RUN   TestNewUserService/Creates_service_with_all_dependencies
=== RUN   TestNewUserService/Handles_nil_dependencies
--- PASS: TestNewUserService (0.00s)
    --- PASS: TestNewUserService/Creates_service_with_all_dependencies (0.00s)
    --- PASS: TestNewUserService/Handles_nil_dependencies (0.00s)
=== RUN   Test_serviceWrapper
=== RUN   Test_serviceWrapper/Successful_operation
=== RUN   Test_serviceWrapper/Handles_panic_in_service_function
=== RUN   Test_serviceWrapper/Handles_service_function_returning_an_error
--- PASS: Test_serviceWrapper (0.00s)
    --- PASS: Test_serviceWrapper/Successful_operation (0.00s)
    --- PASS: Test_serviceWrapper/Handles_panic_in_service_function (0.00s)
    --- PASS: Test_serviceWrapper/Handles_service_function_returning_an_error (0.00s)
=== RUN   TestUserServiceImpl_CreateUser
=== RUN   TestUserServiceImpl_CreateUser/Successfully_creates_a_user
=== RUN   TestUserServiceImpl_CreateUser/Fails_to_create_a_user_due_to_DB_error
=== RUN   TestUserServiceImpl_CreateUser/With_nil_tag_pointer
=== RUN   TestUserServiceImpl_CreateUser/Fails_due_to_unexpected_database_error
=== RUN   TestUserServiceImpl_CreateUser/Fails_due_to_empty_Discord_ID
=== RUN   TestUserServiceImpl_CreateUser/Fails_due_to_negative_tag_number
=== RUN   TestUserServiceImpl_CreateUser/Fails_due_to_nil_context
--- PASS: TestUserServiceImpl_CreateUser (0.00s)
    --- PASS: TestUserServiceImpl_CreateUser/Successfully_creates_a_user (0.00s)
    --- PASS: TestUserServiceImpl_CreateUser/Fails_to_create_a_user_due_to_DB_error (0.00s)
    --- PASS: TestUserServiceImpl_CreateUser/With_nil_tag_pointer (0.00s)
    --- PASS: TestUserServiceImpl_CreateUser/Fails_due_to_unexpected_database_error (0.00s)
    --- PASS: TestUserServiceImpl_CreateUser/Fails_due_to_empty_Discord_ID (0.00s)
    --- PASS: TestUserServiceImpl_CreateUser/Fails_due_to_negative_tag_number (0.00s)
    --- PASS: TestUserServiceImpl_CreateUser/Fails_due_to_nil_context (0.00s)
=== RUN   TestUserServiceImpl_GetUser
=== RUN   TestUserServiceImpl_GetUser/Successfully_retrieves_user
=== RUN   TestUserServiceImpl_GetUser/User_not_found
=== RUN   TestUserServiceImpl_GetUser/Database_error_retrieving_user
--- PASS: TestUserServiceImpl_GetUser (0.00s)
    --- PASS: TestUserServiceImpl_GetUser/Successfully_retrieves_user (0.00s)
    --- PASS: TestUserServiceImpl_GetUser/User_not_found (0.00s)
    --- PASS: TestUserServiceImpl_GetUser/Database_error_retrieving_user (0.00s)
=== RUN   TestUserServiceImpl_GetUserRole
=== RUN   TestUserServiceImpl_GetUserRole/Successfully_retrieves_user_role
=== RUN   TestUserServiceImpl_GetUserRole/Database_error_retrieving_user_role
=== RUN   TestUserServiceImpl_GetUserRole/Retrieved_invalid_user_role
--- PASS: TestUserServiceImpl_GetUserRole (0.00s)
    --- PASS: TestUserServiceImpl_GetUserRole/Successfully_retrieves_user_role (0.00s)
    --- PASS: TestUserServiceImpl_GetUserRole/Database_error_retrieving_user_role (0.00s)
    --- PASS: TestUserServiceImpl_GetUserRole/Retrieved_invalid_user_role (0.00s)
=== RUN   TestUserServiceImpl_UpdateUserRoleInDatabase
=== RUN   TestUserServiceImpl_UpdateUserRoleInDatabase/Successfully_updates_user_role
=== RUN   TestUserServiceImpl_UpdateUserRoleInDatabase/Fails_due_to_invalid_role
=== RUN   TestUserServiceImpl_UpdateUserRoleInDatabase/Fails_due_to_user_not_found
=== RUN   TestUserServiceImpl_UpdateUserRoleInDatabase/Fails_due_to_database_error
--- PASS: TestUserServiceImpl_UpdateUserRoleInDatabase (0.00s)
    --- PASS: TestUserServiceImpl_UpdateUserRoleInDatabase/Successfully_updates_user_role (0.00s)
    --- PASS: TestUserServiceImpl_UpdateUserRoleInDatabase/Fails_due_to_invalid_role (0.00s)
    --- PASS: TestUserServiceImpl_UpdateUserRoleInDatabase/Fails_due_to_user_not_found (0.00s)
    --- PASS: TestUserServiceImpl_UpdateUserRoleInDatabase/Fails_due_to_database_error (0.00s)
PASS
coverage: 3.5% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/app/modules/user/application	3.096s	coverage: 3.5% of statements in ./app/...
	github.com/Black-And-White-Club/frolf-bot/app/modules/user/application/mocks		coverage: 0.0% of statements
=== RUN   TestNewUserHandlers
--- PASS: TestNewUserHandlers (0.00s)
=== RUN   TestHandlerWrapper
=== RUN   TestHandlerWrapper/Successful_execution
=== RUN   TestHandlerWrapper/Handler_returns_error
--- PASS: TestHandlerWrapper (0.00s)
    --- PASS: TestHandlerWrapper/Successful_execution (0.00s)
    --- PASS: TestHandlerWrapper/Handler_returns_error (0.00s)
=== RUN   TestUserHandlers_HandleTagAvailable
=== RUN   TestUserHandlers_HandleTagAvailable/Successfully_handle_TagAvailable_event
=== RUN   TestUserHandlers_HandleTagAvailable/Fail_to_create_user
=== RUN   TestUserHandlers_HandleTagAvailable/Fail_to_unmarshal_payload
=== RUN   TestUserHandlers_HandleTagAvailable/Service_failure_in_CreateUser
=== RUN   TestUserHandlers_HandleTagAvailable/Failure_to_create_success_message
=== RUN   TestUserHandlers_HandleTagAvailable/Unknown_result_from_CreateUser
--- PASS: TestUserHandlers_HandleTagAvailable (0.00s)
    --- PASS: TestUserHandlers_HandleTagAvailable/Successfully_handle_TagAvailable_event (0.00s)
    --- PASS: TestUserHandlers_HandleTagAvailable/Fail_to_create_user (0.00s)
    --- PASS: TestUserHandlers_HandleTagAvailable/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestUserHandlers_HandleTagAvailable/Service_failure_in_CreateUser (0.00s)
    --- PASS: TestUserHandlers_HandleTagAvailable/Failure_to_create_success_message (0.00s)
    --- PASS: TestUserHandlers_HandleTagAvailable/Unknown_result_from_CreateUser (0.00s)
=== RUN   TestUserHandlers_HandleTagUnavailable
=== RUN   TestUserHandlers_HandleTagUnavailable/Successfully_handle_TagUnavailable_event
=== RUN   TestUserHandlers_HandleTagUnavailable/Fail_to_unmarshal_payload
--- PASS: TestUserHandlers_HandleTagUnavailable (0.00s)
    --- PASS: TestUserHandlers_HandleTagUnavailable/Successfully_handle_TagUnavailable_event (0.00s)
    --- PASS: TestUserHandlers_HandleTagUnavailable/Fail_to_unmarshal_payload (0.00s)
=== RUN   TestUserHandlers_HandleUserSignupRequest
=== RUN   TestUserHandlers_HandleUserSignupRequest/Successful_signup_with_tag
=== RUN   TestUserHandlers_HandleUserSignupRequest/Successful_signup_without_tag
=== RUN   TestUserHandlers_HandleUserSignupRequest/Failed_signup
=== RUN   TestUserHandlers_HandleUserSignupRequest/Error_from_CreateUser
=== RUN   TestUserHandlers_HandleUserSignupRequest/Error_creating_result_message
--- PASS: TestUserHandlers_HandleUserSignupRequest (0.00s)
    --- PASS: TestUserHandlers_HandleUserSignupRequest/Successful_signup_with_tag (0.00s)
    --- PASS: TestUserHandlers_HandleUserSignupRequest/Successful_signup_without_tag (0.00s)
    --- PASS: TestUserHandlers_HandleUserSignupRequest/Failed_signup (0.00s)
    --- PASS: TestUserHandlers_HandleUserSignupRequest/Error_from_CreateUser (0.00s)
    --- PASS: TestUserHandlers_HandleUserSignupRequest/Error_creating_result_message (0.00s)
=== RUN   TestUserHandlers_HandleGetUserRequest
=== RUN   TestUserHandlers_HandleGetUserRequest/Successfully_handle_GetUser_Request
=== RUN   TestUserHandlers_HandleGetUserRequest/User_not_found
=== RUN   TestUserHandlers_HandleGetUserRequest/Fail_to_unmarshal_payload
=== RUN   TestUserHandlers_HandleGetUserRequest/Service_failure_in_GetUser
--- PASS: TestUserHandlers_HandleGetUserRequest (0.00s)
    --- PASS: TestUserHandlers_HandleGetUserRequest/Successfully_handle_GetUser_Request (0.00s)
    --- PASS: TestUserHandlers_HandleGetUserRequest/User_not_found (0.00s)
    --- PASS: TestUserHandlers_HandleGetUserRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestUserHandlers_HandleGetUserRequest/Service_failure_in_GetUser (0.00s)
=== RUN   TestUserHandlers_HandleGetUserRoleRequest
=== RUN   TestUserHandlers_HandleGetUserRoleRequest/Successfully_handle_GetUserRoleRequest
=== RUN   TestUserHandlers_HandleGetUserRoleRequest/User_role_not_found
=== RUN   TestUserHandlers_HandleGetUserRoleRequest/Fail_to_unmarshal_payload
=== RUN   TestUserHandlers_HandleGetUserRoleRequest/Service_failure_in_GetUserRole
--- PASS: TestUserHandlers_HandleGetUserRoleRequest (0.00s)
    --- PASS: TestUserHandlers_HandleGetUserRoleRequest/Successfully_handle_GetUserRoleRequest (0.00s)
    --- PASS: TestUserHandlers_HandleGetUserRoleRequest/User_role_not_found (0.00s)
    --- PASS: TestUserHandlers_HandleGetUserRoleRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestUserHandlers_HandleGetUserRoleRequest/Service_failure_in_GetUserRole (0.00s)
=== RUN   TestUserHandlers_HandleUserRoleUpdateRequest
=== RUN   TestUserHandlers_HandleUserRoleUpdateRequest/Successfully_handle_UserRoleUpdateRequest
=== RUN   TestUserHandlers_HandleUserRoleUpdateRequest/Failed_to_update_user_role
=== RUN   TestUserHandlers_HandleUserRoleUpdateRequest/Fail_to_unmarshal_payload
=== RUN   TestUserHandlers_HandleUserRoleUpdateRequest/Service_failure_in_UpdateUserRoleInDatabase
--- PASS: TestUserHandlers_HandleUserRoleUpdateRequest (0.00s)
    --- PASS: TestUserHandlers_HandleUserRoleUpdateRequest/Successfully_handle_UserRoleUpdateRequest (0.00s)
    --- PASS: TestUserHandlers_HandleUserRoleUpdateRequest/Failed_to_update_user_role (0.00s)
    --- PASS: TestUserHandlers_HandleUserRoleUpdateRequest/Fail_to_unmarshal_payload (0.00s)
    --- PASS: TestUserHandlers_HandleUserRoleUpdateRequest/Service_failure_in_UpdateUserRoleInDatabase (0.00s)
PASS
coverage: 5.0% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/app/modules/user/infrastructure/handlers	3.542s	coverage: 5.0% of statements in ./app/...
	github.com/Black-And-White-Club/frolf-bot/app/modules/user/infrastructure/handlers/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/user/infrastructure/repositories		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/user/infrastructure/repositories/migrations		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/user/infrastructure/repositories/mocks		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/user/infrastructure/router		coverage: 0.0% of statements
	github.com/Black-And-White-Club/frolf-bot/app/modules/user/infrastructure/router/mocks		coverage: 0.0% of statements
?   	github.com/Black-And-White-Club/frolf-bot/integration_tests/containers	[no test files]
2025/05/31 08:59:14 TestMain started in package leaderboardintegrationtests
=== RUN   TestProcessTagAssignments
2025/05/31 08:59:14 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:14 github.com/testcontainers/testcontainers-go - Connected to docker: 
  Server Version: 28.1.1
  API Version: 1.48
  Operating System: Ubuntu 24.04.1 LTS
  Total Memory: 5923 MB
  Testcontainers for Go Version: v0.37.0
  Resolved Docker Host: unix:///Users/jace/.colima/default/docker.sock
  Resolved Docker Socket Path: /var/run/docker.sock
  Test SessionID: 3bcca53efbc96e46a6c192358bf7642f396e27e5bff8699ef9bf67ff02cc0815
  Test ProcessID: b3240f29-ddb5-4fc5-a824-0f7f458227fd
2025/05/31 08:59:14  Creating container for image postgres:16-alpine
2025/05/31 08:59:14  Creating container for image testcontainers/ryuk:0.11.0
2025/05/31 08:59:14  Container created: f69f8f9cade1
2025/05/31 08:59:14  Starting container: f69f8f9cade1
2025/05/31 08:59:15  Container started: f69f8f9cade1
2025/05/31 08:59:15  Waiting for container id f69f8f9cade1 image: testcontainers/ryuk:0.11.0. Waiting for: &{Port:8080/tcp timeout:<nil> PollInterval:100ms skipInternalCheck:false}
2025/05/31 08:59:17  Container is ready: f69f8f9cade1
2025/05/31 08:59:17  Container created: 1ae982532697
2025/05/31 08:59:17  Starting container: 1ae982532697
2025/05/31 08:59:17  Container started: 1ae982532697
2025/05/31 08:59:17  Waiting for container id 1ae982532697 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0003484b0 Strategies:[0xc0004fd9b0]}
2025/05/31 08:59:27  Container is ready: 1ae982532697
2025/05/31 08:59:27 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38813/testdb?sslmode=disable
2025/05/31 08:59:27 Starting NATS container with resource limits...
2025/05/31 08:59:27  Creating container for image nats:2.10-alpine
2025/05/31 08:59:27  Container created: 78cbb78b0441
2025/05/31 08:59:27  Starting container: 78cbb78b0441
2025/05/31 08:59:29  Container started: 78cbb78b0441
2025/05/31 08:59:29  Waiting for container id 78cbb78b0441 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0002ad3c0 Strategies:[0xc00055e1e0 0xc0005dd830]}
2025/05/31 08:59:33  Container is ready: 78cbb78b0441
2025/05/31 08:59:33 NATS container started with resource limits. URL: nats://localhost:38824
Creating score table...
Score table created successfully!
2025/05/31 08:59:33 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:33 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 08:59:33 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 08:59:33 Ran round migrations group #4
2025/05/31 08:59:33 All migrations ran successfully
2025/05/31 08:59:33 newDBServiceWithDB - Registering models
2025/05/31 08:59:33 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:33 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005aa0c8 RoundDB:0xc0005aa0d0 ScoreDB:0xc0005aa0d8 LeaderboardDB:0xc0005aa0e0 db:0xc000420800}
2025/05/31 08:59:34 Truncating tables: leaderboards
=== RUN   TestProcessTagAssignments/Successful_batch_assignment
=== RUN   TestProcessTagAssignments/Batch_assignment_with_some_invalid_tag_numbers_and_non-existent_users
=== RUN   TestProcessTagAssignments/Empty_assignments_list
=== RUN   TestProcessTagAssignments/Single_assignment_that_requires_tag_swap
2025/05/31 08:59:35 Cleaning up test environment...
2025/05/31 08:59:35 Context cancelled.
2025/05/31 08:59:35 EventBus closed.
2025/05/31 08:59:35 NATS connection closed.
2025/05/31 08:59:35 DB connection closed.
2025/05/31 08:59:35  Stopping container: 78cbb78b0441
2025/05/31 08:59:36  Container stopped: 78cbb78b0441
2025/05/31 08:59:36  Terminating container: 78cbb78b0441
2025/05/31 08:59:36  Container terminated: 78cbb78b0441
2025/05/31 08:59:36 NATS container terminated.
2025/05/31 08:59:36  Stopping container: 1ae982532697
2025/05/31 08:59:37  Container stopped: 1ae982532697
2025/05/31 08:59:37  Terminating container: 1ae982532697
2025/05/31 08:59:37  Container terminated: 1ae982532697
2025/05/31 08:59:37 PostgreSQL container terminated.
2025/05/31 08:59:37 Cleanup complete.
--- PASS: TestProcessTagAssignments (23.18s)
    --- PASS: TestProcessTagAssignments/Successful_batch_assignment (0.54s)
    --- PASS: TestProcessTagAssignments/Batch_assignment_with_some_invalid_tag_numbers_and_non-existent_users (0.11s)
    --- PASS: TestProcessTagAssignments/Empty_assignments_list (0.16s)
    --- PASS: TestProcessTagAssignments/Single_assignment_that_requires_tag_swap (0.15s)
=== RUN   TestGetLeaderboard
2025/05/31 08:59:37 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:37  Creating container for image postgres:16-alpine
2025/05/31 08:59:38  Container created: cdd435aa1330
2025/05/31 08:59:38  Starting container: cdd435aa1330
2025/05/31 08:59:39  Container started: cdd435aa1330
2025/05/31 08:59:39  Waiting for container id cdd435aa1330 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc00056fbc0 Strategies:[0xc0005a9200]}
2025/05/31 08:59:48  Container is ready: cdd435aa1330
2025/05/31 08:59:48 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38846/testdb?sslmode=disable
2025/05/31 08:59:48 Starting NATS container with resource limits...
2025/05/31 08:59:48  Creating container for image nats:2.10-alpine
2025/05/31 08:59:48  Container created: 08fc9c356f93
2025/05/31 08:59:48  Starting container: 08fc9c356f93
2025/05/31 08:59:50  Container started: 08fc9c356f93
2025/05/31 08:59:50  Waiting for container id 08fc9c356f93 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0006b6a40 Strategies:[0xc000680420 0xc0003c3ce0]}
2025/05/31 08:59:54  Container is ready: 08fc9c356f93
2025/05/31 08:59:54 NATS container started with resource limits. URL: nats://localhost:38858
Creating user table...
User table created successfully!
2025/05/31 08:59:54 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 08:59:54 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 08:59:54 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:54 Ran leaderboard migrations group #4
2025/05/31 08:59:54 All migrations ran successfully
2025/05/31 08:59:54 newDBServiceWithDB - Registering models
2025/05/31 08:59:54 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:54 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005aa260 RoundDB:0xc0005aa268 ScoreDB:0xc0005aa278 LeaderboardDB:0xc0005aa280 db:0xc000326d80}
2025/05/31 08:59:55 Truncating tables: leaderboards
=== RUN   TestGetLeaderboard/Successful_retrieval_of_active_leaderboard_with_data
=== RUN   TestGetLeaderboard/Retrieval_when_no_active_leaderboard_exists
=== RUN   TestGetLeaderboard/Successful_retrieval_of_active_leaderboard_with_empty_data
2025/05/31 08:59:55 Cleaning up test environment...
2025/05/31 08:59:55 Context cancelled.
2025/05/31 08:59:55 EventBus closed.
2025/05/31 08:59:55 NATS connection closed.
2025/05/31 08:59:55 DB connection closed.
2025/05/31 08:59:55  Stopping container: 08fc9c356f93
2025/05/31 08:59:56  Container stopped: 08fc9c356f93
2025/05/31 08:59:56  Terminating container: 08fc9c356f93
2025/05/31 08:59:56  Container terminated: 08fc9c356f93
2025/05/31 08:59:56 NATS container terminated.
2025/05/31 08:59:56  Stopping container: cdd435aa1330
2025/05/31 08:59:56  Container stopped: cdd435aa1330
2025/05/31 08:59:56  Terminating container: cdd435aa1330
2025/05/31 08:59:56  Container terminated: cdd435aa1330
2025/05/31 08:59:56 PostgreSQL container terminated.
2025/05/31 08:59:56 Cleanup complete.
--- PASS: TestGetLeaderboard (19.05s)
    --- PASS: TestGetLeaderboard/Successful_retrieval_of_active_leaderboard_with_data (0.05s)
    --- PASS: TestGetLeaderboard/Retrieval_when_no_active_leaderboard_exists (0.03s)
    --- PASS: TestGetLeaderboard/Successful_retrieval_of_active_leaderboard_with_empty_data (0.05s)
=== RUN   TestRoundGetTagByUserID
2025/05/31 08:59:56 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:56  Creating container for image postgres:16-alpine
2025/05/31 08:59:57  Container created: b760f7d8ea53
2025/05/31 08:59:57  Starting container: b760f7d8ea53
2025/05/31 08:59:58  Container started: b760f7d8ea53
2025/05/31 08:59:58  Waiting for container id b760f7d8ea53 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc00068b0d0 Strategies:[0xc00053fd10]}
2025/05/31 09:00:06  Container is ready: b760f7d8ea53
2025/05/31 09:00:06 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38871/testdb?sslmode=disable
2025/05/31 09:00:06 Starting NATS container with resource limits...
2025/05/31 09:00:06  Creating container for image nats:2.10-alpine
2025/05/31 09:00:06  Container created: 001da867bcae
2025/05/31 09:00:06  Starting container: 001da867bcae
2025/05/31 09:00:07  Container started: 001da867bcae
2025/05/31 09:00:07  Waiting for container id 001da867bcae image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00056ebd0 Strategies:[0xc0005a2b40 0xc0005b9020]}
2025/05/31 09:00:08  Container is ready: 001da867bcae
2025/05/31 09:00:08 NATS container started with resource limits. URL: nats://localhost:38885
Creating user table...
User table created successfully!
2025/05/31 09:00:09 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:09 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:09 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:09 Ran leaderboard migrations group #4
2025/05/31 09:00:09 All migrations ran successfully
2025/05/31 09:00:09 newDBServiceWithDB - Registering models
2025/05/31 09:00:09 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:09 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007e4a0 RoundDB:0xc00007e4a8 ScoreDB:0xc00007e4b0 LeaderboardDB:0xc00007e4b8 db:0xc0002ba8c0}
2025/05/31 09:00:09 Truncating tables: leaderboards
=== RUN   TestRoundGetTagByUserID/Successful_retrieval_of_tag_for_user_with_tag
=== RUN   TestRoundGetTagByUserID/User_exists_but_has_no_tag_number
2025/05/31 09:00:09 WARN No tag found for user in active leaderboard data user_id=user_no_tag
=== RUN   TestRoundGetTagByUserID/User_ID_not_found_in_database
2025/05/31 09:00:09 WARN No tag found for user in active leaderboard data user_id=non_existent_user
2025/05/31 09:00:09 Cleaning up test environment...
2025/05/31 09:00:09 Context cancelled.
2025/05/31 09:00:09 EventBus closed.
2025/05/31 09:00:09 NATS connection closed.
2025/05/31 09:00:09 DB connection closed.
2025/05/31 09:00:09  Stopping container: 001da867bcae
2025/05/31 09:00:10  Container stopped: 001da867bcae
2025/05/31 09:00:10  Terminating container: 001da867bcae
2025/05/31 09:00:10  Container terminated: 001da867bcae
2025/05/31 09:00:10 NATS container terminated.
2025/05/31 09:00:10  Stopping container: b760f7d8ea53
2025/05/31 09:00:10  Container stopped: b760f7d8ea53
2025/05/31 09:00:10  Terminating container: b760f7d8ea53
2025/05/31 09:00:10  Container terminated: b760f7d8ea53
2025/05/31 09:00:10 PostgreSQL container terminated.
2025/05/31 09:00:10 Cleanup complete.
--- PASS: TestRoundGetTagByUserID (13.52s)
    --- PASS: TestRoundGetTagByUserID/Successful_retrieval_of_tag_for_user_with_tag (0.04s)
    --- PASS: TestRoundGetTagByUserID/User_exists_but_has_no_tag_number (0.03s)
    --- PASS: TestRoundGetTagByUserID/User_ID_not_found_in_database (0.02s)
=== RUN   TestGetTagByUserID
2025/05/31 09:00:10 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:10  Creating container for image postgres:16-alpine
2025/05/31 09:00:10  Container created: b6955a539894
2025/05/31 09:00:10  Starting container: b6955a539894
2025/05/31 09:00:11  Container started: b6955a539894
2025/05/31 09:00:11  Waiting for container id b6955a539894 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005e01b0 Strategies:[0xc0004fc360]}
2025/05/31 09:00:15  Container is ready: b6955a539894
2025/05/31 09:00:15 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38895/testdb?sslmode=disable
2025/05/31 09:00:15 Starting NATS container with resource limits...
2025/05/31 09:00:15  Creating container for image nats:2.10-alpine
2025/05/31 09:00:15  Container created: 3e209dd59e17
2025/05/31 09:00:15  Starting container: 3e209dd59e17
2025/05/31 09:00:16  Container started: 3e209dd59e17
2025/05/31 09:00:16  Waiting for container id 3e209dd59e17 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0006b66f0 Strategies:[0xc000680720 0xc00042c750]}
2025/05/31 09:00:18  Container is ready: 3e209dd59e17
2025/05/31 09:00:18 NATS container started with resource limits. URL: nats://localhost:38900
Creating round table...
Round table created successfully!
2025/05/31 09:00:18 Ran round migrations group #1
Creating score table...
Score table created successfully!
2025/05/31 09:00:18 Ran score migrations group #2
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:18 Ran leaderboard migrations group #3
Creating user table...
User table created successfully!
2025/05/31 09:00:18 Ran user migrations group #4
2025/05/31 09:00:18 All migrations ran successfully
2025/05/31 09:00:18 newDBServiceWithDB - Registering models
2025/05/31 09:00:18 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:18 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005a01e0 RoundDB:0xc0005a01e8 ScoreDB:0xc0005a01f0 LeaderboardDB:0xc0005a01f8 db:0xc0005bb3c0}
2025/05/31 09:00:18 Truncating tables: leaderboards
=== RUN   TestGetTagByUserID/Successful_retrieval_of_tag_for_user_with_tag
=== RUN   TestGetTagByUserID/User_exists_but_has_no_tag_number
2025/05/31 09:00:18 WARN No tag found for user in active leaderboard data user_id=user_C
=== RUN   TestGetTagByUserID/User_ID_not_found_in_database
2025/05/31 09:00:18 WARN No tag found for user in active leaderboard data user_id=non_existent_user_2
2025/05/31 09:00:18 Cleaning up test environment...
2025/05/31 09:00:18 Context cancelled.
2025/05/31 09:00:18 EventBus closed.
2025/05/31 09:00:18 NATS connection closed.
2025/05/31 09:00:18 DB connection closed.
2025/05/31 09:00:18  Stopping container: 3e209dd59e17
2025/05/31 09:00:19  Container stopped: 3e209dd59e17
2025/05/31 09:00:19  Terminating container: 3e209dd59e17
2025/05/31 09:00:19  Container terminated: 3e209dd59e17
2025/05/31 09:00:19 NATS container terminated.
2025/05/31 09:00:19  Stopping container: b6955a539894
2025/05/31 09:00:20  Container stopped: b6955a539894
2025/05/31 09:00:20  Terminating container: b6955a539894
2025/05/31 09:00:20  Container terminated: b6955a539894
2025/05/31 09:00:20 PostgreSQL container terminated.
2025/05/31 09:00:20 Cleanup complete.
--- PASS: TestGetTagByUserID (10.29s)
    --- PASS: TestGetTagByUserID/Successful_retrieval_of_tag_for_user_with_tag (0.03s)
    --- PASS: TestGetTagByUserID/User_exists_but_has_no_tag_number (0.04s)
    --- PASS: TestGetTagByUserID/User_ID_not_found_in_database (0.02s)
=== RUN   TestTagAssignmentRequested
2025/05/31 09:00:20 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:20  Creating container for image postgres:16-alpine
2025/05/31 09:00:21  Container created: b70329a9655c
2025/05/31 09:00:21  Starting container: b70329a9655c
2025/05/31 09:00:21  Container started: b70329a9655c
2025/05/31 09:00:21  Waiting for container id b70329a9655c image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc00068a460 Strategies:[0xc0005ddd40]}
2025/05/31 09:00:26  Container is ready: b70329a9655c
2025/05/31 09:00:26 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38912/testdb?sslmode=disable
2025/05/31 09:00:26 Starting NATS container with resource limits...
2025/05/31 09:00:26  Creating container for image nats:2.10-alpine
2025/05/31 09:00:26  Container created: 574760237e8f
2025/05/31 09:00:26  Starting container: 574760237e8f
2025/05/31 09:00:27  Container started: 574760237e8f
2025/05/31 09:00:27  Waiting for container id 574760237e8f image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00056ee78 Strategies:[0xc00032da40 0xc000595d10]}
2025/05/31 09:00:30  Container is ready: 574760237e8f
2025/05/31 09:00:30 NATS container started with resource limits. URL: nats://localhost:38923
Creating user table...
User table created successfully!
2025/05/31 09:00:30 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:30 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:30 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:30 Ran leaderboard migrations group #4
2025/05/31 09:00:30 All migrations ran successfully
2025/05/31 09:00:30 newDBServiceWithDB - Registering models
2025/05/31 09:00:30 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:30 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0004f2268 RoundDB:0xc0004f2270 ScoreDB:0xc0004f2278 LeaderboardDB:0xc0004f2280 db:0xc000523b00}
2025/05/31 09:00:30 Truncating tables: leaderboards
=== RUN   TestTagAssignmentRequested/Successful_tag_assignment_to_a_new_user
=== RUN   TestTagAssignmentRequested/Tag_assignment_fails_if_tag_is_already_assigned
=== RUN   TestTagAssignmentRequested/Tag_assignment_fails_if_no_active_leaderboard_exists
=== RUN   TestTagAssignmentRequested/Tag_assignment_fails_for_invalid_tag_number_(e.g.,_negative)
2025/05/31 09:00:30 Cleaning up test environment...
2025/05/31 09:00:30 Context cancelled.
2025/05/31 09:00:30 EventBus closed.
2025/05/31 09:00:30 NATS connection closed.
2025/05/31 09:00:30 DB connection closed.
2025/05/31 09:00:30  Stopping container: 574760237e8f
2025/05/31 09:00:31  Container stopped: 574760237e8f
2025/05/31 09:00:31  Terminating container: 574760237e8f
2025/05/31 09:00:31  Container terminated: 574760237e8f
2025/05/31 09:00:31 NATS container terminated.
2025/05/31 09:00:31  Stopping container: b70329a9655c
2025/05/31 09:00:32  Container stopped: b70329a9655c
2025/05/31 09:00:32  Terminating container: b70329a9655c
2025/05/31 09:00:32  Container terminated: b70329a9655c
2025/05/31 09:00:32 PostgreSQL container terminated.
2025/05/31 09:00:32 Cleanup complete.
--- PASS: TestTagAssignmentRequested (11.99s)
    --- PASS: TestTagAssignmentRequested/Successful_tag_assignment_to_a_new_user (0.08s)
    --- PASS: TestTagAssignmentRequested/Tag_assignment_fails_if_tag_is_already_assigned (0.04s)
    --- PASS: TestTagAssignmentRequested/Tag_assignment_fails_if_no_active_leaderboard_exists (0.01s)
    --- PASS: TestTagAssignmentRequested/Tag_assignment_fails_for_invalid_tag_number_(e.g.,_negative) (0.02s)
=== RUN   TestCheckTagAvailability
2025/05/31 09:00:32 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:32  Creating container for image postgres:16-alpine
2025/05/31 09:00:33  Container created: 7a8d0a6b967d
2025/05/31 09:00:33  Starting container: 7a8d0a6b967d
2025/05/31 09:00:33  Container started: 7a8d0a6b967d
2025/05/31 09:00:33  Waiting for container id 7a8d0a6b967d image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0004711e0 Strategies:[0xc00064b1d0]}
2025/05/31 09:00:38  Container is ready: 7a8d0a6b967d
2025/05/31 09:00:38 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38934/testdb?sslmode=disable
2025/05/31 09:00:38 Starting NATS container with resource limits...
2025/05/31 09:00:38  Creating container for image nats:2.10-alpine
2025/05/31 09:00:38  Container created: 3f7d7ce8c5d1
2025/05/31 09:00:38  Starting container: 3f7d7ce8c5d1
2025/05/31 09:00:39  Container started: 3f7d7ce8c5d1
2025/05/31 09:00:39  Waiting for container id 3f7d7ce8c5d1 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000470348 Strategies:[0xc000630060 0xc0005a8630]}
2025/05/31 09:00:41  Container is ready: 3f7d7ce8c5d1
2025/05/31 09:00:41 NATS container started with resource limits. URL: nats://localhost:38946
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:41 Ran leaderboard migrations group #1
Creating user table...
User table created successfully!
2025/05/31 09:00:41 Ran user migrations group #2
Creating round table...
Round table created successfully!
2025/05/31 09:00:42 Ran round migrations group #3
Creating score table...
Score table created successfully!
2025/05/31 09:00:42 Ran score migrations group #4
2025/05/31 09:00:42 All migrations ran successfully
2025/05/31 09:00:42 newDBServiceWithDB - Registering models
2025/05/31 09:00:42 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:42 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005aa080 RoundDB:0xc0005aa090 ScoreDB:0xc0005aa0b8 LeaderboardDB:0xc0005aa0c0 db:0xc0005bab40}
2025/05/31 09:00:42 Truncating tables: leaderboards
=== RUN   TestCheckTagAvailability/Tag_is_available_when_no_active_leaderboard_exists
=== RUN   TestCheckTagAvailability/Tag_is_available_when_active_leaderboard_exists_but_tag_is_not_assigned
=== RUN   TestCheckTagAvailability/Tag_is_not_available_when_active_leaderboard_exists_and_tag_is_assigned
    tag_availability_test.go:203: Debug: Created leaderboard ID 3 with 2 entries, IsActive=true
    tag_availability_test.go:206: Debug: Entry 0: UserID=tag_unavail_user_x, TagNumber=50
    tag_availability_test.go:206: Debug: Entry 1: UserID=tag_unavail_user_y, TagNumber=60
=== RUN   TestCheckTagAvailability/Tag_availability_check_succeeds_for_invalid_tag_number_(e.g.,_negative)
2025/05/31 09:00:42 Cleaning up test environment...
2025/05/31 09:00:42 Context cancelled.
2025/05/31 09:00:42 EventBus closed.
2025/05/31 09:00:42 NATS connection closed.
2025/05/31 09:00:42 DB connection closed.
2025/05/31 09:00:42  Stopping container: 3f7d7ce8c5d1
2025/05/31 09:00:42  Container stopped: 3f7d7ce8c5d1
2025/05/31 09:00:42  Terminating container: 3f7d7ce8c5d1
2025/05/31 09:00:42  Container terminated: 3f7d7ce8c5d1
2025/05/31 09:00:42 NATS container terminated.
2025/05/31 09:00:42  Stopping container: 7a8d0a6b967d
2025/05/31 09:00:43  Container stopped: 7a8d0a6b967d
2025/05/31 09:00:43  Terminating container: 7a8d0a6b967d
2025/05/31 09:00:43  Container terminated: 7a8d0a6b967d
2025/05/31 09:00:43 PostgreSQL container terminated.
2025/05/31 09:00:43 Cleanup complete.
--- PASS: TestCheckTagAvailability (10.59s)
    --- PASS: TestCheckTagAvailability/Tag_is_available_when_no_active_leaderboard_exists (0.02s)
    --- PASS: TestCheckTagAvailability/Tag_is_available_when_active_leaderboard_exists_but_tag_is_not_assigned (0.04s)
    --- PASS: TestCheckTagAvailability/Tag_is_not_available_when_active_leaderboard_exists_and_tag_is_assigned (0.04s)
    --- PASS: TestCheckTagAvailability/Tag_availability_check_succeeds_for_invalid_tag_number_(e.g.,_negative) (0.02s)
=== RUN   TestTagSwapRequested
2025/05/31 09:00:43 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:43  Creating container for image postgres:16-alpine
2025/05/31 09:00:43  Container created: 8580d1effa30
2025/05/31 09:00:43  Starting container: 8580d1effa30
2025/05/31 09:00:43  Container started: 8580d1effa30
2025/05/31 09:00:43  Waiting for container id 8580d1effa30 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000306f40 Strategies:[0xc0002139e0]}
2025/05/31 09:00:48  Container is ready: 8580d1effa30
2025/05/31 09:00:48 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38953/testdb?sslmode=disable
2025/05/31 09:00:48 Starting NATS container with resource limits...
2025/05/31 09:00:48  Creating container for image nats:2.10-alpine
2025/05/31 09:00:48  Container created: 30a5057e971a
2025/05/31 09:00:48  Starting container: 30a5057e971a
2025/05/31 09:00:49  Container started: 30a5057e971a
2025/05/31 09:00:49  Waiting for container id 30a5057e971a image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0002ad8b8 Strategies:[0xc000880600 0xc0007b4ff0]}
2025/05/31 09:00:50  Container is ready: 30a5057e971a
2025/05/31 09:00:50 NATS container started with resource limits. URL: nats://localhost:38960
Creating user table...
User table created successfully!
2025/05/31 09:00:50 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:50 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:50 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:50 Ran leaderboard migrations group #4
2025/05/31 09:00:50 All migrations ran successfully
2025/05/31 09:00:50 newDBServiceWithDB - Registering models
2025/05/31 09:00:50 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:50 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007e600 RoundDB:0xc00007e608 ScoreDB:0xc00007e610 LeaderboardDB:0xc00007e618 db:0xc000893440}
2025/05/31 09:00:50 Truncating tables: leaderboards
=== RUN   TestTagSwapRequested/Successful_tag_swap_between_two_users
2025/05/31 09:00:50 Truncating tables: leaderboards
=== RUN   TestTagSwapRequested/Tag_swap_fails_if_requestor_does_not_have_a_tag
2025/05/31 09:00:50 Truncating tables: leaderboards
=== RUN   TestTagSwapRequested/Tag_swap_fails_if_target_does_not_have_a_tag
2025/05/31 09:00:50 Truncating tables: leaderboards
=== RUN   TestTagSwapRequested/Tag_swap_fails_if_neither_user_has_a_tag
2025/05/31 09:00:50 Truncating tables: leaderboards
=== RUN   TestTagSwapRequested/Tag_swap_fails_if_no_active_leaderboard_exists
2025/05/31 09:00:50 Truncating tables: leaderboards
2025/05/31 09:00:50 Cleaning up test environment...
2025/05/31 09:00:50 Context cancelled.
2025/05/31 09:00:50 EventBus closed.
2025/05/31 09:00:50 NATS connection closed.
2025/05/31 09:00:50 DB connection closed.
2025/05/31 09:00:50  Stopping container: 30a5057e971a
2025/05/31 09:00:51  Container stopped: 30a5057e971a
2025/05/31 09:00:51  Terminating container: 30a5057e971a
2025/05/31 09:00:51  Container terminated: 30a5057e971a
2025/05/31 09:00:51 NATS container terminated.
2025/05/31 09:00:51  Stopping container: 8580d1effa30
2025/05/31 09:00:52  Container stopped: 8580d1effa30
2025/05/31 09:00:52  Terminating container: 8580d1effa30
2025/05/31 09:00:52  Container terminated: 8580d1effa30
2025/05/31 09:00:52 PostgreSQL container terminated.
2025/05/31 09:00:52 Cleanup complete.
--- PASS: TestTagSwapRequested (9.24s)
    --- PASS: TestTagSwapRequested/Successful_tag_swap_between_two_users (0.11s)
    --- PASS: TestTagSwapRequested/Tag_swap_fails_if_requestor_does_not_have_a_tag (0.02s)
    --- PASS: TestTagSwapRequested/Tag_swap_fails_if_target_does_not_have_a_tag (0.06s)
    --- PASS: TestTagSwapRequested/Tag_swap_fails_if_neither_user_has_a_tag (0.05s)
    --- PASS: TestTagSwapRequested/Tag_swap_fails_if_no_active_leaderboard_exists (0.03s)
PASS
coverage: 8.1% of statements in ./app/...
2025/05/31 09:00:52 TestMain: finished with exit code: 0
ok  	github.com/Black-And-White-Club/frolf-bot/integration_tests/modules/leaderboard/application_tests	100.272s	coverage: 8.1% of statements in ./app/...
2025/05/31 08:59:15 TestMain started in package leaderboardhandler_integration_tests
=== RUN   TestHandleBatchTagAssignmentRequested
=== RUN   TestHandleBatchTagAssignmentRequested/Success_-_Process_Valid_Batch_Assignments
2025/05/31 08:59:15 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:15 github.com/testcontainers/testcontainers-go - Connected to docker: 
  Server Version: 28.1.1
  API Version: 1.48
  Operating System: Ubuntu 24.04.1 LTS
  Total Memory: 5923 MB
  Testcontainers for Go Version: v0.37.0
  Resolved Docker Host: unix:///Users/jace/.colima/default/docker.sock
  Resolved Docker Socket Path: /var/run/docker.sock
  Test SessionID: 3bcca53efbc96e46a6c192358bf7642f396e27e5bff8699ef9bf67ff02cc0815
  Test ProcessID: c404634c-0a37-4ad8-9f02-61943b3605b9
2025/05/31 08:59:15  Creating container for image postgres:16-alpine
2025/05/31 08:59:15  Waiting for Reaper "f69f8f9c" to be ready
2025/05/31 08:59:16  Reaper obtained from Docker for this test session f69f8f9c
2025/05/31 08:59:16  Container created: 5ae364bab6d3
2025/05/31 08:59:16  Starting container: 5ae364bab6d3
2025/05/31 08:59:17  Container started: 5ae364bab6d3
2025/05/31 08:59:17  Waiting for container id 5ae364bab6d3 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0003ee3a0 Strategies:[0xc0003f0900]}
2025/05/31 08:59:26  Container is ready: 5ae364bab6d3
2025/05/31 08:59:26 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38811/testdb?sslmode=disable
2025/05/31 08:59:26 Starting NATS container with resource limits...
2025/05/31 08:59:26  Creating container for image nats:2.10-alpine
2025/05/31 08:59:26  Container created: 6409058ac214
2025/05/31 08:59:26  Starting container: 6409058ac214
2025/05/31 08:59:28  Container started: 6409058ac214
2025/05/31 08:59:28  Waiting for container id 6409058ac214 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0006e4620 Strategies:[0xc0000b7c80 0xc0002898c0]}
2025/05/31 08:59:29  Container is ready: 6409058ac214
2025/05/31 08:59:29 NATS container started with resource limits. URL: nats://localhost:38818
Creating round table...
Round table created successfully!
2025/05/31 08:59:30 Ran round migrations group #1
Creating score table...
Score table created successfully!
2025/05/31 08:59:30 Ran score migrations group #2
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:30 Ran leaderboard migrations group #3
Creating user table...
User table created successfully!
2025/05/31 08:59:30 Ran user migrations group #4
2025/05/31 08:59:30 All migrations ran successfully
2025/05/31 08:59:30 newDBServiceWithDB - Registering models
2025/05/31 08:59:30 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:30 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0004e40f8 RoundDB:0xc0004e4100 ScoreDB:0xc0004e4108 LeaderboardDB:0xc0004e4110 db:0xc00043b0c0}
2025/05/31 08:59:30 Truncating tables: leaderboards
    batch_tag_assign_test.go:373: Waiting for 1 messages on topic "discord.leaderboard.batch.tag.assigned" with timeout 5s
2025/05/31 08:59:31 Test received message 9b708ffe-f504-43a9-9482-330fbbb3a470 on topic "discord.leaderboard.batch.tag.assigned"
    batch_tag_assign_test.go:373: Successfully received 1 messages on topic "discord.leaderboard.batch.tag.assigned"
    batch_tag_assign_test.go:161: Actual leaderboard data: map[300350211:2 497102564:10 589197386:20 838238609:1]
2025/05/31 08:59:32 Test Case "TestHandleBatchTagAssignmentRequested/Success_-_Process_Valid_Batch_Assignments": Canceling subscription context.
2025/05/31 08:59:32 Test Case "TestHandleBatchTagAssignmentRequested/Success_-_Process_Valid_Batch_Assignments": Waiting for subscriber goroutines to finish.
2025/05/31 08:59:32 Test Case "TestHandleBatchTagAssignmentRequested/Success_-_Process_Valid_Batch_Assignments": Subscriber goroutines finished.
2025/05/31 08:59:32 Running leaderboard handler test cleanup...
2025/05/31 08:59:33 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 08:59:33 Router goroutine finished.
2025/05/31 08:59:33 Leaderboard handler test cleanup finished.
2025/05/31 08:59:33 Cleaning up test environment...
2025/05/31 08:59:33 Context cancelled.
2025/05/31 08:59:33 EventBus closed.
2025/05/31 08:59:33 NATS connection closed.
2025/05/31 08:59:33 DB connection closed.
2025/05/31 08:59:33  Stopping container: 6409058ac214
2025/05/31 08:59:34  Container stopped: 6409058ac214
2025/05/31 08:59:34  Terminating container: 6409058ac214
2025/05/31 08:59:34  Container terminated: 6409058ac214
2025/05/31 08:59:34 NATS container terminated.
2025/05/31 08:59:34  Stopping container: 5ae364bab6d3
2025/05/31 08:59:35  Container stopped: 5ae364bab6d3
2025/05/31 08:59:35  Terminating container: 5ae364bab6d3
2025/05/31 08:59:35  Container terminated: 5ae364bab6d3
2025/05/31 08:59:35 PostgreSQL container terminated.
2025/05/31 08:59:35 Cleanup complete.
=== RUN   TestHandleBatchTagAssignmentRequested/Success_-_Batch_Assignment_with_Already_Assigned_Tag_
2025/05/31 08:59:35 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:35  Creating container for image postgres:16-alpine
2025/05/31 08:59:36  Container created: 8e7dc35e94c0
2025/05/31 08:59:36  Starting container: 8e7dc35e94c0
2025/05/31 08:59:37  Container started: 8e7dc35e94c0
2025/05/31 08:59:37  Waiting for container id 8e7dc35e94c0 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000386cb0 Strategies:[0xc000499830]}
2025/05/31 08:59:46  Container is ready: 8e7dc35e94c0
2025/05/31 08:59:46 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38842/testdb?sslmode=disable
2025/05/31 08:59:46 Starting NATS container with resource limits...
2025/05/31 08:59:46  Creating container for image nats:2.10-alpine
2025/05/31 08:59:46  Container created: 028133af35be
2025/05/31 08:59:46  Starting container: 028133af35be
2025/05/31 08:59:47  Container started: 028133af35be
2025/05/31 08:59:47  Waiting for container id 028133af35be image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000387270 Strategies:[0xc00054e7e0 0xc000265800]}
2025/05/31 08:59:50  Container is ready: 028133af35be
2025/05/31 08:59:50 NATS container started with resource limits. URL: nats://localhost:38848
Creating user table...
User table created successfully!
2025/05/31 08:59:51 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 08:59:51 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 08:59:51 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:51 Ran leaderboard migrations group #4
2025/05/31 08:59:51 All migrations ran successfully
2025/05/31 08:59:51 newDBServiceWithDB - Registering models
2025/05/31 08:59:51 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:51 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000626198 RoundDB:0xc0006261c0 ScoreDB:0xc0006261c8 LeaderboardDB:0xc0006261d8 db:0xc00043b600}
2025/05/31 08:59:51 Truncating tables: leaderboards
    batch_tag_assign_test.go:373: Waiting for 1 messages on topic "discord.leaderboard.batch.tag.assigned" with timeout 5s
2025/05/31 08:59:52 Test received message 349022bd-cb86-403e-9a52-5d358eced8fe on topic "discord.leaderboard.batch.tag.assigned"
    batch_tag_assign_test.go:373: Successfully received 1 messages on topic "discord.leaderboard.batch.tag.assigned"
2025/05/31 08:59:52 Test Case "TestHandleBatchTagAssignmentRequested/Success_-_Batch_Assignment_with_Already_Assigned_Tag_": Canceling subscription context.
2025/05/31 08:59:52 Test Case "TestHandleBatchTagAssignmentRequested/Success_-_Batch_Assignment_with_Already_Assigned_Tag_": Waiting for subscriber goroutines to finish.
2025/05/31 08:59:52 Test Case "TestHandleBatchTagAssignmentRequested/Success_-_Batch_Assignment_with_Already_Assigned_Tag_": Subscriber goroutines finished.
2025/05/31 08:59:52 Running leaderboard handler test cleanup...
2025/05/31 08:59:53 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 08:59:53 Router goroutine finished.
2025/05/31 08:59:53 Leaderboard handler test cleanup finished.
2025/05/31 08:59:53 Cleaning up test environment...
2025/05/31 08:59:53 Context cancelled.
2025/05/31 08:59:53 EventBus closed.
2025/05/31 08:59:53 NATS connection closed.
2025/05/31 08:59:53 DB connection closed.
2025/05/31 08:59:53  Stopping container: 028133af35be
2025/05/31 08:59:54  Container stopped: 028133af35be
2025/05/31 08:59:54  Terminating container: 028133af35be
2025/05/31 08:59:54  Container terminated: 028133af35be
2025/05/31 08:59:54 NATS container terminated.
2025/05/31 08:59:54  Stopping container: 8e7dc35e94c0
2025/05/31 08:59:54  Container stopped: 8e7dc35e94c0
2025/05/31 08:59:54  Terminating container: 8e7dc35e94c0
2025/05/31 08:59:55  Container terminated: 8e7dc35e94c0
2025/05/31 08:59:55 PostgreSQL container terminated.
2025/05/31 08:59:55 Cleanup complete.
=== RUN   TestHandleBatchTagAssignmentRequested/Failure_-_Invalid_Message_Payload_(Unmarshal_Error)
2025/05/31 08:59:55 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:55  Creating container for image postgres:16-alpine
2025/05/31 08:59:55  Container created: 66fc7017ff42
2025/05/31 08:59:55  Starting container: 66fc7017ff42
2025/05/31 08:59:56  Container started: 66fc7017ff42
2025/05/31 08:59:56  Waiting for container id 66fc7017ff42 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000657b18 Strategies:[0xc0004c88a0]}
2025/05/31 09:00:03  Container is ready: 66fc7017ff42
2025/05/31 09:00:03 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38869/testdb?sslmode=disable
2025/05/31 09:00:03 Starting NATS container with resource limits...
2025/05/31 09:00:03  Creating container for image nats:2.10-alpine
2025/05/31 09:00:03  Container created: f7be7e2bbca1
2025/05/31 09:00:03  Starting container: f7be7e2bbca1
2025/05/31 09:00:05  Container started: f7be7e2bbca1
2025/05/31 09:00:05  Waiting for container id f7be7e2bbca1 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000656518 Strategies:[0xc0005446c0 0xc00021ce40]}
2025/05/31 09:00:09  Container is ready: f7be7e2bbca1
2025/05/31 09:00:09 NATS container started with resource limits. URL: nats://localhost:38880
Creating user table...
User table created successfully!
2025/05/31 09:00:09 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:09 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:09 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:09 Ran leaderboard migrations group #4
2025/05/31 09:00:09 All migrations ran successfully
2025/05/31 09:00:09 newDBServiceWithDB - Registering models
2025/05/31 09:00:09 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:09 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007c690 RoundDB:0xc00007c698 ScoreDB:0xc00007c6a0 LeaderboardDB:0xc00007c6a8 db:0xc00043b3c0}
2025/05/31 09:00:09 Truncating tables: leaderboards
2025/05/31 09:00:10 Test Case "TestHandleBatchTagAssignmentRequested/Failure_-_Invalid_Message_Payload_(Unmarshal_Error)": Canceling subscription context.
2025/05/31 09:00:10 Test Case "TestHandleBatchTagAssignmentRequested/Failure_-_Invalid_Message_Payload_(Unmarshal_Error)": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:10 Test Case "TestHandleBatchTagAssignmentRequested/Failure_-_Invalid_Message_Payload_(Unmarshal_Error)": Subscriber goroutines finished.
2025/05/31 09:00:10 Running leaderboard handler test cleanup...
2025/05/31 09:00:11 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:00:11 Router goroutine finished.
2025/05/31 09:00:11 Leaderboard handler test cleanup finished.
2025/05/31 09:00:11 Cleaning up test environment...
2025/05/31 09:00:11 Context cancelled.
2025/05/31 09:00:11 EventBus closed.
2025/05/31 09:00:11 NATS connection closed.
2025/05/31 09:00:11 DB connection closed.
2025/05/31 09:00:11  Stopping container: f7be7e2bbca1
2025/05/31 09:00:12  Container stopped: f7be7e2bbca1
2025/05/31 09:00:12  Terminating container: f7be7e2bbca1
2025/05/31 09:00:12  Container terminated: f7be7e2bbca1
2025/05/31 09:00:12 NATS container terminated.
2025/05/31 09:00:12  Stopping container: 66fc7017ff42
2025/05/31 09:00:12  Container stopped: 66fc7017ff42
2025/05/31 09:00:12  Terminating container: 66fc7017ff42
2025/05/31 09:00:12  Container terminated: 66fc7017ff42
2025/05/31 09:00:12 PostgreSQL container terminated.
2025/05/31 09:00:12 Cleanup complete.
=== RUN   TestHandleBatchTagAssignmentRequested/Failure_-_Service_Returns_Error
2025/05/31 09:00:12 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:12  Creating container for image postgres:16-alpine
2025/05/31 09:00:13  Container created: cf05b3649683
2025/05/31 09:00:13  Starting container: cf05b3649683
2025/05/31 09:00:13  Container started: cf05b3649683
2025/05/31 09:00:13  Waiting for container id cf05b3649683 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0003efce8 Strategies:[0xc000663170]}
2025/05/31 09:00:18  Container is ready: cf05b3649683
2025/05/31 09:00:19 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38899/testdb?sslmode=disable
2025/05/31 09:00:19 Starting NATS container with resource limits...
2025/05/31 09:00:19  Creating container for image nats:2.10-alpine
2025/05/31 09:00:19  Container created: 308dac724ef4
2025/05/31 09:00:19  Starting container: 308dac724ef4
2025/05/31 09:00:20  Container started: 308dac724ef4
2025/05/31 09:00:20  Waiting for container id 308dac724ef4 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0000125d8 Strategies:[0xc000110480 0xc000569290]}
2025/05/31 09:00:23  Container is ready: 308dac724ef4
2025/05/31 09:00:23 NATS container started with resource limits. URL: nats://localhost:38907
Creating user table...
User table created successfully!
2025/05/31 09:00:23 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:23 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:23 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:23 Ran leaderboard migrations group #4
2025/05/31 09:00:23 All migrations ran successfully
2025/05/31 09:00:23 newDBServiceWithDB - Registering models
2025/05/31 09:00:23 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:23 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000444418 RoundDB:0xc000444420 ScoreDB:0xc000444430 LeaderboardDB:0xc000444438 db:0xc0007cda40}
2025/05/31 09:00:23 Truncating tables: leaderboards
2025/05/31 09:00:24 Test Case "TestHandleBatchTagAssignmentRequested/Failure_-_Service_Returns_Error": Canceling subscription context.
2025/05/31 09:00:24 Test Case "TestHandleBatchTagAssignmentRequested/Failure_-_Service_Returns_Error": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:24 Test Case "TestHandleBatchTagAssignmentRequested/Failure_-_Service_Returns_Error": Subscriber goroutines finished.
2025/05/31 09:00:24 Running leaderboard handler test cleanup...
2025/05/31 09:00:25 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:00:25 Router goroutine finished.
2025/05/31 09:00:25 Leaderboard handler test cleanup finished.
2025/05/31 09:00:25 Cleaning up test environment...
2025/05/31 09:00:25 Context cancelled.
2025/05/31 09:00:25 EventBus closed.
2025/05/31 09:00:25 NATS connection closed.
2025/05/31 09:00:25 DB connection closed.
2025/05/31 09:00:25  Stopping container: 308dac724ef4
2025/05/31 09:00:26  Container stopped: 308dac724ef4
2025/05/31 09:00:26  Terminating container: 308dac724ef4
2025/05/31 09:00:26  Container terminated: 308dac724ef4
2025/05/31 09:00:26 NATS container terminated.
2025/05/31 09:00:26  Stopping container: cf05b3649683
2025/05/31 09:00:27  Container stopped: cf05b3649683
2025/05/31 09:00:27  Terminating container: cf05b3649683
2025/05/31 09:00:27  Container terminated: cf05b3649683
2025/05/31 09:00:27 PostgreSQL container terminated.
2025/05/31 09:00:27 Cleanup complete.
--- PASS: TestHandleBatchTagAssignmentRequested (71.96s)
    --- PASS: TestHandleBatchTagAssignmentRequested/Success_-_Process_Valid_Batch_Assignments (20.17s)
    --- PASS: TestHandleBatchTagAssignmentRequested/Success_-_Batch_Assignment_with_Already_Assigned_Tag_ (19.40s)
    --- PASS: TestHandleBatchTagAssignmentRequested/Failure_-_Invalid_Message_Payload_(Unmarshal_Error) (17.82s)
    --- PASS: TestHandleBatchTagAssignmentRequested/Failure_-_Service_Returns_Error (14.57s)
=== RUN   TestHandleGetLeaderboardRequested
=== RUN   TestHandleGetLeaderboardRequested/Success_-_Get_Leaderboard_With_Data
2025/05/31 09:00:27 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:27  Creating container for image postgres:16-alpine
2025/05/31 09:00:27  Container created: 0786c19d46f4
2025/05/31 09:00:27  Starting container: 0786c19d46f4
2025/05/31 09:00:28  Container started: 0786c19d46f4
2025/05/31 09:00:28  Waiting for container id 0786c19d46f4 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0006e46d8 Strategies:[0xc000988b70]}
2025/05/31 09:00:32  Container is ready: 0786c19d46f4
2025/05/31 09:00:32 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38926/testdb?sslmode=disable
2025/05/31 09:00:32 Starting NATS container with resource limits...
2025/05/31 09:00:32  Creating container for image nats:2.10-alpine
2025/05/31 09:00:32  Container created: 8d7e54d511ba
2025/05/31 09:00:32  Starting container: 8d7e54d511ba
2025/05/31 09:00:33  Container started: 8d7e54d511ba
2025/05/31 09:00:33  Waiting for container id 8d7e54d511ba image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00051b198 Strategies:[0xc000653080 0xc0009897a0]}
2025/05/31 09:00:35  Container is ready: 8d7e54d511ba
2025/05/31 09:00:35 NATS container started with resource limits. URL: nats://localhost:38931
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:35 Ran leaderboard migrations group #1
Creating user table...
User table created successfully!
2025/05/31 09:00:35 Ran user migrations group #2
Creating round table...
Round table created successfully!
2025/05/31 09:00:35 Ran round migrations group #3
Creating score table...
Score table created successfully!
2025/05/31 09:00:35 Ran score migrations group #4
2025/05/31 09:00:35 All migrations ran successfully
2025/05/31 09:00:35 newDBServiceWithDB - Registering models
2025/05/31 09:00:35 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:35 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0002703a0 RoundDB:0xc0002703a8 ScoreDB:0xc0002703b0 LeaderboardDB:0xc0002703b8 db:0xc0008d6240}
2025/05/31 09:00:36 Truncating tables: leaderboards
    get_leaderboard_test.go:240: Waiting for 1 messages on topic "discord.get.leaderboard.success" with timeout 5s
2025/05/31 09:00:37 Test received message 6a52618f-8c42-4187-a84e-12591b4a7a80 on topic "discord.get.leaderboard.success"
    get_leaderboard_test.go:240: Successfully received 1 messages on topic "discord.get.leaderboard.success"
2025/05/31 09:00:37 Test Case "TestHandleGetLeaderboardRequested/Success_-_Get_Leaderboard_With_Data": Canceling subscription context.
2025/05/31 09:00:37 Test Case "TestHandleGetLeaderboardRequested/Success_-_Get_Leaderboard_With_Data": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:37 Test Case "TestHandleGetLeaderboardRequested/Success_-_Get_Leaderboard_With_Data": Subscriber goroutines finished.
2025/05/31 09:00:37 Running leaderboard handler test cleanup...
2025/05/31 09:00:38 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:00:38 Router goroutine finished.
2025/05/31 09:00:38 Leaderboard handler test cleanup finished.
2025/05/31 09:00:38 Cleaning up test environment...
2025/05/31 09:00:38 Context cancelled.
2025/05/31 09:00:38 EventBus closed.
2025/05/31 09:00:38 NATS connection closed.
2025/05/31 09:00:38 DB connection closed.
2025/05/31 09:00:38  Stopping container: 8d7e54d511ba
2025/05/31 09:00:38  Container stopped: 8d7e54d511ba
2025/05/31 09:00:38  Terminating container: 8d7e54d511ba
2025/05/31 09:00:38  Container terminated: 8d7e54d511ba
2025/05/31 09:00:38 NATS container terminated.
2025/05/31 09:00:38  Stopping container: 0786c19d46f4
2025/05/31 09:00:39  Container stopped: 0786c19d46f4
2025/05/31 09:00:39  Terminating container: 0786c19d46f4
2025/05/31 09:00:39  Container terminated: 0786c19d46f4
2025/05/31 09:00:39 PostgreSQL container terminated.
2025/05/31 09:00:39 Cleanup complete.
=== RUN   TestHandleGetLeaderboardRequested/Success_-_Get_Empty_Leaderboard
2025/05/31 09:00:39 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:39  Creating container for image postgres:16-alpine
2025/05/31 09:00:39  Container created: 9773709e649d
2025/05/31 09:00:39  Starting container: 9773709e649d
2025/05/31 09:00:39  Container started: 9773709e649d
2025/05/31 09:00:39  Waiting for container id 9773709e649d image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000478fc0 Strategies:[0xc000989b60]}
2025/05/31 09:00:43  Container is ready: 9773709e649d
2025/05/31 09:00:43 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38949/testdb?sslmode=disable
2025/05/31 09:00:43 Starting NATS container with resource limits...
2025/05/31 09:00:43  Creating container for image nats:2.10-alpine
2025/05/31 09:00:43  Container created: 86cfc03d6da4
2025/05/31 09:00:43  Starting container: 86cfc03d6da4
2025/05/31 09:00:44  Container started: 86cfc03d6da4
2025/05/31 09:00:44  Waiting for container id 86cfc03d6da4 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00051aa08 Strategies:[0xc00078fa40 0xc000ab5ce0]}
2025/05/31 09:00:48  Container is ready: 86cfc03d6da4
2025/05/31 09:00:48 NATS container started with resource limits. URL: nats://localhost:38954
Creating round table...
Round table created successfully!
2025/05/31 09:00:48 Ran round migrations group #1
Creating score table...
Score table created successfully!
2025/05/31 09:00:48 Ran score migrations group #2
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:48 Ran leaderboard migrations group #3
Creating user table...
User table created successfully!
2025/05/31 09:00:48 Ran user migrations group #4
2025/05/31 09:00:48 All migrations ran successfully
2025/05/31 09:00:48 newDBServiceWithDB - Registering models
2025/05/31 09:00:48 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:48 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007c630 RoundDB:0xc00007c638 ScoreDB:0xc00007c640 LeaderboardDB:0xc00007c648 db:0xc000a2c300}
2025/05/31 09:00:48 Truncating tables: leaderboards
    get_leaderboard_test.go:240: Waiting for 1 messages on topic "discord.get.leaderboard.success" with timeout 5s
2025/05/31 09:00:49 Test received message 6c4a9269-40d3-4324-936f-40d375427069 on topic "discord.get.leaderboard.success"
    get_leaderboard_test.go:240: Successfully received 1 messages on topic "discord.get.leaderboard.success"
2025/05/31 09:00:49 Test Case "TestHandleGetLeaderboardRequested/Success_-_Get_Empty_Leaderboard": Canceling subscription context.
2025/05/31 09:00:49 Test Case "TestHandleGetLeaderboardRequested/Success_-_Get_Empty_Leaderboard": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:49 Test Case "TestHandleGetLeaderboardRequested/Success_-_Get_Empty_Leaderboard": Subscriber goroutines finished.
2025/05/31 09:00:49 Running leaderboard handler test cleanup...
2025/05/31 09:00:50 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:00:50 Router goroutine finished.
2025/05/31 09:00:50 Leaderboard handler test cleanup finished.
2025/05/31 09:00:50 Cleaning up test environment...
2025/05/31 09:00:50 Context cancelled.
2025/05/31 09:00:50 EventBus closed.
2025/05/31 09:00:50 NATS connection closed.
2025/05/31 09:00:50 DB connection closed.
2025/05/31 09:00:50  Stopping container: 86cfc03d6da4
2025/05/31 09:00:51  Container stopped: 86cfc03d6da4
2025/05/31 09:00:51  Terminating container: 86cfc03d6da4
2025/05/31 09:00:51  Container terminated: 86cfc03d6da4
2025/05/31 09:00:51 NATS container terminated.
2025/05/31 09:00:51  Stopping container: 9773709e649d
2025/05/31 09:00:52  Container stopped: 9773709e649d
2025/05/31 09:00:52  Terminating container: 9773709e649d
2025/05/31 09:00:52  Container terminated: 9773709e649d
2025/05/31 09:00:52 PostgreSQL container terminated.
2025/05/31 09:00:52 Cleanup complete.
=== RUN   TestHandleGetLeaderboardRequested/Failure_-_Invalid_Message_Payload
2025/05/31 09:00:52 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:52  Creating container for image postgres:16-alpine
2025/05/31 09:00:53  Container created: 56296e530ccc
2025/05/31 09:00:53  Starting container: 56296e530ccc
2025/05/31 09:00:53  Container started: 56296e530ccc
2025/05/31 09:00:53  Waiting for container id 56296e530ccc image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0003075b8 Strategies:[0xc000499740]}
2025/05/31 09:00:56  Container is ready: 56296e530ccc
2025/05/31 09:00:56 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38974/testdb?sslmode=disable
2025/05/31 09:00:56 Starting NATS container with resource limits...
2025/05/31 09:00:56  Creating container for image nats:2.10-alpine
2025/05/31 09:00:56  Container created: 714ae8266465
2025/05/31 09:00:56  Starting container: 714ae8266465
2025/05/31 09:00:57  Container started: 714ae8266465
2025/05/31 09:00:57  Waiting for container id 714ae8266465 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0006e5c18 Strategies:[0xc00078f6e0 0xc000335b90]}
2025/05/31 09:00:59  Container is ready: 714ae8266465
2025/05/31 09:00:59 NATS container started with resource limits. URL: nats://localhost:38975
Creating user table...
User table created successfully!
2025/05/31 09:01:00 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:00 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:00 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:00 Ran leaderboard migrations group #4
2025/05/31 09:01:00 All migrations ran successfully
2025/05/31 09:01:00 newDBServiceWithDB - Registering models
2025/05/31 09:01:00 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:00 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0004e45b8 RoundDB:0xc0004e45c0 ScoreDB:0xc0004e45c8 LeaderboardDB:0xc0004e45e0 db:0xc00066bb00}
2025/05/31 09:01:00 Truncating tables: leaderboards
2025/05/31 09:01:01 Test Case "TestHandleGetLeaderboardRequested/Failure_-_Invalid_Message_Payload": Canceling subscription context.
2025/05/31 09:01:01 Test Case "TestHandleGetLeaderboardRequested/Failure_-_Invalid_Message_Payload": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:01 Test Case "TestHandleGetLeaderboardRequested/Failure_-_Invalid_Message_Payload": Subscriber goroutines finished.
2025/05/31 09:01:01 Running leaderboard handler test cleanup...
2025/05/31 09:01:02 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:01:02 Router goroutine finished.
2025/05/31 09:01:02 Leaderboard handler test cleanup finished.
2025/05/31 09:01:02 Cleaning up test environment...
2025/05/31 09:01:02 Context cancelled.
2025/05/31 09:01:02 EventBus closed.
2025/05/31 09:01:02 NATS connection closed.
2025/05/31 09:01:02 DB connection closed.
2025/05/31 09:01:02  Stopping container: 714ae8266465
2025/05/31 09:01:02  Container stopped: 714ae8266465
2025/05/31 09:01:02  Terminating container: 714ae8266465
2025/05/31 09:01:02  Container terminated: 714ae8266465
2025/05/31 09:01:02 NATS container terminated.
2025/05/31 09:01:02  Stopping container: 56296e530ccc
2025/05/31 09:01:03  Container stopped: 56296e530ccc
2025/05/31 09:01:03  Terminating container: 56296e530ccc
2025/05/31 09:01:03  Container terminated: 56296e530ccc
2025/05/31 09:01:03 PostgreSQL container terminated.
2025/05/31 09:01:03 Cleanup complete.
=== RUN   TestHandleGetLeaderboardRequested/Failure_-_No_Active_Leaderboard
2025/05/31 09:01:03 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:03  Creating container for image postgres:16-alpine
2025/05/31 09:01:03  Container created: b209b5e38c35
2025/05/31 09:01:03  Starting container: b209b5e38c35
2025/05/31 09:01:04  Container started: b209b5e38c35
2025/05/31 09:01:04  Waiting for container id b209b5e38c35 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000b32970 Strategies:[0xc000964390]}
2025/05/31 09:01:07  Container is ready: b209b5e38c35
2025/05/31 09:01:07 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38993/testdb?sslmode=disable
2025/05/31 09:01:07 Starting NATS container with resource limits...
2025/05/31 09:01:07  Creating container for image nats:2.10-alpine
2025/05/31 09:01:07  Container created: 72f7d3f28683
2025/05/31 09:01:07  Starting container: 72f7d3f28683
2025/05/31 09:01:07  Container started: 72f7d3f28683
2025/05/31 09:01:07  Waiting for container id 72f7d3f28683 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00034e800 Strategies:[0xc000aaa480 0xc0007265a0]}
2025/05/31 09:01:11  Container is ready: 72f7d3f28683
2025/05/31 09:01:11 NATS container started with resource limits. URL: nats://localhost:38994
Creating user table...
User table created successfully!
2025/05/31 09:01:11 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:11 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:11 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:11 Ran leaderboard migrations group #4
2025/05/31 09:01:11 All migrations ran successfully
2025/05/31 09:01:11 newDBServiceWithDB - Registering models
2025/05/31 09:01:11 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:11 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007cc68 RoundDB:0xc00007cc70 ScoreDB:0xc00007cc78 LeaderboardDB:0xc00007cc80 db:0xc0007cc580}
2025/05/31 09:01:12 Truncating tables: leaderboards
2025/05/31 09:01:12 Test Case "TestHandleGetLeaderboardRequested/Failure_-_No_Active_Leaderboard": Canceling subscription context.
2025/05/31 09:01:12 Test Case "TestHandleGetLeaderboardRequested/Failure_-_No_Active_Leaderboard": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:12 Test Case "TestHandleGetLeaderboardRequested/Failure_-_No_Active_Leaderboard": Subscriber goroutines finished.
2025/05/31 09:01:12 Running leaderboard handler test cleanup...
2025/05/31 09:01:13 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:01:13 Router goroutine finished.
2025/05/31 09:01:13 Leaderboard handler test cleanup finished.
2025/05/31 09:01:13 Cleaning up test environment...
2025/05/31 09:01:13 Context cancelled.
2025/05/31 09:01:13 EventBus closed.
2025/05/31 09:01:13 NATS connection closed.
2025/05/31 09:01:13 DB connection closed.
2025/05/31 09:01:13  Stopping container: 72f7d3f28683
2025/05/31 09:01:14  Container stopped: 72f7d3f28683
2025/05/31 09:01:14  Terminating container: 72f7d3f28683
2025/05/31 09:01:14  Container terminated: 72f7d3f28683
2025/05/31 09:01:14 NATS container terminated.
2025/05/31 09:01:14  Stopping container: b209b5e38c35
2025/05/31 09:01:14  Container stopped: b209b5e38c35
2025/05/31 09:01:14  Terminating container: b209b5e38c35
2025/05/31 09:01:15  Container terminated: b209b5e38c35
2025/05/31 09:01:15 PostgreSQL container terminated.
2025/05/31 09:01:15 Cleanup complete.
--- PASS: TestHandleGetLeaderboardRequested (47.51s)
    --- PASS: TestHandleGetLeaderboardRequested/Success_-_Get_Leaderboard_With_Data (11.80s)
    --- PASS: TestHandleGetLeaderboardRequested/Success_-_Get_Empty_Leaderboard (13.56s)
    --- PASS: TestHandleGetLeaderboardRequested/Failure_-_Invalid_Message_Payload (10.76s)
    --- PASS: TestHandleGetLeaderboardRequested/Failure_-_No_Active_Leaderboard (11.39s)
=== RUN   TestHandleLeaderboardUpdateRequested
=== RUN   TestHandleLeaderboardUpdateRequested/Success_-_Sorted_participant_tags_apply_to_new_leaderboard
2025/05/31 09:01:15 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:15  Creating container for image postgres:16-alpine
2025/05/31 09:01:15  Container created: 331f2c5ea64a
2025/05/31 09:01:15  Starting container: 331f2c5ea64a
2025/05/31 09:01:15  Container started: 331f2c5ea64a
2025/05/31 09:01:15  Waiting for container id 331f2c5ea64a image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0004e1308 Strategies:[0xc000c36660]}
2025/05/31 09:01:19  Container is ready: 331f2c5ea64a
2025/05/31 09:01:19 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39005/testdb?sslmode=disable
2025/05/31 09:01:19 Starting NATS container with resource limits...
2025/05/31 09:01:19  Creating container for image nats:2.10-alpine
2025/05/31 09:01:19  Container created: bc943710df3a
2025/05/31 09:01:19  Starting container: bc943710df3a
2025/05/31 09:01:19  Container started: bc943710df3a
2025/05/31 09:01:19  Waiting for container id bc943710df3a image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0003864f0 Strategies:[0xc000ce09c0 0xc0004e2c60]}
2025/05/31 09:01:20  Container is ready: bc943710df3a
2025/05/31 09:01:20 NATS container started with resource limits. URL: nats://localhost:39008
Creating user table...
User table created successfully!
2025/05/31 09:01:20 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:20 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:20 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:20 Ran leaderboard migrations group #4
2025/05/31 09:01:20 All migrations ran successfully
2025/05/31 09:01:20 newDBServiceWithDB - Registering models
2025/05/31 09:01:20 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:20 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007c6c8 RoundDB:0xc00007c6d0 ScoreDB:0xc00007c6d8 LeaderboardDB:0xc00007c6e8 db:0xc000a2c500}
2025/05/31 09:01:20 Truncating tables: leaderboards
    leaderboard_update_test.go:72: SetupFn: Initial Leaderboard ID: 2, UpdateID: 27ecfe9b-332f-4b04-861d-17c5cb3145aa, IsActive: true
    leaderboard_update_test.go:74: SetupFn: Created users with IDs: [600418005, 247964263, 374338918]
    leaderboard_update_test.go:92: PublishMsgFn: Publishing message with RoundID: 6368336b-c31d-4cf7-b182-0a0c6e8d7091, SortedParticipantTags: [3:374338918 1:600418005 2:247964263]
    leaderboard_update_test.go:94: PublishMsgFn: Using actual user IDs: [600418005, 247964263, 374338918]
    leaderboard_update_test.go:328: Waiting for 1 messages on topic "discord.leaderboard.updated" with timeout 5s
2025/05/31 09:01:21 Test received message 9ab8fdf1-df56-45bd-bafe-9af16cc9bf27 on topic "discord.leaderboard.updated"
    leaderboard_update_test.go:328: Successfully received 1 messages on topic "discord.leaderboard.updated"
    leaderboard_update_test.go:118: ValidateFn: Retrieved 2 leaderboards from DB
    leaderboard_update_test.go:121: ValidateFn: DB Leaderboard 0: ID: 2, UpdateID: 27ecfe9b-332f-4b04-861d-17c5cb3145aa, IsActive: false, Data: [{TagNumber:10 UserID:600418005} {TagNumber:11 UserID:247964263} {TagNumber:12 UserID:374338918}]
    leaderboard_update_test.go:121: ValidateFn: DB Leaderboard 1: ID: 3, UpdateID: 6368336b-c31d-4cf7-b182-0a0c6e8d7091, IsActive: true, Data: [{TagNumber:1 UserID:600418005} {TagNumber:2 UserID:247964263} {TagNumber:3 UserID:374338918}]
    leaderboard_update_test.go:157: ValidateFn: Identified Old Leaderboard ID: 2, UpdateID: 27ecfe9b-332f-4b04-861d-17c5cb3145aa, IsActive: false
    leaderboard_update_test.go:159: ValidateFn: Identified New Leaderboard ID: 3, UpdateID: 6368336b-c31d-4cf7-b182-0a0c6e8d7091, IsActive: true
    leaderboard_update_test.go:162: ValidateFn: Raw New Leaderboard Data (newLB.LeaderboardData): [{TagNumber:1 UserID:600418005} {TagNumber:2 UserID:247964263} {TagNumber:3 UserID:374338918}]
    leaderboard_update_test.go:192: ValidateFn: Expected Data Map: map[247964263:2 374338918:3 600418005:1]
    leaderboard_update_test.go:195: ValidateFn: Actual Data Map (from newLB): map[247964263:2 374338918:3 600418005:1]
2025/05/31 09:01:21 Test Case "TestHandleLeaderboardUpdateRequested/Success_-_Sorted_participant_tags_apply_to_new_leaderboard": Canceling subscription context.
2025/05/31 09:01:21 Test Case "TestHandleLeaderboardUpdateRequested/Success_-_Sorted_participant_tags_apply_to_new_leaderboard": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:21 Test Case "TestHandleLeaderboardUpdateRequested/Success_-_Sorted_participant_tags_apply_to_new_leaderboard": Subscriber goroutines finished.
2025/05/31 09:01:21 Running leaderboard handler test cleanup...
2025/05/31 09:01:22 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:01:22 Router goroutine finished.
2025/05/31 09:01:22 Leaderboard handler test cleanup finished.
2025/05/31 09:01:22 Cleaning up test environment...
2025/05/31 09:01:22 Context cancelled.
2025/05/31 09:01:22 EventBus closed.
2025/05/31 09:01:22 NATS connection closed.
2025/05/31 09:01:22 DB connection closed.
2025/05/31 09:01:22  Stopping container: bc943710df3a
2025/05/31 09:01:22  Container stopped: bc943710df3a
2025/05/31 09:01:22  Terminating container: bc943710df3a
2025/05/31 09:01:23  Container terminated: bc943710df3a
2025/05/31 09:01:23 NATS container terminated.
2025/05/31 09:01:23  Stopping container: 331f2c5ea64a
2025/05/31 09:01:23  Container stopped: 331f2c5ea64a
2025/05/31 09:01:23  Terminating container: 331f2c5ea64a
2025/05/31 09:01:23  Container terminated: 331f2c5ea64a
2025/05/31 09:01:23 PostgreSQL container terminated.
2025/05/31 09:01:23 Cleanup complete.
=== RUN   TestHandleLeaderboardUpdateRequested/Failure_-_Invalid_JSON_Payload
2025/05/31 09:01:23 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:23  Creating container for image postgres:16-alpine
2025/05/31 09:01:23  Container created: 3ad670bf8442
2025/05/31 09:01:23  Starting container: 3ad670bf8442
2025/05/31 09:01:24  Container started: 3ad670bf8442
2025/05/31 09:01:24  Waiting for container id 3ad670bf8442 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007e65f0 Strategies:[0xc0007eb830]}
2025/05/31 09:01:27  Container is ready: 3ad670bf8442
2025/05/31 09:01:27 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39017/testdb?sslmode=disable
2025/05/31 09:01:27 Starting NATS container with resource limits...
2025/05/31 09:01:27  Creating container for image nats:2.10-alpine
2025/05/31 09:01:28  Container created: ef7f02b442ff
2025/05/31 09:01:28  Starting container: ef7f02b442ff
2025/05/31 09:01:28  Container started: ef7f02b442ff
2025/05/31 09:01:28  Waiting for container id ef7f02b442ff image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000012f38 Strategies:[0xc0008c1c80 0xc0007279b0]}
2025/05/31 09:01:29  Container is ready: ef7f02b442ff
2025/05/31 09:01:29 NATS container started with resource limits. URL: nats://localhost:39020
Creating user table...
User table created successfully!
2025/05/31 09:01:29 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:29 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:29 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:29 Ran leaderboard migrations group #4
2025/05/31 09:01:29 All migrations ran successfully
2025/05/31 09:01:29 newDBServiceWithDB - Registering models
2025/05/31 09:01:29 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:29 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0004e4258 RoundDB:0xc0004e4268 ScoreDB:0xc0004e4270 LeaderboardDB:0xc0004e4278 db:0xc0009a4300}
2025/05/31 09:01:29 Truncating tables: leaderboards
2025/05/31 09:01:30 Test Case "TestHandleLeaderboardUpdateRequested/Failure_-_Invalid_JSON_Payload": Canceling subscription context.
2025/05/31 09:01:30 Test Case "TestHandleLeaderboardUpdateRequested/Failure_-_Invalid_JSON_Payload": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:30 Test Case "TestHandleLeaderboardUpdateRequested/Failure_-_Invalid_JSON_Payload": Subscriber goroutines finished.
2025/05/31 09:01:30 Running leaderboard handler test cleanup...
2025/05/31 09:01:31 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:01:31 Router goroutine finished.
2025/05/31 09:01:31 Leaderboard handler test cleanup finished.
2025/05/31 09:01:31 Cleaning up test environment...
2025/05/31 09:01:31 Context cancelled.
2025/05/31 09:01:31 EventBus closed.
2025/05/31 09:01:31 NATS connection closed.
2025/05/31 09:01:31 DB connection closed.
2025/05/31 09:01:31  Stopping container: ef7f02b442ff
2025/05/31 09:01:32  Container stopped: ef7f02b442ff
2025/05/31 09:01:32  Terminating container: ef7f02b442ff
2025/05/31 09:01:32  Container terminated: ef7f02b442ff
2025/05/31 09:01:32 NATS container terminated.
2025/05/31 09:01:32  Stopping container: 3ad670bf8442
2025/05/31 09:01:32  Container stopped: 3ad670bf8442
2025/05/31 09:01:32  Terminating container: 3ad670bf8442
2025/05/31 09:01:32  Container terminated: 3ad670bf8442
2025/05/31 09:01:32 PostgreSQL container terminated.
2025/05/31 09:01:32 Cleanup complete.
=== RUN   TestHandleLeaderboardUpdateRequested/Failure_-_Empty_SortedParticipantTags
2025/05/31 09:01:32 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:32  Creating container for image postgres:16-alpine
2025/05/31 09:01:32  Container created: 50fea7356eb6
2025/05/31 09:01:33  Starting container: 50fea7356eb6
2025/05/31 09:01:33  Container started: 50fea7356eb6
2025/05/31 09:01:33  Waiting for container id 50fea7356eb6 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007bce18 Strategies:[0xc0006635c0]}
2025/05/31 09:01:36  Container is ready: 50fea7356eb6
2025/05/31 09:01:36 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39029/testdb?sslmode=disable
2025/05/31 09:01:36 Starting NATS container with resource limits...
2025/05/31 09:01:36  Creating container for image nats:2.10-alpine
2025/05/31 09:01:37  Container created: 49497c25d317
2025/05/31 09:01:37  Starting container: 49497c25d317
2025/05/31 09:01:37  Container started: 49497c25d317
2025/05/31 09:01:37  Waiting for container id 49497c25d317 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007e7c20 Strategies:[0xc000aabda0 0xc000b39590]}
2025/05/31 09:01:38  Container is ready: 49497c25d317
2025/05/31 09:01:38 NATS container started with resource limits. URL: nats://localhost:39032
Creating user table...
User table created successfully!
2025/05/31 09:01:38 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:38 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:38 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:38 Ran leaderboard migrations group #4
2025/05/31 09:01:38 All migrations ran successfully
2025/05/31 09:01:38 newDBServiceWithDB - Registering models
2025/05/31 09:01:38 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:38 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007ccb0 RoundDB:0xc00007ccb8 ScoreDB:0xc00007ccc0 LeaderboardDB:0xc00007ccc8 db:0xc000556180}
2025/05/31 09:01:38 Truncating tables: leaderboards
2025/05/31 09:01:39 Test Case "TestHandleLeaderboardUpdateRequested/Failure_-_Empty_SortedParticipantTags": Canceling subscription context.
2025/05/31 09:01:39 Test Case "TestHandleLeaderboardUpdateRequested/Failure_-_Empty_SortedParticipantTags": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:39 Test Case "TestHandleLeaderboardUpdateRequested/Failure_-_Empty_SortedParticipantTags": Subscriber goroutines finished.
2025/05/31 09:01:39 Running leaderboard handler test cleanup...
2025/05/31 09:01:40 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:01:40 Router goroutine finished.
2025/05/31 09:01:40 Leaderboard handler test cleanup finished.
2025/05/31 09:01:40 Cleaning up test environment...
2025/05/31 09:01:40 Context cancelled.
2025/05/31 09:01:40 EventBus closed.
2025/05/31 09:01:40 NATS connection closed.
2025/05/31 09:01:40 DB connection closed.
2025/05/31 09:01:40  Stopping container: 49497c25d317
2025/05/31 09:01:40  Container stopped: 49497c25d317
2025/05/31 09:01:40  Terminating container: 49497c25d317
2025/05/31 09:01:40  Container terminated: 49497c25d317
2025/05/31 09:01:40 NATS container terminated.
2025/05/31 09:01:40  Stopping container: 50fea7356eb6
2025/05/31 09:01:41  Container stopped: 50fea7356eb6
2025/05/31 09:01:41  Terminating container: 50fea7356eb6
2025/05/31 09:01:41  Container terminated: 50fea7356eb6
2025/05/31 09:01:41 PostgreSQL container terminated.
2025/05/31 09:01:41 Cleanup complete.
=== RUN   TestHandleLeaderboardUpdateRequested/Failure_-_Incorrect_Tag_Format
2025/05/31 09:01:41 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:41  Creating container for image postgres:16-alpine
2025/05/31 09:01:41  Container created: 4029de1163dd
2025/05/31 09:01:41  Starting container: 4029de1163dd
2025/05/31 09:01:42  Container started: 4029de1163dd
2025/05/31 09:01:42  Waiting for container id 4029de1163dd image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007bd588 Strategies:[0xc0004e2cf0]}
2025/05/31 09:01:45  Container is ready: 4029de1163dd
2025/05/31 09:01:45 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39041/testdb?sslmode=disable
2025/05/31 09:01:45 Starting NATS container with resource limits...
2025/05/31 09:01:45  Creating container for image nats:2.10-alpine
2025/05/31 09:01:45  Container created: 317e29be6519
2025/05/31 09:01:45  Starting container: 317e29be6519
2025/05/31 09:01:46  Container started: 317e29be6519
2025/05/31 09:01:46  Waiting for container id 317e29be6519 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007bd0d8 Strategies:[0xc0007990e0 0xc000989aa0]}
2025/05/31 09:01:47  Container is ready: 317e29be6519
2025/05/31 09:01:47 NATS container started with resource limits. URL: nats://localhost:39044
Creating score table...
Score table created successfully!
2025/05/31 09:01:47 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:47 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:01:47 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:01:47 Ran round migrations group #4
2025/05/31 09:01:47 All migrations ran successfully
2025/05/31 09:01:47 newDBServiceWithDB - Registering models
2025/05/31 09:01:47 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:47 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0004447a8 RoundDB:0xc0004447b0 ScoreDB:0xc0004447b8 LeaderboardDB:0xc0004447c0 db:0xc0007cdcc0}
2025/05/31 09:01:47 Truncating tables: leaderboards
2025/05/31 09:01:48 Test Case "TestHandleLeaderboardUpdateRequested/Failure_-_Incorrect_Tag_Format": Canceling subscription context.
2025/05/31 09:01:48 Test Case "TestHandleLeaderboardUpdateRequested/Failure_-_Incorrect_Tag_Format": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:48 Test Case "TestHandleLeaderboardUpdateRequested/Failure_-_Incorrect_Tag_Format": Subscriber goroutines finished.
2025/05/31 09:01:48 Running leaderboard handler test cleanup...
2025/05/31 09:01:49 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:01:49 Router goroutine finished.
2025/05/31 09:01:49 Leaderboard handler test cleanup finished.
2025/05/31 09:01:49 Cleaning up test environment...
2025/05/31 09:01:49 Context cancelled.
2025/05/31 09:01:49 EventBus closed.
2025/05/31 09:01:49 NATS connection closed.
2025/05/31 09:01:49 DB connection closed.
2025/05/31 09:01:49  Stopping container: 317e29be6519
2025/05/31 09:01:50  Container stopped: 317e29be6519
2025/05/31 09:01:50  Terminating container: 317e29be6519
2025/05/31 09:01:50  Container terminated: 317e29be6519
2025/05/31 09:01:50 NATS container terminated.
2025/05/31 09:01:50  Stopping container: 4029de1163dd
2025/05/31 09:01:50  Container stopped: 4029de1163dd
2025/05/31 09:01:50  Terminating container: 4029de1163dd
2025/05/31 09:01:50  Container terminated: 4029de1163dd
2025/05/31 09:01:50 PostgreSQL container terminated.
2025/05/31 09:01:50 Cleanup complete.
--- PASS: TestHandleLeaderboardUpdateRequested (35.84s)
    --- PASS: TestHandleLeaderboardUpdateRequested/Success_-_Sorted_participant_tags_apply_to_new_leaderboard (8.44s)
    --- PASS: TestHandleLeaderboardUpdateRequested/Failure_-_Invalid_JSON_Payload (9.44s)
    --- PASS: TestHandleLeaderboardUpdateRequested/Failure_-_Empty_SortedParticipantTags (8.52s)
    --- PASS: TestHandleLeaderboardUpdateRequested/Failure_-_Incorrect_Tag_Format (9.44s)
=== RUN   TestHandleRoundGetTagRequest
=== RUN   TestHandleRoundGetTagRequest/Success_-_Tag_found_for_user_on_active_leaderboard
2025/05/31 09:01:50 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:50  Creating container for image postgres:16-alpine
2025/05/31 09:01:50  Container created: 7b2e361e27d2
2025/05/31 09:01:50  Starting container: 7b2e361e27d2
2025/05/31 09:01:51  Container started: 7b2e361e27d2
2025/05/31 09:01:51  Waiting for container id 7b2e361e27d2 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000657f00 Strategies:[0xc000c713e0]}
2025/05/31 09:01:54  Container is ready: 7b2e361e27d2
2025/05/31 09:01:54 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39054/testdb?sslmode=disable
2025/05/31 09:01:54 Starting NATS container with resource limits...
2025/05/31 09:01:54  Creating container for image nats:2.10-alpine
2025/05/31 09:01:54  Container created: 8fab96bce08b
2025/05/31 09:01:54  Starting container: 8fab96bce08b
2025/05/31 09:01:54  Container started: 8fab96bce08b
2025/05/31 09:01:54  Waiting for container id 8fab96bce08b image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00034ed38 Strategies:[0xc000798de0 0xc00091c690]}
2025/05/31 09:01:56  Container is ready: 8fab96bce08b
2025/05/31 09:01:56 NATS container started with resource limits. URL: nats://localhost:39057
Creating user table...
User table created successfully!
2025/05/31 09:01:56 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:56 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:56 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:56 Ran leaderboard migrations group #4
2025/05/31 09:01:56 All migrations ran successfully
2025/05/31 09:01:56 newDBServiceWithDB - Registering models
2025/05/31 09:01:56 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:56 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000f9a528 RoundDB:0xc000f9a530 ScoreDB:0xc000f9a538 LeaderboardDB:0xc000f9a540 db:0xc00049a3c0}
2025/05/31 09:01:56 Truncating tables: leaderboards
    round_tag_by_userid_test.go:221: Waiting for 1 messages on topic "round.tag.lookup.found" with timeout 5s
2025/05/31 09:01:57 Test received message 04cd479e-5eae-41d4-a809-05030621cb2a on topic "round.tag.lookup.found"
    round_tag_by_userid_test.go:221: Successfully received 1 messages on topic "round.tag.lookup.found"
2025/05/31 09:01:57 Test Case "TestHandleRoundGetTagRequest/Success_-_Tag_found_for_user_on_active_leaderboard": Canceling subscription context.
2025/05/31 09:01:57 Test Case "TestHandleRoundGetTagRequest/Success_-_Tag_found_for_user_on_active_leaderboard": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:57 Test Case "TestHandleRoundGetTagRequest/Success_-_Tag_found_for_user_on_active_leaderboard": Subscriber goroutines finished.
2025/05/31 09:01:57 Running leaderboard handler test cleanup...
2025/05/31 09:01:58 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:01:58 Router goroutine finished.
2025/05/31 09:01:58 Leaderboard handler test cleanup finished.
2025/05/31 09:01:58 Cleaning up test environment...
2025/05/31 09:01:58 Context cancelled.
2025/05/31 09:01:58 EventBus closed.
2025/05/31 09:01:58 NATS connection closed.
2025/05/31 09:01:58 DB connection closed.
2025/05/31 09:01:58  Stopping container: 8fab96bce08b
2025/05/31 09:01:58  Container stopped: 8fab96bce08b
2025/05/31 09:01:58  Terminating container: 8fab96bce08b
2025/05/31 09:01:58  Container terminated: 8fab96bce08b
2025/05/31 09:01:58 NATS container terminated.
2025/05/31 09:01:58  Stopping container: 7b2e361e27d2
2025/05/31 09:01:59  Container stopped: 7b2e361e27d2
2025/05/31 09:01:59  Terminating container: 7b2e361e27d2
2025/05/31 09:01:59  Container terminated: 7b2e361e27d2
2025/05/31 09:01:59 PostgreSQL container terminated.
2025/05/31 09:01:59 Cleanup complete.
=== RUN   TestHandleRoundGetTagRequest/Success_-_Tag_not_found_(user_not_on_leaderboard)
2025/05/31 09:01:59 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:59  Creating container for image postgres:16-alpine
2025/05/31 09:01:59  Container created: ef6526677039
2025/05/31 09:01:59  Starting container: ef6526677039
2025/05/31 09:02:00  Container started: ef6526677039
2025/05/31 09:02:00  Waiting for container id ef6526677039 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000c139d0 Strategies:[0xc000d55a70]}
2025/05/31 09:02:02  Container is ready: ef6526677039
2025/05/31 09:02:02 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39064/testdb?sslmode=disable
2025/05/31 09:02:02 Starting NATS container with resource limits...
2025/05/31 09:02:02  Creating container for image nats:2.10-alpine
2025/05/31 09:02:02  Container created: e9e32ae56da0
2025/05/31 09:02:02  Starting container: e9e32ae56da0
2025/05/31 09:02:03  Container started: e9e32ae56da0
2025/05/31 09:02:03  Waiting for container id e9e32ae56da0 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007bdb78 Strategies:[0xc000d93ce0 0xc00087e5d0]}
2025/05/31 09:02:05  Container is ready: e9e32ae56da0
2025/05/31 09:02:05 NATS container started with resource limits. URL: nats://localhost:39065
Creating user table...
User table created successfully!
2025/05/31 09:02:05 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:02:05 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:02:05 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:02:05 Ran leaderboard migrations group #4
2025/05/31 09:02:05 All migrations ran successfully
2025/05/31 09:02:05 newDBServiceWithDB - Registering models
2025/05/31 09:02:05 newDBServiceWithDB - Models registered successfully
2025/05/31 09:02:05 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000444648 RoundDB:0xc000444650 ScoreDB:0xc000444658 LeaderboardDB:0xc000444660 db:0xc0008d6840}
2025/05/31 09:02:05 Truncating tables: leaderboards
    round_tag_by_userid_test.go:221: Waiting for 1 messages on topic "round.tag.lookup.not.found" with timeout 5s
2025/05/31 09:02:06 WARN No tag found for user in active leaderboard data user_id=296948663
2025/05/31 09:02:06 Test received message 2f84e1d8-4155-4b0e-aee6-3945c7fb2e9f on topic "round.tag.lookup.not.found"
    round_tag_by_userid_test.go:221: Successfully received 1 messages on topic "round.tag.lookup.not.found"
2025/05/31 09:02:06 Test Case "TestHandleRoundGetTagRequest/Success_-_Tag_not_found_(user_not_on_leaderboard)": Canceling subscription context.
2025/05/31 09:02:06 Test Case "TestHandleRoundGetTagRequest/Success_-_Tag_not_found_(user_not_on_leaderboard)": Waiting for subscriber goroutines to finish.
2025/05/31 09:02:06 Test Case "TestHandleRoundGetTagRequest/Success_-_Tag_not_found_(user_not_on_leaderboard)": Subscriber goroutines finished.
2025/05/31 09:02:06 Running leaderboard handler test cleanup...
2025/05/31 09:02:07 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:02:07 Router goroutine finished.
2025/05/31 09:02:07 Leaderboard handler test cleanup finished.
2025/05/31 09:02:07 Cleaning up test environment...
2025/05/31 09:02:07 Context cancelled.
2025/05/31 09:02:07 EventBus closed.
2025/05/31 09:02:07 NATS connection closed.
2025/05/31 09:02:07 DB connection closed.
2025/05/31 09:02:07  Stopping container: e9e32ae56da0
2025/05/31 09:02:08  Container stopped: e9e32ae56da0
2025/05/31 09:02:08  Terminating container: e9e32ae56da0
2025/05/31 09:02:08  Container terminated: e9e32ae56da0
2025/05/31 09:02:08 NATS container terminated.
2025/05/31 09:02:08  Stopping container: ef6526677039
2025/05/31 09:02:08  Container stopped: ef6526677039
2025/05/31 09:02:08  Terminating container: ef6526677039
2025/05/31 09:02:08  Container terminated: ef6526677039
2025/05/31 09:02:08 PostgreSQL container terminated.
2025/05/31 09:02:08 Cleanup complete.
=== RUN   TestHandleRoundGetTagRequest/Failure_-_No_active_leaderboard_present
2025/05/31 09:02:08 Starting PostgreSQL container with resource limits...
2025/05/31 09:02:08  Creating container for image postgres:16-alpine
2025/05/31 09:02:08  Container created: 3781651d1d84
2025/05/31 09:02:08  Starting container: 3781651d1d84
2025/05/31 09:02:08  Container started: 3781651d1d84
2025/05/31 09:02:08  Waiting for container id 3781651d1d84 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000f444f8 Strategies:[0xc000f70450]}
2025/05/31 09:02:11  Container is ready: 3781651d1d84
2025/05/31 09:02:11 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39069/testdb?sslmode=disable
2025/05/31 09:02:11 Starting NATS container with resource limits...
2025/05/31 09:02:11  Creating container for image nats:2.10-alpine
2025/05/31 09:02:11  Container created: 30c30f322069
2025/05/31 09:02:11  Starting container: 30c30f322069
2025/05/31 09:02:11  Container started: 30c30f322069
2025/05/31 09:02:11  Waiting for container id 30c30f322069 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0004e0068 Strategies:[0xc000d17200 0xc000e4d830]}
2025/05/31 09:02:14  Container is ready: 30c30f322069
2025/05/31 09:02:14 NATS container started with resource limits. URL: nats://localhost:39070
Creating score table...
Score table created successfully!
2025/05/31 09:02:14 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:02:14 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:02:14 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:02:14 Ran round migrations group #4
2025/05/31 09:02:14 All migrations ran successfully
2025/05/31 09:02:14 newDBServiceWithDB - Registering models
2025/05/31 09:02:14 newDBServiceWithDB - Models registered successfully
2025/05/31 09:02:14 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007d068 RoundDB:0xc00007d070 ScoreDB:0xc00007d078 LeaderboardDB:0xc00007d080 db:0xc00005f700}
2025/05/31 09:02:14 Truncating tables: leaderboards
    round_tag_by_userid_test.go:221: Waiting for 1 messages on topic "discord.leaderboard.tag.get.by.user.id.failed" with timeout 5s
2025/05/31 09:02:15 WARN No active leaderboard found for tag lookup
2025/05/31 09:02:15 Test received message 3661d341-9847-4f0f-9222-02f2cbcb17ed on topic "discord.leaderboard.tag.get.by.user.id.failed"
    round_tag_by_userid_test.go:221: Successfully received 1 messages on topic "discord.leaderboard.tag.get.by.user.id.failed"
2025/05/31 09:02:15 Test Case "TestHandleRoundGetTagRequest/Failure_-_No_active_leaderboard_present": Canceling subscription context.
2025/05/31 09:02:15 Test Case "TestHandleRoundGetTagRequest/Failure_-_No_active_leaderboard_present": Waiting for subscriber goroutines to finish.
2025/05/31 09:02:15 Test Case "TestHandleRoundGetTagRequest/Failure_-_No_active_leaderboard_present": Subscriber goroutines finished.
2025/05/31 09:02:15 Running leaderboard handler test cleanup...
2025/05/31 09:02:16 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:02:16 Router goroutine finished.
2025/05/31 09:02:16 Leaderboard handler test cleanup finished.
2025/05/31 09:02:16 Cleaning up test environment...
2025/05/31 09:02:16 Context cancelled.
2025/05/31 09:02:16 EventBus closed.
2025/05/31 09:02:16 NATS connection closed.
2025/05/31 09:02:16 DB connection closed.
2025/05/31 09:02:16  Stopping container: 30c30f322069
2025/05/31 09:02:16  Container stopped: 30c30f322069
2025/05/31 09:02:16  Terminating container: 30c30f322069
2025/05/31 09:02:16  Container terminated: 30c30f322069
2025/05/31 09:02:16 NATS container terminated.
2025/05/31 09:02:16  Stopping container: 3781651d1d84
2025/05/31 09:02:16  Container stopped: 3781651d1d84
2025/05/31 09:02:16  Terminating container: 3781651d1d84
2025/05/31 09:02:17  Container terminated: 3781651d1d84
2025/05/31 09:02:17 PostgreSQL container terminated.
2025/05/31 09:02:17 Cleanup complete.
=== RUN   TestHandleRoundGetTagRequest/Failure_-_Invalid_payload_(unmarshal_error)
2025/05/31 09:02:17 Starting PostgreSQL container with resource limits...
2025/05/31 09:02:17  Creating container for image postgres:16-alpine
2025/05/31 09:02:17  Container created: 0e0e891f6de9
2025/05/31 09:02:17  Starting container: 0e0e891f6de9
2025/05/31 09:02:17  Container started: 0e0e891f6de9
2025/05/31 09:02:17  Waiting for container id 0e0e891f6de9 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000f168f8 Strategies:[0xc0010862d0]}
2025/05/31 09:02:20  Container is ready: 0e0e891f6de9
2025/05/31 09:02:20 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39073/testdb?sslmode=disable
2025/05/31 09:02:20 Starting NATS container with resource limits...
2025/05/31 09:02:20  Creating container for image nats:2.10-alpine
2025/05/31 09:02:20  Container created: 825fb070ad57
2025/05/31 09:02:20  Starting container: 825fb070ad57
2025/05/31 09:02:20  Container started: 825fb070ad57
2025/05/31 09:02:20  Waiting for container id 825fb070ad57 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007ecc68 Strategies:[0xc0012a8780 0xc000e4c8a0]}
2025/05/31 09:02:22  Container is ready: 825fb070ad57
2025/05/31 09:02:22 NATS container started with resource limits. URL: nats://localhost:39074
Creating user table...
User table created successfully!
2025/05/31 09:02:23 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:02:23 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:02:23 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:02:23 Ran leaderboard migrations group #4
2025/05/31 09:02:23 All migrations ran successfully
2025/05/31 09:02:23 newDBServiceWithDB - Registering models
2025/05/31 09:02:23 newDBServiceWithDB - Models registered successfully
2025/05/31 09:02:23 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000f9a4b0 RoundDB:0xc000f9a4b8 ScoreDB:0xc000f9a4c0 LeaderboardDB:0xc000f9a4c8 db:0xc000b6b800}
2025/05/31 09:02:23 Truncating tables: leaderboards
2025/05/31 09:02:23 Test Case "TestHandleRoundGetTagRequest/Failure_-_Invalid_payload_(unmarshal_error)": Canceling subscription context.
2025/05/31 09:02:23 Test Case "TestHandleRoundGetTagRequest/Failure_-_Invalid_payload_(unmarshal_error)": Waiting for subscriber goroutines to finish.
2025/05/31 09:02:23 Test Case "TestHandleRoundGetTagRequest/Failure_-_Invalid_payload_(unmarshal_error)": Subscriber goroutines finished.
2025/05/31 09:02:23 Running leaderboard handler test cleanup...
2025/05/31 09:02:24 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:02:24 Router goroutine finished.
2025/05/31 09:02:24 Leaderboard handler test cleanup finished.
2025/05/31 09:02:24 Cleaning up test environment...
2025/05/31 09:02:24 Context cancelled.
2025/05/31 09:02:24 EventBus closed.
2025/05/31 09:02:24 NATS connection closed.
2025/05/31 09:02:24 DB connection closed.
2025/05/31 09:02:24  Stopping container: 825fb070ad57
2025/05/31 09:02:25  Container stopped: 825fb070ad57
2025/05/31 09:02:25  Terminating container: 825fb070ad57
2025/05/31 09:02:25  Container terminated: 825fb070ad57
2025/05/31 09:02:25 NATS container terminated.
2025/05/31 09:02:25  Stopping container: 0e0e891f6de9
2025/05/31 09:02:25  Container stopped: 0e0e891f6de9
2025/05/31 09:02:25  Terminating container: 0e0e891f6de9
2025/05/31 09:02:25  Container terminated: 0e0e891f6de9
2025/05/31 09:02:25 PostgreSQL container terminated.
2025/05/31 09:02:25 Cleanup complete.
--- PASS: TestHandleRoundGetTagRequest (34.85s)
    --- PASS: TestHandleRoundGetTagRequest/Success_-_Tag_found_for_user_on_active_leaderboard (8.71s)
    --- PASS: TestHandleRoundGetTagRequest/Success_-_Tag_not_found_(user_not_on_leaderboard) (8.88s)
    --- PASS: TestHandleRoundGetTagRequest/Failure_-_No_active_leaderboard_present (8.60s)
    --- PASS: TestHandleRoundGetTagRequest/Failure_-_Invalid_payload_(unmarshal_error) (8.66s)
=== RUN   TestHandleTagAssignmentRequested
=== RUN   TestHandleTagAssignmentRequested/Success_-_Assign_New_Tag
2025/05/31 09:02:25 Starting PostgreSQL container with resource limits...
2025/05/31 09:02:25  Creating container for image postgres:16-alpine
2025/05/31 09:02:25  Container created: 5dcf511b75f5
2025/05/31 09:02:25  Starting container: 5dcf511b75f5
2025/05/31 09:02:26  Container started: 5dcf511b75f5
2025/05/31 09:02:26  Waiting for container id 5dcf511b75f5 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007bd920 Strategies:[0xc001212a20]}
2025/05/31 09:02:29  Container is ready: 5dcf511b75f5
2025/05/31 09:02:29 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39077/testdb?sslmode=disable
2025/05/31 09:02:29 Starting NATS container with resource limits...
2025/05/31 09:02:29  Creating container for image nats:2.10-alpine
2025/05/31 09:02:29  Container created: 12c5df1fa65a
2025/05/31 09:02:29  Starting container: 12c5df1fa65a
2025/05/31 09:02:29  Container started: 12c5df1fa65a
2025/05/31 09:02:29  Waiting for container id 12c5df1fa65a image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000657898 Strategies:[0xc0008c1620 0xc000b39710]}
2025/05/31 09:02:32  Container is ready: 12c5df1fa65a
2025/05/31 09:02:32 NATS container started with resource limits. URL: nats://localhost:39078
Creating user table...
User table created successfully!
2025/05/31 09:02:32 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:02:32 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:02:32 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:02:32 Ran leaderboard migrations group #4
2025/05/31 09:02:32 All migrations ran successfully
2025/05/31 09:02:32 newDBServiceWithDB - Registering models
2025/05/31 09:02:32 newDBServiceWithDB - Models registered successfully
2025/05/31 09:02:32 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000444518 RoundDB:0xc000444528 ScoreDB:0xc000444530 LeaderboardDB:0xc000444538 db:0xc0007cfb40}
2025/05/31 09:02:32 Truncating tables: leaderboards
    tag_assignment_test.go:269: Waiting for 1 messages on topic "discord.leaderboard.tag.assignment.success" with timeout 5s
2025/05/31 09:02:33 Test received message c3700b50-5418-4fec-80c3-884c86b0dbc7 on topic "discord.leaderboard.tag.assignment.success"
    tag_assignment_test.go:269: Successfully received 1 messages on topic "discord.leaderboard.tag.assignment.success"
2025/05/31 09:02:33 Test Case "TestHandleTagAssignmentRequested/Success_-_Assign_New_Tag": Canceling subscription context.
2025/05/31 09:02:33 Test Case "TestHandleTagAssignmentRequested/Success_-_Assign_New_Tag": Waiting for subscriber goroutines to finish.
2025/05/31 09:02:33 Test Case "TestHandleTagAssignmentRequested/Success_-_Assign_New_Tag": Subscriber goroutines finished.
2025/05/31 09:02:33 Running leaderboard handler test cleanup...
2025/05/31 09:02:34 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:02:34 Router goroutine finished.
2025/05/31 09:02:34 Leaderboard handler test cleanup finished.
2025/05/31 09:02:34 Cleaning up test environment...
2025/05/31 09:02:34 Context cancelled.
2025/05/31 09:02:34 EventBus closed.
2025/05/31 09:02:34 NATS connection closed.
2025/05/31 09:02:34 DB connection closed.
2025/05/31 09:02:34  Stopping container: 12c5df1fa65a
2025/05/31 09:02:34  Container stopped: 12c5df1fa65a
2025/05/31 09:02:34  Terminating container: 12c5df1fa65a
2025/05/31 09:02:34  Container terminated: 12c5df1fa65a
2025/05/31 09:02:34 NATS container terminated.
2025/05/31 09:02:34  Stopping container: 5dcf511b75f5
2025/05/31 09:02:35  Container stopped: 5dcf511b75f5
2025/05/31 09:02:35  Terminating container: 5dcf511b75f5
2025/05/31 09:02:35  Container terminated: 5dcf511b75f5
2025/05/31 09:02:35 PostgreSQL container terminated.
2025/05/31 09:02:35 Cleanup complete.
=== RUN   TestHandleTagAssignmentRequested/Success_-_Update_Existing_Tag
2025/05/31 09:02:35 Starting PostgreSQL container with resource limits...
2025/05/31 09:02:35  Creating container for image postgres:16-alpine
2025/05/31 09:02:35  Container created: 8dae946196c4
2025/05/31 09:02:35  Starting container: 8dae946196c4
2025/05/31 09:02:35  Container started: 8dae946196c4
2025/05/31 09:02:35  Waiting for container id 8dae946196c4 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000f17c60 Strategies:[0xc00102dc50]}
2025/05/31 09:02:38  Container is ready: 8dae946196c4
2025/05/31 09:02:38 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39082/testdb?sslmode=disable
2025/05/31 09:02:38 Starting NATS container with resource limits...
2025/05/31 09:02:38  Creating container for image nats:2.10-alpine
2025/05/31 09:02:38  Container created: 46290f005621
2025/05/31 09:02:38  Starting container: 46290f005621
2025/05/31 09:02:38  Container started: 46290f005621
2025/05/31 09:02:38  Waiting for container id 46290f005621 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00110b368 Strategies:[0xc000d70960 0xc000b956b0]}
2025/05/31 09:02:41  Container is ready: 46290f005621
2025/05/31 09:02:41 NATS container started with resource limits. URL: nats://localhost:39083
Creating user table...
User table created successfully!
2025/05/31 09:02:41 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:02:41 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:02:41 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:02:41 Ran leaderboard migrations group #4
2025/05/31 09:02:41 All migrations ran successfully
2025/05/31 09:02:41 newDBServiceWithDB - Registering models
2025/05/31 09:02:41 newDBServiceWithDB - Models registered successfully
2025/05/31 09:02:41 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000444810 RoundDB:0xc000444820 ScoreDB:0xc000444830 LeaderboardDB:0xc000444838 db:0xc0007cd6c0}
2025/05/31 09:02:41 Truncating tables: leaderboards
    tag_assignment_test.go:269: Waiting for 1 messages on topic "discord.leaderboard.tag.assignment.success" with timeout 5s
2025/05/31 09:02:42 Test received message ced873e4-9cc3-4e03-8617-e580cab068a1 on topic "discord.leaderboard.tag.assignment.success"
    tag_assignment_test.go:269: Successfully received 1 messages on topic "discord.leaderboard.tag.assignment.success"
2025/05/31 09:02:42 Test Case "TestHandleTagAssignmentRequested/Success_-_Update_Existing_Tag": Canceling subscription context.
2025/05/31 09:02:42 Test Case "TestHandleTagAssignmentRequested/Success_-_Update_Existing_Tag": Waiting for subscriber goroutines to finish.
2025/05/31 09:02:42 Test Case "TestHandleTagAssignmentRequested/Success_-_Update_Existing_Tag": Subscriber goroutines finished.
2025/05/31 09:02:42 Running leaderboard handler test cleanup...
2025/05/31 09:02:43 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:02:43 Router goroutine finished.
2025/05/31 09:02:43 Leaderboard handler test cleanup finished.
2025/05/31 09:02:43 Cleaning up test environment...
2025/05/31 09:02:43 Context cancelled.
2025/05/31 09:02:43 EventBus closed.
2025/05/31 09:02:43 NATS connection closed.
2025/05/31 09:02:43 DB connection closed.
2025/05/31 09:02:43  Stopping container: 46290f005621
2025/05/31 09:02:43  Container stopped: 46290f005621
2025/05/31 09:02:43  Terminating container: 46290f005621
2025/05/31 09:02:43  Container terminated: 46290f005621
2025/05/31 09:02:43 NATS container terminated.
2025/05/31 09:02:43  Stopping container: 8dae946196c4
2025/05/31 09:02:43  Container stopped: 8dae946196c4
2025/05/31 09:02:43  Terminating container: 8dae946196c4
2025/05/31 09:02:43  Container terminated: 8dae946196c4
2025/05/31 09:02:43 PostgreSQL container terminated.
2025/05/31 09:02:43 Cleanup complete.
=== RUN   TestHandleTagAssignmentRequested/Success_-_Add_Brand_New_User
2025/05/31 09:02:43 Starting PostgreSQL container with resource limits...
2025/05/31 09:02:43  Creating container for image postgres:16-alpine
2025/05/31 09:02:44  Container created: ced64b8c52b9
2025/05/31 09:02:44  Starting container: ced64b8c52b9
2025/05/31 09:02:44  Container started: ced64b8c52b9
2025/05/31 09:02:44  Waiting for container id ced64b8c52b9 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0003ef778 Strategies:[0xc000f83620]}
2025/05/31 09:02:47  Container is ready: ced64b8c52b9
2025/05/31 09:02:47 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39087/testdb?sslmode=disable
2025/05/31 09:02:47 Starting NATS container with resource limits...
2025/05/31 09:02:47  Creating container for image nats:2.10-alpine
2025/05/31 09:02:47  Container created: 17727b9393fa
2025/05/31 09:02:47  Starting container: 17727b9393fa
2025/05/31 09:02:47  Container started: 17727b9393fa
2025/05/31 09:02:47  Waiting for container id 17727b9393fa image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000ec4688 Strategies:[0xc000aaacc0 0xc000b94c00]}
2025/05/31 09:02:50  Container is ready: 17727b9393fa
2025/05/31 09:02:50 NATS container started with resource limits. URL: nats://localhost:39089
Creating round table...
Round table created successfully!
2025/05/31 09:02:50 Ran round migrations group #1
Creating score table...
Score table created successfully!
2025/05/31 09:02:50 Ran score migrations group #2
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:02:50 Ran leaderboard migrations group #3
Creating user table...
User table created successfully!
2025/05/31 09:02:50 Ran user migrations group #4
2025/05/31 09:02:50 All migrations ran successfully
2025/05/31 09:02:50 newDBServiceWithDB - Registering models
2025/05/31 09:02:50 newDBServiceWithDB - Models registered successfully
2025/05/31 09:02:50 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007ced8 RoundDB:0xc00007cee0 ScoreDB:0xc00007cee8 LeaderboardDB:0xc00007cef0 db:0xc0004f1ec0}
2025/05/31 09:02:50 Truncating tables: leaderboards
    tag_assignment_test.go:269: Waiting for 1 messages on topic "discord.leaderboard.tag.assignment.success" with timeout 5s
2025/05/31 09:02:51 Test received message f9be7fce-77f0-412d-9f23-61ccf8a010db on topic "discord.leaderboard.tag.assignment.success"
    tag_assignment_test.go:269: Successfully received 1 messages on topic "discord.leaderboard.tag.assignment.success"
2025/05/31 09:02:51 Test Case "TestHandleTagAssignmentRequested/Success_-_Add_Brand_New_User": Canceling subscription context.
2025/05/31 09:02:51 Test Case "TestHandleTagAssignmentRequested/Success_-_Add_Brand_New_User": Waiting for subscriber goroutines to finish.
2025/05/31 09:02:51 Test Case "TestHandleTagAssignmentRequested/Success_-_Add_Brand_New_User": Subscriber goroutines finished.
2025/05/31 09:02:51 Running leaderboard handler test cleanup...
2025/05/31 09:02:52 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:02:52 Router goroutine finished.
2025/05/31 09:02:52 Leaderboard handler test cleanup finished.
2025/05/31 09:02:52 Cleaning up test environment...
2025/05/31 09:02:52 Context cancelled.
2025/05/31 09:02:52 EventBus closed.
2025/05/31 09:02:52 NATS connection closed.
2025/05/31 09:02:52 DB connection closed.
2025/05/31 09:02:52  Stopping container: 17727b9393fa
2025/05/31 09:02:52  Container stopped: 17727b9393fa
2025/05/31 09:02:52  Terminating container: 17727b9393fa
2025/05/31 09:02:52  Container terminated: 17727b9393fa
2025/05/31 09:02:52 NATS container terminated.
2025/05/31 09:02:52  Stopping container: ced64b8c52b9
2025/05/31 09:02:52  Container stopped: ced64b8c52b9
2025/05/31 09:02:52  Terminating container: ced64b8c52b9
2025/05/31 09:02:53  Container terminated: ced64b8c52b9
2025/05/31 09:02:53 PostgreSQL container terminated.
2025/05/31 09:02:53 Cleanup complete.
=== RUN   TestHandleTagAssignmentRequested/Success_-_Tag_Swap_Triggered_and_Processed
2025/05/31 09:02:53 Starting PostgreSQL container with resource limits...
2025/05/31 09:02:53  Creating container for image postgres:16-alpine
2025/05/31 09:02:53  Container created: 9aa38f86aa52
2025/05/31 09:02:53  Starting container: 9aa38f86aa52
2025/05/31 09:02:53  Container started: 9aa38f86aa52
2025/05/31 09:02:53  Waiting for container id 9aa38f86aa52 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0011e86d8 Strategies:[0xc0011f0db0]}
2025/05/31 09:02:55  Container is ready: 9aa38f86aa52
2025/05/31 09:02:55 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39092/testdb?sslmode=disable
2025/05/31 09:02:55 Starting NATS container with resource limits...
2025/05/31 09:02:55  Creating container for image nats:2.10-alpine
2025/05/31 09:02:56  Container created: 39f7954cfb6c
2025/05/31 09:02:56  Starting container: 39f7954cfb6c
2025/05/31 09:02:56  Container started: 39f7954cfb6c
2025/05/31 09:02:56  Waiting for container id 39f7954cfb6c image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00034ee08 Strategies:[0xc000d707e0 0xc001212240]}
2025/05/31 09:02:59  Container is ready: 39f7954cfb6c
2025/05/31 09:02:59 NATS container started with resource limits. URL: nats://localhost:39093
Creating user table...
User table created successfully!
2025/05/31 09:02:59 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:02:59 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:02:59 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:02:59 Ran leaderboard migrations group #4
2025/05/31 09:02:59 All migrations ran successfully
2025/05/31 09:02:59 newDBServiceWithDB - Registering models
2025/05/31 09:02:59 newDBServiceWithDB - Models registered successfully
2025/05/31 09:02:59 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000f9a368 RoundDB:0xc000f9a370 ScoreDB:0xc000f9a378 LeaderboardDB:0xc000f9a380 db:0xc0004f1740}
2025/05/31 09:02:59 Truncating tables: leaderboards
    tag_assignment_test.go:269: Waiting for 1 messages on topic "discord.leaderboard.tag.swap.processed" with timeout 5s
2025/05/31 09:03:00 Test received message ff6bca12-2242-4a2f-abc8-a4543dfb83a9 on topic "discord.leaderboard.tag.swap.processed"
    tag_assignment_test.go:269: Successfully received 1 messages on topic "discord.leaderboard.tag.swap.processed"
    tag_assignment_test.go:213: Received downstream swap processed event: ff6bca12-2242-4a2f-abc8-a4543dfb83a9
2025/05/31 09:03:00 Test Case "TestHandleTagAssignmentRequested/Success_-_Tag_Swap_Triggered_and_Processed": Canceling subscription context.
2025/05/31 09:03:00 Test Case "TestHandleTagAssignmentRequested/Success_-_Tag_Swap_Triggered_and_Processed": Waiting for subscriber goroutines to finish.
2025/05/31 09:03:00 Test Case "TestHandleTagAssignmentRequested/Success_-_Tag_Swap_Triggered_and_Processed": Subscriber goroutines finished.
2025/05/31 09:03:00 Running leaderboard handler test cleanup...
2025/05/31 09:03:01 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:03:01 Router goroutine finished.
2025/05/31 09:03:01 Leaderboard handler test cleanup finished.
2025/05/31 09:03:01 Cleaning up test environment...
2025/05/31 09:03:01 Context cancelled.
2025/05/31 09:03:01 EventBus closed.
2025/05/31 09:03:01 NATS connection closed.
2025/05/31 09:03:01 DB connection closed.
2025/05/31 09:03:01  Stopping container: 39f7954cfb6c
2025/05/31 09:03:01  Container stopped: 39f7954cfb6c
2025/05/31 09:03:01  Terminating container: 39f7954cfb6c
2025/05/31 09:03:01  Container terminated: 39f7954cfb6c
2025/05/31 09:03:01 NATS container terminated.
2025/05/31 09:03:01  Stopping container: 9aa38f86aa52
2025/05/31 09:03:01  Container stopped: 9aa38f86aa52
2025/05/31 09:03:01  Terminating container: 9aa38f86aa52
2025/05/31 09:03:01  Container terminated: 9aa38f86aa52
2025/05/31 09:03:01 PostgreSQL container terminated.
2025/05/31 09:03:01 Cleanup complete.
=== RUN   TestHandleTagAssignmentRequested/Failure_-_Invalid_JSON_Message
2025/05/31 09:03:01 Starting PostgreSQL container with resource limits...
2025/05/31 09:03:01  Creating container for image postgres:16-alpine
2025/05/31 09:03:02  Container created: 50206eb69229
2025/05/31 09:03:02  Starting container: 50206eb69229
2025/05/31 09:03:02  Container started: 50206eb69229
2025/05/31 09:03:02  Waiting for container id 50206eb69229 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000af53d8 Strategies:[0xc00113ee10]}
2025/05/31 09:03:04  Container is ready: 50206eb69229
2025/05/31 09:03:04 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39096/testdb?sslmode=disable
2025/05/31 09:03:04 Starting NATS container with resource limits...
2025/05/31 09:03:04  Creating container for image nats:2.10-alpine
2025/05/31 09:03:05  Container created: dee795f8b098
2025/05/31 09:03:05  Starting container: dee795f8b098
2025/05/31 09:03:05  Container started: dee795f8b098
2025/05/31 09:03:05  Waiting for container id dee795f8b098 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000b33888 Strategies:[0xc0008659e0 0xc001429bf0]}
2025/05/31 09:03:08  Container is ready: dee795f8b098
2025/05/31 09:03:08 NATS container started with resource limits. URL: nats://localhost:39097
Creating score table...
Score table created successfully!
2025/05/31 09:03:08 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:03:08 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:03:08 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:03:08 Ran round migrations group #4
2025/05/31 09:03:08 All migrations ran successfully
2025/05/31 09:03:08 newDBServiceWithDB - Registering models
2025/05/31 09:03:08 newDBServiceWithDB - Models registered successfully
2025/05/31 09:03:08 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000626740 RoundDB:0xc000626748 ScoreDB:0xc000626750 LeaderboardDB:0xc000626760 db:0xc001014600}
2025/05/31 09:03:08 Truncating tables: leaderboards
2025/05/31 09:03:09 Test Case "TestHandleTagAssignmentRequested/Failure_-_Invalid_JSON_Message": Canceling subscription context.
2025/05/31 09:03:09 Test Case "TestHandleTagAssignmentRequested/Failure_-_Invalid_JSON_Message": Waiting for subscriber goroutines to finish.
2025/05/31 09:03:09 Test Case "TestHandleTagAssignmentRequested/Failure_-_Invalid_JSON_Message": Subscriber goroutines finished.
2025/05/31 09:03:09 Running leaderboard handler test cleanup...
2025/05/31 09:03:10 Error closing Leaderboard module: error closing LeaderboardRouter: router close timeout
2025/05/31 09:03:10 Router goroutine finished.
2025/05/31 09:03:10 Leaderboard handler test cleanup finished.
2025/05/31 09:03:10 Cleaning up test environment...
2025/05/31 09:03:10 Context cancelled.
2025/05/31 09:03:10 EventBus closed.
2025/05/31 09:03:10 NATS connection closed.
2025/05/31 09:03:10 DB connection closed.
2025/05/31 09:03:10  Stopping container: dee795f8b098
2025/05/31 09:03:10  Container stopped: dee795f8b098
2025/05/31 09:03:10  Terminating container: dee795f8b098
2025/05/31 09:03:10  Container terminated: dee795f8b098
2025/05/31 09:03:10 NATS container terminated.
2025/05/31 09:03:10  Stopping container: 50206eb69229
2025/05/31 09:03:11  Container stopped: 50206eb69229
2025/05/31 09:03:11  Terminating container: 50206eb69229
2025/05/31 09:03:11  Container terminated: 50206eb69229
2025/05/31 09:03:11 PostgreSQL container terminated.
2025/05/31 09:03:11 Cleanup complete.
--- PASS: TestHandleTagAssignmentRequested (45.44s)
    --- PASS: TestHandleTagAssignmentRequested/Success_-_Assign_New_Tag (9.41s)
    --- PASS: TestHandleTagAssignmentRequested/Success_-_Update_Existing_Tag (8.87s)
    --- PASS: TestHandleTagAssignmentRequested/Success_-_Add_Brand_New_User (9.03s)
    --- PASS: TestHandleTagAssignmentRequested/Success_-_Tag_Swap_Triggered_and_Processed (8.94s)
    --- PASS: TestHandleTagAssignmentRequested/Failure_-_Invalid_JSON_Message (9.18s)
PASS
coverage: 11.8% of statements in ./app/...
2025/05/31 09:03:11 TestMain: finished with exit code: 0
ok  	github.com/Black-And-White-Club/frolf-bot/integration_tests/modules/leaderboard/handler_tests	237.761s	coverage: 11.8% of statements in ./app/...
=== RUN   TestValidateRoundDeleteRequest
=== RUN   TestValidateRoundDeleteRequest/Successful_validation_of_delete_request
2025/05/31 08:59:16 Initializing round test environment...
2025/05/31 08:59:16 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:16 github.com/testcontainers/testcontainers-go - Connected to docker: 
  Server Version: 28.1.1
  API Version: 1.48
  Operating System: Ubuntu 24.04.1 LTS
  Total Memory: 5923 MB
  Testcontainers for Go Version: v0.37.0
  Resolved Docker Host: unix:///Users/jace/.colima/default/docker.sock
  Resolved Docker Socket Path: /var/run/docker.sock
  Test SessionID: 3bcca53efbc96e46a6c192358bf7642f396e27e5bff8699ef9bf67ff02cc0815
  Test ProcessID: e5251529-4837-48f7-b40e-94d33c5b7f4b
2025/05/31 08:59:16  Creating container for image postgres:16-alpine
2025/05/31 08:59:16  Waiting for Reaper "f69f8f9c" to be ready
2025/05/31 08:59:16  Reaper obtained from Docker for this test session f69f8f9c
2025/05/31 08:59:16  Container created: 31e04be3ecf5
2025/05/31 08:59:16  Starting container: 31e04be3ecf5
2025/05/31 08:59:17  Container started: 31e04be3ecf5
2025/05/31 08:59:17  Waiting for container id 31e04be3ecf5 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0004a5380 Strategies:[0xc00053b440]}
2025/05/31 08:59:27  Container is ready: 31e04be3ecf5
2025/05/31 08:59:27 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38810/testdb?sslmode=disable
2025/05/31 08:59:27 Starting NATS container with resource limits...
2025/05/31 08:59:27  Creating container for image nats:2.10-alpine
2025/05/31 08:59:27  Container created: 14bb31bac842
2025/05/31 08:59:27  Starting container: 14bb31bac842
2025/05/31 08:59:29  Container started: 14bb31bac842
2025/05/31 08:59:29  Waiting for container id 14bb31bac842 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0006eb360 Strategies:[0xc00069d620 0xc0004a25a0]}
2025/05/31 08:59:32  Container is ready: 14bb31bac842
2025/05/31 08:59:33 NATS container started with resource limits. URL: nats://localhost:38827
Creating round table...
Round table created successfully!
2025/05/31 08:59:33 Ran round migrations group #1
Creating score table...
Score table created successfully!
2025/05/31 08:59:33 Ran score migrations group #2
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:33 Ran leaderboard migrations group #3
Creating user table...
User table created successfully!
2025/05/31 08:59:33 Ran user migrations group #4
2025/05/31 08:59:33 All migrations ran successfully
2025/05/31 08:59:33 newDBServiceWithDB - Registering models
2025/05/31 08:59:33 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:33 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000706560 RoundDB:0xc000706568 ScoreDB:0xc000706570 LeaderboardDB:0xc000706578 db:0xc000389f40}
2025/05/31 08:59:34 Round test environment initialized successfully.
2025/05/31 08:59:34 Truncating tables: rounds
=== RUN   TestValidateRoundDeleteRequest/Validation_fails_with_zero_RoundID
2025/05/31 08:59:34 Truncating tables: rounds
=== RUN   TestValidateRoundDeleteRequest/Validation_fails_with_empty_RequestingUserUserID
2025/05/31 08:59:35 Truncating tables: rounds
=== RUN   TestValidateRoundDeleteRequest/Validation_fails_when_round_does_not_exist
2025/05/31 08:59:35 Truncating tables: rounds
=== RUN   TestValidateRoundDeleteRequest/Validation_fails_when_user_is_not_the_creator
2025/05/31 08:59:35 Truncating tables: rounds
--- PASS: TestValidateRoundDeleteRequest (19.96s)
    --- PASS: TestValidateRoundDeleteRequest/Successful_validation_of_delete_request (18.55s)
    --- PASS: TestValidateRoundDeleteRequest/Validation_fails_with_zero_RoundID (0.49s)
    --- PASS: TestValidateRoundDeleteRequest/Validation_fails_with_empty_RequestingUserUserID (0.36s)
    --- PASS: TestValidateRoundDeleteRequest/Validation_fails_when_round_does_not_exist (0.25s)
    --- PASS: TestValidateRoundDeleteRequest/Validation_fails_when_user_is_not_the_creator (0.31s)
=== RUN   TestDeleteRound
=== RUN   TestDeleteRound/Successful_deletion_of_an_existing_round
2025/05/31 08:59:36 Truncating tables: rounds
2025/05/31 08:59:36 INFO round deleted from DB
=== RUN   TestDeleteRound/Attempt_to_delete_a_non-existent_round
2025/05/31 08:59:36 Truncating tables: rounds
=== RUN   TestDeleteRound/Deletion_with_EventBus_error_(should_still_succeed_for_round_deletion)
2025/05/31 08:59:37 Truncating tables: rounds
2025/05/31 08:59:37 INFO round deleted from DB
=== RUN   TestDeleteRound/Attempt_to_delete_round_with_nil_UUID_payload
2025/05/31 08:59:37 Truncating tables: rounds
--- PASS: TestDeleteRound (1.74s)
    --- PASS: TestDeleteRound/Successful_deletion_of_an_existing_round (0.57s)
    --- PASS: TestDeleteRound/Attempt_to_delete_a_non-existent_round (0.47s)
    --- PASS: TestDeleteRound/Deletion_with_EventBus_error_(should_still_succeed_for_round_deletion) (0.31s)
    --- PASS: TestDeleteRound/Attempt_to_delete_round_with_nil_UUID_payload (0.39s)
=== RUN   TestFinalizeRound
=== RUN   TestFinalizeRound/Successful_finalization_of_an_existing_round
2025/05/31 08:59:37 Truncating tables: rounds
=== RUN   TestFinalizeRound/Attempt_to_finalize_a_non-existent_round
2025/05/31 08:59:38 Truncating tables: rounds
=== RUN   TestFinalizeRound/Finalization_with_nil_UUID_payload
2025/05/31 08:59:38 Truncating tables: rounds
=== RUN   TestFinalizeRound/Round_finalization_with_database_update_success_but_fetch_failure
2025/05/31 08:59:39 Truncating tables: rounds
--- PASS: TestFinalizeRound (1.52s)
    --- PASS: TestFinalizeRound/Successful_finalization_of_an_existing_round (0.52s)
    --- PASS: TestFinalizeRound/Attempt_to_finalize_a_non-existent_round (0.37s)
    --- PASS: TestFinalizeRound/Finalization_with_nil_UUID_payload (0.27s)
    --- PASS: TestFinalizeRound/Round_finalization_with_database_update_success_but_fetch_failure (0.36s)
=== RUN   TestNotifyScoreModule
=== RUN   TestNotifyScoreModule/Successful_notification_with_participants_having_scores_and_tag_numbers
2025/05/31 08:59:39 Truncating tables: rounds
=== RUN   TestNotifyScoreModule/Successful_notification_with_participants_having_nil_scores_and_tag_numbers
2025/05/31 08:59:39 Truncating tables: rounds
=== RUN   TestNotifyScoreModule/Successful_notification_with_empty_participants_list
2025/05/31 08:59:39 Truncating tables: rounds
=== RUN   TestNotifyScoreModule/Notification_with_mixed_participant_data
2025/05/31 08:59:40 Truncating tables: rounds
--- PASS: TestNotifyScoreModule (1.22s)
    --- PASS: TestNotifyScoreModule/Successful_notification_with_participants_having_scores_and_tag_numbers (0.19s)
    --- PASS: TestNotifyScoreModule/Successful_notification_with_participants_having_nil_scores_and_tag_numbers (0.37s)
    --- PASS: TestNotifyScoreModule/Successful_notification_with_empty_participants_list (0.33s)
    --- PASS: TestNotifyScoreModule/Notification_with_mixed_participant_data (0.33s)
=== RUN   TestParticipantRemoval
=== RUN   TestParticipantRemoval/Valid_removal_of_existing_participant_-_Expecting_ParticipantRemovedPayload
2025/05/31 08:59:40 Truncating tables: rounds
=== RUN   TestParticipantRemoval/Attempt_to_remove_non-existent_participant_-_Should_succeed_with_no_changes
2025/05/31 08:59:41 Truncating tables: rounds
=== RUN   TestParticipantRemoval/Remove_participant_from_round_with_multiple_participants_of_same_response_type
2025/05/31 08:59:41 Truncating tables: rounds
=== RUN   TestParticipantRemoval/Attempt_to_remove_participant_from_non-existent_round_-_Expecting_Error
2025/05/31 08:59:41 Truncating tables: rounds
=== RUN   TestParticipantRemoval/Remove_last_participant_from_round_-_Should_result_in_empty_lists
2025/05/31 08:59:42 Truncating tables: rounds
--- PASS: TestParticipantRemoval (2.14s)
    --- PASS: TestParticipantRemoval/Valid_removal_of_existing_participant_-_Expecting_ParticipantRemovedPayload (0.58s)
    --- PASS: TestParticipantRemoval/Attempt_to_remove_non-existent_participant_-_Should_succeed_with_no_changes (0.41s)
    --- PASS: TestParticipantRemoval/Remove_participant_from_round_with_multiple_participants_of_same_response_type (0.36s)
    --- PASS: TestParticipantRemoval/Attempt_to_remove_participant_from_non-existent_round_-_Expecting_Error (0.39s)
    --- PASS: TestParticipantRemoval/Remove_last_participant_from_round_-_Should_result_in_empty_lists (0.40s)
=== RUN   TestUpdateParticipantStatus
=== RUN   TestUpdateParticipantStatus/Internal_update:_Participant_status_and_tag_number_set_after_lookup
2025/05/31 08:59:42 Truncating tables: rounds
>>> Found existing participant existing_participant at index 0, updating...
>>> Updating response for user existing_participant: Old=TENTATIVE, New=ACCEPT
>>> Updating tag number for user existing_participant: Old=1, New=123
>>> After update: ParticipantsCount=1, Participants=[{existing_participant 123 ACCEPT 0xc0007d2528}]
>>> Update successful. Final participants count: 1
=== RUN   TestUpdateParticipantStatus/Participant_accepts_without_TagNumber_(adds_participant_with_nil_tag)
2025/05/31 08:59:43 Truncating tables: rounds
>>> Adding new participant: UserID=participant_needs_tag, Response=ACCEPT, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{participant_needs_tag <nil> ACCEPT <nil>}]
>>> Update successful. Final participants count: 1
=== RUN   TestUpdateParticipantStatus/Participant_declines_(direct_update)
2025/05/31 08:59:43 Truncating tables: rounds
>>> Found existing participant participant_to_decline at index 0, updating...
>>> Updating response for user participant_to_decline: Old=ACCEPT, New=DECLINE
>>> Updating tag number for user participant_to_decline: Old=2, New=<nil>
>>> After update: ParticipantsCount=1, Participants=[{participant_to_decline <nil> DECLINE 0xc000355b30}]
>>> Update successful. Final participants count: 1
=== RUN   TestUpdateParticipantStatus/Attempt_to_update_participant_in_non-existent_round_(with_tag)_-_Expecting_Error
2025/05/31 08:59:44 Truncating tables: rounds
=== RUN   TestUpdateParticipantStatus/Attempt_to_update_participant_in_non-existent_round_(decline)_-_Expecting_Error
2025/05/31 08:59:44 Truncating tables: rounds
=== RUN   TestUpdateParticipantStatus/Unknown_response_type_-_Expecting_Error
2025/05/31 08:59:44 Truncating tables: rounds
--- PASS: TestUpdateParticipantStatus (2.45s)
    --- PASS: TestUpdateParticipantStatus/Internal_update:_Participant_status_and_tag_number_set_after_lookup (0.49s)
    --- PASS: TestUpdateParticipantStatus/Participant_accepts_without_TagNumber_(adds_participant_with_nil_tag) (0.48s)
    --- PASS: TestUpdateParticipantStatus/Participant_declines_(direct_update) (0.47s)
    --- PASS: TestUpdateParticipantStatus/Attempt_to_update_participant_in_non-existent_round_(with_tag)_-_Expecting_Error (0.22s)
    --- PASS: TestUpdateParticipantStatus/Attempt_to_update_participant_in_non-existent_round_(decline)_-_Expecting_Error (0.34s)
    --- PASS: TestUpdateParticipantStatus/Unknown_response_type_-_Expecting_Error (0.44s)
=== RUN   TestCheckParticipantStatus
=== RUN   TestCheckParticipantStatus/User_not_a_participant,_requesting_Accept_-_Expecting_Validation_Request
2025/05/31 08:59:45 Truncating tables: rounds
=== RUN   TestCheckParticipantStatus/User_is_participant_with_Accept,_requesting_Accept_(toggle_off)_-_Expecting_Removal_Request
2025/05/31 08:59:45 Truncating tables: rounds
=== RUN   TestCheckParticipantStatus/User_is_participant_with_Tentative,_requesting_Accept_(change_status)_-_Expecting_Validation_Request
2025/05/31 08:59:46 Truncating tables: rounds
=== RUN   TestCheckParticipantStatus/Round_ID_is_nil_-_Expecting_Error
2025/05/31 08:59:46 Truncating tables: rounds
=== RUN   TestCheckParticipantStatus/Attempt_to_check_status_for_a_non-existent_round_-_Expecting_Error
2025/05/31 08:59:47 Truncating tables: rounds
--- PASS: TestCheckParticipantStatus (2.23s)
    --- PASS: TestCheckParticipantStatus/User_not_a_participant,_requesting_Accept_-_Expecting_Validation_Request (0.47s)
    --- PASS: TestCheckParticipantStatus/User_is_participant_with_Accept,_requesting_Accept_(toggle_off)_-_Expecting_Removal_Request (0.56s)
    --- PASS: TestCheckParticipantStatus/User_is_participant_with_Tentative,_requesting_Accept_(change_status)_-_Expecting_Validation_Request (0.44s)
    --- PASS: TestCheckParticipantStatus/Round_ID_is_nil_-_Expecting_Error (0.37s)
    --- PASS: TestCheckParticipantStatus/Attempt_to_check_status_for_a_non-existent_round_-_Expecting_Error (0.38s)
=== RUN   TestValidateParticipantJoinRequest
=== RUN   TestValidateParticipantJoinRequest/Valid_Accept_request,_round_Created_(not_late_join)_-_Expecting_TagLookupRequestPayload
2025/05/31 08:59:47 Truncating tables: rounds
=== RUN   TestValidateParticipantJoinRequest/Valid_Tentative_request,_round_InProgress_(late_join)_-_Expecting_TagLookupRequestPayload
2025/05/31 08:59:48 Truncating tables: rounds
=== RUN   TestValidateParticipantJoinRequest/Valid_Decline_request,_round_Finalized_(late_join)_-_Expecting_ParticipantJoinRequestPayload
2025/05/31 08:59:48 Truncating tables: rounds
=== RUN   TestValidateParticipantJoinRequest/Invalid:_Nil_Round_ID_-_Expecting_Error
2025/05/31 08:59:48 Truncating tables: rounds
=== RUN   TestValidateParticipantJoinRequest/Invalid:_Empty_User_ID_-_Expecting_Error
2025/05/31 08:59:48 Truncating tables: rounds
=== RUN   TestValidateParticipantJoinRequest/Attempt_to_validate_join_for_a_non-existent_round_-_Expecting_Error
2025/05/31 08:59:49 Truncating tables: rounds
=== RUN   TestValidateParticipantJoinRequest/Invalid:_Unexpected_response_type_-_Expecting_Error
2025/05/31 08:59:49 Truncating tables: rounds
--- PASS: TestValidateParticipantJoinRequest (2.38s)
    --- PASS: TestValidateParticipantJoinRequest/Valid_Accept_request,_round_Created_(not_late_join)_-_Expecting_TagLookupRequestPayload (0.56s)
    --- PASS: TestValidateParticipantJoinRequest/Valid_Tentative_request,_round_InProgress_(late_join)_-_Expecting_TagLookupRequestPayload (0.26s)
    --- PASS: TestValidateParticipantJoinRequest/Valid_Decline_request,_round_Finalized_(late_join)_-_Expecting_ParticipantJoinRequestPayload (0.24s)
    --- PASS: TestValidateParticipantJoinRequest/Invalid:_Nil_Round_ID_-_Expecting_Error (0.27s)
    --- PASS: TestValidateParticipantJoinRequest/Invalid:_Empty_User_ID_-_Expecting_Error (0.34s)
    --- PASS: TestValidateParticipantJoinRequest/Attempt_to_validate_join_for_a_non-existent_round_-_Expecting_Error (0.38s)
    --- PASS: TestValidateParticipantJoinRequest/Invalid:_Unexpected_response_type_-_Expecting_Error (0.33s)
=== RUN   TestUpdateScheduledRoundsWithNewTags
=== RUN   TestUpdateScheduledRoundsWithNewTags/Successful_update_of_scheduled_rounds_with_new_tags
2025/05/31 08:59:49 Truncating tables: rounds
=== RUN   TestUpdateScheduledRoundsWithNewTags/No_rounds_to_update_when_no_participants_match_changed_tags
2025/05/31 08:59:50 Truncating tables: rounds
=== RUN   TestUpdateScheduledRoundsWithNewTags/Update_with_empty_ChangedTags_map
2025/05/31 08:59:50 Truncating tables: rounds
=== RUN   TestUpdateScheduledRoundsWithNewTags/Update_with_nil_tag_values
2025/05/31 08:59:50 Truncating tables: rounds
--- PASS: TestUpdateScheduledRoundsWithNewTags (1.29s)
    --- PASS: TestUpdateScheduledRoundsWithNewTags/Successful_update_of_scheduled_rounds_with_new_tags (0.32s)
    --- PASS: TestUpdateScheduledRoundsWithNewTags/No_rounds_to_update_when_no_participants_match_changed_tags (0.30s)
    --- PASS: TestUpdateScheduledRoundsWithNewTags/Update_with_empty_ChangedTags_map (0.32s)
    --- PASS: TestUpdateScheduledRoundsWithNewTags/Update_with_nil_tag_values (0.36s)
=== RUN   TestGetRound
=== RUN   TestGetRound/Successful_retrieval_of_an_existing_round
2025/05/31 08:59:51 Truncating tables: rounds
=== RUN   TestGetRound/Retrieval_of_a_non-existent_round
2025/05/31 08:59:51 Truncating tables: rounds
--- PASS: TestGetRound (0.50s)
    --- PASS: TestGetRound/Successful_retrieval_of_an_existing_round (0.30s)
    --- PASS: TestGetRound/Retrieval_of_a_non-existent_round (0.21s)
=== RUN   TestProcessRoundReminder
=== RUN   TestProcessRoundReminder/Successful_processing_with_accepted_and_tentative_participants
2025/05/31 08:59:51 Truncating tables: rounds
=== RUN   TestProcessRoundReminder/Successful_processing_with_no_participants_to_notify
2025/05/31 08:59:51 Truncating tables: rounds
=== RUN   TestProcessRoundReminder/Error:_Round_not_found_in_DB
2025/05/31 08:59:51 Truncating tables: rounds
--- PASS: TestProcessRoundReminder (0.47s)
    --- PASS: TestProcessRoundReminder/Successful_processing_with_accepted_and_tentative_participants (0.15s)
    --- PASS: TestProcessRoundReminder/Successful_processing_with_no_participants_to_notify (0.15s)
    --- PASS: TestProcessRoundReminder/Error:_Round_not_found_in_DB (0.18s)
=== RUN   TestScheduleRoundEvents_Behavioral
=== RUN   TestScheduleRoundEvents_Behavioral/Round_scheduled_1_second_in_future_-_only_start_event_expected_(reminder_skipped)
2025/05/31 08:59:52 Truncating tables: rounds
    schedule_round_test.go:58: Start event received for RoundID: 73dbcf29-5e13-48f6-8f62-51c6e4065c57
    schedule_round_test.go:92: Start event received as expected
    schedule_round_test.go:99: Reminder event NOT received as expected (correct behavior)
=== RUN   TestScheduleRoundEvents_Behavioral/Verify_delayed_messages_are_published_to_stream_with_correct_info
2025/05/31 08:59:54 Truncating tables: rounds
--- PASS: TestScheduleRoundEvents_Behavioral (2.77s)
    --- PASS: TestScheduleRoundEvents_Behavioral/Round_scheduled_1_second_in_future_-_only_start_event_expected_(reminder_skipped) (2.22s)
    --- PASS: TestScheduleRoundEvents_Behavioral/Verify_delayed_messages_are_published_to_stream_with_correct_info (0.55s)
=== RUN   TestValidateScoreUpdateRequest
=== RUN   TestValidateScoreUpdateRequest/Valid_score_update_request
2025/05/31 08:59:54 Truncating tables: rounds
=== RUN   TestValidateScoreUpdateRequest/Invalid_request_-_zero_round_ID
2025/05/31 08:59:55 Truncating tables: rounds
=== RUN   TestValidateScoreUpdateRequest/Invalid_request_-_empty_participant
2025/05/31 08:59:55 Truncating tables: rounds
=== RUN   TestValidateScoreUpdateRequest/Invalid_request_-_nil_score
2025/05/31 08:59:55 Truncating tables: rounds
=== RUN   TestValidateScoreUpdateRequest/Invalid_request_-_multiple_validation_errors
2025/05/31 08:59:55 Truncating tables: rounds
--- PASS: TestValidateScoreUpdateRequest (1.39s)
    --- PASS: TestValidateScoreUpdateRequest/Valid_score_update_request (0.42s)
    --- PASS: TestValidateScoreUpdateRequest/Invalid_request_-_zero_round_ID (0.29s)
    --- PASS: TestValidateScoreUpdateRequest/Invalid_request_-_empty_participant (0.21s)
    --- PASS: TestValidateScoreUpdateRequest/Invalid_request_-_nil_score (0.21s)
    --- PASS: TestValidateScoreUpdateRequest/Invalid_request_-_multiple_validation_errors (0.26s)
=== RUN   TestUpdateParticipantScore
=== RUN   TestUpdateParticipantScore/Successful_score_update
2025/05/31 08:59:56 Truncating tables: rounds
=== RUN   TestUpdateParticipantScore/Database_update_failure_(non-existent_round)
2025/05/31 08:59:56 Truncating tables: rounds
--- PASS: TestUpdateParticipantScore (0.51s)
    --- PASS: TestUpdateParticipantScore/Successful_score_update (0.28s)
    --- PASS: TestUpdateParticipantScore/Database_update_failure_(non-existent_round) (0.23s)
=== RUN   TestCheckAllScoresSubmitted
=== RUN   TestCheckAllScoresSubmitted/All_scores_submitted
2025/05/31 08:59:56 Truncating tables: rounds
=== RUN   TestCheckAllScoresSubmitted/Not_all_scores_submitted
2025/05/31 08:59:57 Truncating tables: rounds
=== RUN   TestCheckAllScoresSubmitted/Database_error_during_score_check_(non-existent_round)
2025/05/31 08:59:57 Truncating tables: rounds
--- PASS: TestCheckAllScoresSubmitted (0.96s)
    --- PASS: TestCheckAllScoresSubmitted/All_scores_submitted (0.28s)
    --- PASS: TestCheckAllScoresSubmitted/Not_all_scores_submitted (0.38s)
    --- PASS: TestCheckAllScoresSubmitted/Database_error_during_score_check_(non-existent_round) (0.30s)
=== RUN   TestProcessRoundStart
=== RUN   TestProcessRoundStart/Successful_round_start
2025/05/31 08:59:57 Truncating tables: rounds
=== RUN   TestProcessRoundStart/Round_not_found_in_DB
2025/05/31 08:59:58 Truncating tables: rounds
=== RUN   TestProcessRoundStart/Failed_to_update_round_state_in_DB
2025/05/31 08:59:58 Truncating tables: rounds
--- PASS: TestProcessRoundStart (0.93s)
    --- PASS: TestProcessRoundStart/Successful_round_start (0.36s)
    --- PASS: TestProcessRoundStart/Round_not_found_in_DB (0.27s)
    --- PASS: TestProcessRoundStart/Failed_to_update_round_state_in_DB (0.30s)
=== RUN   TestStoreRound
=== RUN   TestStoreRound/Successful_round_storage
2025/05/31 08:59:58 Truncating tables: rounds
=== RUN   TestStoreRound/Validation_failure_-_missing_title_in_payload
2025/05/31 08:59:58 Truncating tables: rounds
=== RUN   TestStoreRound/Validation_failure_-_nil_description_in_payload
2025/05/31 08:59:59 Truncating tables: rounds
=== RUN   TestStoreRound/Validation_failure_-_nil_location_in_payload
2025/05/31 08:59:59 Truncating tables: rounds
=== RUN   TestStoreRound/Validation_failure_-_nil_start_time_in_payload
2025/05/31 09:00:00 Truncating tables: rounds
--- PASS: TestStoreRound (1.65s)
    --- PASS: TestStoreRound/Successful_round_storage (0.32s)
    --- PASS: TestStoreRound/Validation_failure_-_missing_title_in_payload (0.30s)
    --- PASS: TestStoreRound/Validation_failure_-_nil_description_in_payload (0.37s)
    --- PASS: TestStoreRound/Validation_failure_-_nil_location_in_payload (0.38s)
    --- PASS: TestStoreRound/Validation_failure_-_nil_start_time_in_payload (0.28s)
=== RUN   TestUpdateRoundMessageID
=== RUN   TestUpdateRoundMessageID/Successful_update_of_Discord_message_ID_for_an_existing_round
2025/05/31 09:00:00 Truncating tables: rounds
=== RUN   TestUpdateRoundMessageID/Attempt_to_update_Discord_message_ID_for_a_non-existent_round
2025/05/31 09:00:00 Truncating tables: rounds
=== RUN   TestUpdateRoundMessageID/Update_Discord_message_ID_to_an_empty_string
2025/05/31 09:00:00 Truncating tables: rounds
--- PASS: TestUpdateRoundMessageID (1.02s)
    --- PASS: TestUpdateRoundMessageID/Successful_update_of_Discord_message_ID_for_an_existing_round (0.32s)
    --- PASS: TestUpdateRoundMessageID/Attempt_to_update_Discord_message_ID_for_a_non-existent_round (0.29s)
    --- PASS: TestUpdateRoundMessageID/Update_Discord_message_ID_to_an_empty_string (0.40s)
=== RUN   TestValidateRoundUpdateRequest
=== RUN   TestValidateRoundUpdateRequest/Valid_update_request_-_Title_only
2025/05/31 09:00:01 Truncating tables: rounds
=== RUN   TestValidateRoundUpdateRequest/Valid_update_request_-_All_fields_including_EventType
2025/05/31 09:00:01 Truncating tables: rounds
=== RUN   TestValidateRoundUpdateRequest/Invalid_update_request_-_Zero_RoundID
2025/05/31 09:00:01 Truncating tables: rounds
=== RUN   TestValidateRoundUpdateRequest/Invalid_update_request_-_No_fields_to_update
2025/05/31 09:00:02 Truncating tables: rounds
=== RUN   TestValidateRoundUpdateRequest/Invalid_update_request_-_Zero_RoundID_and_no_fields_to_update
2025/05/31 09:00:02 Truncating tables: rounds
--- PASS: TestValidateRoundUpdateRequest (1.39s)
    --- PASS: TestValidateRoundUpdateRequest/Valid_update_request_-_Title_only (0.29s)
    --- PASS: TestValidateRoundUpdateRequest/Valid_update_request_-_All_fields_including_EventType (0.31s)
    --- PASS: TestValidateRoundUpdateRequest/Invalid_update_request_-_Zero_RoundID (0.32s)
    --- PASS: TestValidateRoundUpdateRequest/Invalid_update_request_-_No_fields_to_update (0.25s)
    --- PASS: TestValidateRoundUpdateRequest/Invalid_update_request_-_Zero_RoundID_and_no_fields_to_update (0.22s)
=== RUN   TestUpdateRoundEntity
=== RUN   TestUpdateRoundEntity/Successful_update_of_title
2025/05/31 09:00:02 Truncating tables: rounds
=== RUN   TestUpdateRoundEntity/Successful_update_of_description,_location,_and_start_time
2025/05/31 09:00:02 Truncating tables: rounds
=== RUN   TestUpdateRoundEntity/Successful_update_of_EventType
2025/05/31 09:00:03 Truncating tables: rounds
=== RUN   TestUpdateRoundEntity/Failed_to_fetch_existing_round_(round_not_in_DB)
2025/05/31 09:00:03 Truncating tables: rounds
--- PASS: TestUpdateRoundEntity (1.06s)
    --- PASS: TestUpdateRoundEntity/Successful_update_of_title (0.23s)
    --- PASS: TestUpdateRoundEntity/Successful_update_of_description,_location,_and_start_time (0.30s)
    --- PASS: TestUpdateRoundEntity/Successful_update_of_EventType (0.25s)
    --- PASS: TestUpdateRoundEntity/Failed_to_fetch_existing_round_(round_not_in_DB) (0.28s)
=== RUN   TestUpdateScheduledRoundEvents
=== RUN   TestUpdateScheduledRoundEvents/Successful_update_of_scheduled_events
2025/05/31 09:00:03 Truncating tables: rounds
=== RUN   TestUpdateScheduledRoundEvents/Failed_to_fetch_round_for_rescheduling
2025/05/31 09:00:04 Truncating tables: rounds
--- PASS: TestUpdateScheduledRoundEvents (0.70s)
    --- PASS: TestUpdateScheduledRoundEvents/Successful_update_of_scheduled_events (0.32s)
    --- PASS: TestUpdateScheduledRoundEvents/Failed_to_fetch_round_for_rescheduling (0.38s)
=== RUN   TestValidateAndProcessRound
=== RUN   TestValidateAndProcessRound/Successful_round_creation
2025/05/31 09:00:04 Truncating tables: rounds
2025/05/31 09:00:04 INFO Timezone override user_timezone=America/Chicago
2025/05/31 09:00:04 INFO Parsed time using when parsed_time=2025-06-01T10:00:00-05:00
=== RUN   TestValidateAndProcessRound/Validation_failure_-_missing_title
2025/05/31 09:00:04 Truncating tables: rounds
=== RUN   TestValidateAndProcessRound/Validation_failure_-_start_time_in_past_(flaky_test)
2025/05/31 09:00:05 Truncating tables: rounds
2025/05/31 09:00:05 INFO Timezone override user_timezone=America/New_York
2025/05/31 09:00:05 INFO Parsed time using when parsed_time=2025-05-30T17:00:00-04:00
=== RUN   TestValidateAndProcessRound/Time_parsing_failure
2025/05/31 09:00:05 Truncating tables: rounds
2025/05/31 09:00:05 INFO Timezone override user_timezone=America/Los_Angeles
2025/05/31 09:00:05 WARN `when` failed to parse input, falling back to manual parsing input="not a real time string"
=== RUN   TestValidateAndProcessRound/Successful_creation_with_empty_description_and_location
2025/05/31 09:00:05 Truncating tables: rounds
=== RUN   TestValidateAndProcessRound/Successful_creation_with_optional_fields
2025/05/31 09:00:06 Truncating tables: rounds
2025/05/31 09:00:06 INFO Timezone override user_timezone=UTC
2025/05/31 09:00:06 INFO Parsed time using when parsed_time=2025-06-02T15:00:00Z
--- PASS: TestValidateAndProcessRound (2.29s)
    --- PASS: TestValidateAndProcessRound/Successful_round_creation (0.28s)
    --- PASS: TestValidateAndProcessRound/Validation_failure_-_missing_title (0.55s)
    --- PASS: TestValidateAndProcessRound/Validation_failure_-_start_time_in_past_(flaky_test) (0.33s)
    --- PASS: TestValidateAndProcessRound/Time_parsing_failure (0.34s)
    --- PASS: TestValidateAndProcessRound/Successful_creation_with_empty_description_and_location (0.48s)
    --- PASS: TestValidateAndProcessRound/Successful_creation_with_optional_fields (0.32s)
PASS
coverage: 14.4% of statements in ./app/...
ok  	github.com/Black-And-White-Club/frolf-bot/integration_tests/modules/round/application_tests	53.363s	coverage: 14.4% of statements in ./app/...
2025/05/31 08:59:16 TestMain started in package roundhandler_integration_tests
=== RUN   TestHandleRoundEntityCreated
=== RUN   TestHandleRoundEntityCreated/Success_-_Handler_Processes_Valid_Message_and_Publishes_Success_Event
2025/05/31 08:59:16 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:16 github.com/testcontainers/testcontainers-go - Connected to docker: 
  Server Version: 28.1.1
  API Version: 1.48
  Operating System: Ubuntu 24.04.1 LTS
  Total Memory: 5923 MB
  Testcontainers for Go Version: v0.37.0
  Resolved Docker Host: unix:///Users/jace/.colima/default/docker.sock
  Resolved Docker Socket Path: /var/run/docker.sock
  Test SessionID: 3bcca53efbc96e46a6c192358bf7642f396e27e5bff8699ef9bf67ff02cc0815
  Test ProcessID: 07676769-872f-4d2b-ae40-4eaadb480136
2025/05/31 08:59:16  Creating container for image postgres:16-alpine
2025/05/31 08:59:17  Waiting for Reaper "f69f8f9c" to be ready
2025/05/31 08:59:17  Reaper obtained from Docker for this test session f69f8f9c
2025/05/31 08:59:17  Container created: bf1775cb3157
2025/05/31 08:59:17  Starting container: bf1775cb3157
2025/05/31 08:59:17  Container started: bf1775cb3157
2025/05/31 08:59:17  Waiting for container id bf1775cb3157 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000598660 Strategies:[0xc00057fad0]}
2025/05/31 08:59:26  Container is ready: bf1775cb3157
2025/05/31 08:59:26 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38812/testdb?sslmode=disable
2025/05/31 08:59:26 Starting NATS container with resource limits...
2025/05/31 08:59:26  Creating container for image nats:2.10-alpine
2025/05/31 08:59:26  Container created: f667a1274228
2025/05/31 08:59:26  Starting container: f667a1274228
2025/05/31 08:59:28  Container started: f667a1274228
2025/05/31 08:59:28  Waiting for container id f667a1274228 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000894dd0 Strategies:[0xc0007147e0 0xc0007039b0]}
2025/05/31 08:59:29  Container is ready: f667a1274228
2025/05/31 08:59:29 NATS container started with resource limits. URL: nats://localhost:38821
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:30 Ran leaderboard migrations group #1
Creating user table...
User table created successfully!
2025/05/31 08:59:30 Ran user migrations group #2
Creating round table...
Round table created successfully!
2025/05/31 08:59:30 Ran round migrations group #3
Creating score table...
Score table created successfully!
2025/05/31 08:59:30 Ran score migrations group #4
2025/05/31 08:59:30 All migrations ran successfully
2025/05/31 08:59:30 newDBServiceWithDB - Registering models
2025/05/31 08:59:30 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:30 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0000e42f0 RoundDB:0xc0000e42f8 ScoreDB:0xc0000e4300 LeaderboardDB:0xc0000e4308 db:0xc0003447c0}
2025/05/31 08:59:30 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 08:59:32 Starting lightweight round handler cleanup...
2025/05/31 08:59:32 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEntityCreated/Success_-_Handler_Processes_Minimal_Valid_Message
2025/05/31 08:59:32 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 08:59:34 Starting lightweight round handler cleanup...
2025/05/31 08:59:34 Lightweight cleanup timeout - forcing exit (this is OK for tests)
=== RUN   TestHandleRoundEntityCreated/Success_-_Handler_Processes_Message_with_Complex_Participants
2025/05/31 08:59:35 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 08:59:36 Starting lightweight round handler cleanup...
2025/05/31 08:59:36 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEntityCreated/Success_-_Handler_Processes_Different_Round_States
2025/05/31 08:59:36 Truncating tables: users, scores, leaderboards, rounds
    create_round2_test.go:128: Expected round.created message within 3s
2025/05/31 08:59:40 Starting lightweight round handler cleanup...
2025/05/31 08:59:40 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEntityCreated/Success_-_Handler_Processes_Multiple_Messages_Concurrently
2025/05/31 08:59:40 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 08:59:44 Starting lightweight round handler cleanup...
2025/05/31 08:59:44 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEntityCreated/Failure_-_Handler_Rejects_Invalid_JSON_and_Doesn't_Publish_Events
2025/05/31 08:59:45 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 08:59:47 Starting lightweight round handler cleanup...
2025/05/31 08:59:48 Lightweight cleanup timeout - forcing exit (this is OK for tests)
=== RUN   TestHandleRoundEntityCreated/Success_-_Handler_Preserves_Message_Correlation_ID
2025/05/31 08:59:48 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 08:59:51 Starting lightweight round handler cleanup...
2025/05/31 08:59:51 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEntityCreated/Success_-_Handler_Publishes_Correct_Event_Topic
2025/05/31 08:59:51 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 08:59:53 Starting lightweight round handler cleanup...
2025/05/31 08:59:53 Lightweight cleanup timeout - forcing exit (this is OK for tests)
--- FAIL: TestHandleRoundEntityCreated (36.46s)
    --- PASS: TestHandleRoundEntityCreated/Success_-_Handler_Processes_Valid_Message_and_Publishes_Success_Event (15.29s)
    --- PASS: TestHandleRoundEntityCreated/Success_-_Handler_Processes_Minimal_Valid_Message (2.73s)
    --- PASS: TestHandleRoundEntityCreated/Success_-_Handler_Processes_Message_with_Complex_Participants (1.41s)
    --- FAIL: TestHandleRoundEntityCreated/Success_-_Handler_Processes_Different_Round_States (4.10s)
    --- PASS: TestHandleRoundEntityCreated/Success_-_Handler_Processes_Multiple_Messages_Concurrently (4.45s)
    --- PASS: TestHandleRoundEntityCreated/Failure_-_Handler_Rejects_Invalid_JSON_and_Doesn't_Publish_Events (3.23s)
    --- PASS: TestHandleRoundEntityCreated/Success_-_Handler_Preserves_Message_Correlation_ID (3.25s)
    --- PASS: TestHandleRoundEntityCreated/Success_-_Handler_Publishes_Correct_Event_Topic (1.99s)
=== RUN   TestHandleRoundEventMessageIDUpdate
=== RUN   TestHandleRoundEventMessageIDUpdate/Success_-_Update_Valid_Round_Message_ID
2025/05/31 08:59:53 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 08:59:54 Starting lightweight round handler cleanup...
2025/05/31 08:59:54 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEventMessageIDUpdate/Success_-_Update_Round_Message_ID_with_Long_Discord_ID
2025/05/31 08:59:54 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 08:59:57 Starting lightweight round handler cleanup...
2025/05/31 08:59:57 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEventMessageIDUpdate/Failure_-_Missing_Discord_Message_ID_in_Metadata
2025/05/31 08:59:57 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:00 Starting lightweight round handler cleanup...
2025/05/31 09:00:00 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEventMessageIDUpdate/Failure_-_Empty_Discord_Message_ID_in_Metadata
2025/05/31 09:00:00 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:03 Starting lightweight round handler cleanup...
2025/05/31 09:00:03 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEventMessageIDUpdate/Failure_-_Non-Existent_Round_ID
2025/05/31 09:00:03 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:06 Starting lightweight round handler cleanup...
2025/05/31 09:00:06 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEventMessageIDUpdate/Failure_-_Invalid_JSON_Message
2025/05/31 09:00:06 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:08 Starting lightweight round handler cleanup...
2025/05/31 09:00:09 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEventMessageIDUpdate/Success_-_Handler_Preserves_Message_Correlation_ID
2025/05/31 09:00:09 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:11 Starting lightweight round handler cleanup...
2025/05/31 09:00:11 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundEventMessageIDUpdate/Success_-_Multiple_Message_ID_Updates
2025/05/31 09:00:11 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:12 Starting lightweight round handler cleanup...
2025/05/31 09:00:12 Lightweight cleanup completed successfully
--- PASS: TestHandleRoundEventMessageIDUpdate (19.01s)
    --- PASS: TestHandleRoundEventMessageIDUpdate/Success_-_Update_Valid_Round_Message_ID (0.97s)
    --- PASS: TestHandleRoundEventMessageIDUpdate/Success_-_Update_Round_Message_ID_with_Long_Discord_ID (3.42s)
    --- PASS: TestHandleRoundEventMessageIDUpdate/Failure_-_Missing_Discord_Message_ID_in_Metadata (2.78s)
    --- PASS: TestHandleRoundEventMessageIDUpdate/Failure_-_Empty_Discord_Message_ID_in_Metadata (2.83s)
    --- PASS: TestHandleRoundEventMessageIDUpdate/Failure_-_Non-Existent_Round_ID (2.81s)
    --- PASS: TestHandleRoundEventMessageIDUpdate/Failure_-_Invalid_JSON_Message (2.86s)
    --- PASS: TestHandleRoundEventMessageIDUpdate/Success_-_Handler_Preserves_Message_Correlation_ID (2.23s)
    --- PASS: TestHandleRoundEventMessageIDUpdate/Success_-_Multiple_Message_ID_Updates (1.12s)
=== RUN   TestHandleCreateRoundRequest
=== RUN   TestHandleCreateRoundRequest/Success_-_Create_Valid_Round
2025/05/31 09:00:12 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:13 INFO Timezone override user_timezone=UTC
2025/05/31 09:00:13 INFO Parsed time using when parsed_time=2025-06-01T15:00:00Z
2025/05/31 09:00:13 Starting lightweight round handler cleanup...
2025/05/31 09:00:13 Lightweight cleanup completed successfully
=== RUN   TestHandleCreateRoundRequest/Success_-_Create_Round_with_Minimal_Information
2025/05/31 09:00:13 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:15 INFO Timezone override user_timezone=UTC
2025/05/31 09:00:15 INFO Parsed time using when parsed_time=2025-06-01T15:00:00Z
2025/05/31 09:00:15 Starting lightweight round handler cleanup...
2025/05/31 09:00:15 Lightweight cleanup completed successfully
=== RUN   TestHandleCreateRoundRequest/Failure_-_Empty_Description
2025/05/31 09:00:15 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:17 Starting lightweight round handler cleanup...
2025/05/31 09:00:17 Lightweight cleanup completed successfully
=== RUN   TestHandleCreateRoundRequest/Failure_-_Invalid_Time_Format
2025/05/31 09:00:17 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:18 INFO Timezone override user_timezone=UTC
2025/05/31 09:00:18 WARN `when` failed to parse input, falling back to manual parsing input=not-a-valid-time
2025/05/31 09:00:18 Starting lightweight round handler cleanup...
2025/05/31 09:00:18 Lightweight cleanup completed successfully
=== RUN   TestHandleCreateRoundRequest/Failure_-_Past_Start_Time
2025/05/31 09:00:18 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:19 INFO Timezone override user_timezone=UTC
2025/05/31 09:00:19 INFO Parsed time using when parsed_time=2025-05-30T15:00:00Z
2025/05/31 09:00:19 Starting lightweight round handler cleanup...
2025/05/31 09:00:19 Lightweight cleanup completed successfully
=== RUN   TestHandleCreateRoundRequest/Failure_-_Empty_Title
2025/05/31 09:00:19 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:21 Starting lightweight round handler cleanup...
2025/05/31 09:00:21 Lightweight cleanup completed successfully
=== RUN   TestHandleCreateRoundRequest/Failure_-_Empty_Location
2025/05/31 09:00:21 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:23 Starting lightweight round handler cleanup...
2025/05/31 09:00:23 Lightweight cleanup completed successfully
=== RUN   TestHandleCreateRoundRequest/Failure_-_Invalid_JSON_Message
2025/05/31 09:00:23 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:24 Starting lightweight round handler cleanup...
2025/05/31 09:00:24 Lightweight cleanup completed successfully
=== RUN   TestHandleCreateRoundRequest/Failure_-_Missing_Required_Fields
2025/05/31 09:00:24 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:26 Starting lightweight round handler cleanup...
2025/05/31 09:00:27 Lightweight cleanup completed successfully
--- PASS: TestHandleCreateRoundRequest (14.64s)
    --- PASS: TestHandleCreateRoundRequest/Success_-_Create_Valid_Round (0.84s)
    --- PASS: TestHandleCreateRoundRequest/Success_-_Create_Round_with_Minimal_Information (2.38s)
    --- PASS: TestHandleCreateRoundRequest/Failure_-_Empty_Description (1.71s)
    --- PASS: TestHandleCreateRoundRequest/Failure_-_Invalid_Time_Format (1.06s)
    --- PASS: TestHandleCreateRoundRequest/Failure_-_Past_Start_Time (1.53s)
    --- PASS: TestHandleCreateRoundRequest/Failure_-_Empty_Title (1.58s)
    --- PASS: TestHandleCreateRoundRequest/Failure_-_Empty_Location (1.66s)
    --- PASS: TestHandleCreateRoundRequest/Failure_-_Invalid_JSON_Message (1.58s)
    --- PASS: TestHandleCreateRoundRequest/Failure_-_Missing_Required_Fields (2.31s)
=== RUN   TestHandleRoundDeleteRequest
=== RUN   TestHandleRoundDeleteRequest/Success_-_Valid_Delete_Request
2025/05/31 09:00:27 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:28 INFO round deleted from DB
2025/05/31 09:00:28 Starting lightweight round handler cleanup...
2025/05/31 09:00:28 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundDeleteRequest/Failure_-_Nil_Round_ID
2025/05/31 09:00:29 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:29 Starting lightweight round handler cleanup...
2025/05/31 09:00:29 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundDeleteRequest/Failure_-_Non-Existent_Round_ID
2025/05/31 09:00:30 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:32 Starting lightweight round handler cleanup...
2025/05/31 09:00:32 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundDeleteRequest/Failure_-_Unauthorized_User
2025/05/31 09:00:32 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:33 Starting lightweight round handler cleanup...
2025/05/31 09:00:33 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundDeleteRequest/Failure_-_Invalid_JSON_Message
2025/05/31 09:00:33 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:34 Starting lightweight round handler cleanup...
2025/05/31 09:00:34 Lightweight cleanup completed successfully
--- PASS: TestHandleRoundDeleteRequest (7.73s)
    --- PASS: TestHandleRoundDeleteRequest/Success_-_Valid_Delete_Request (1.90s)
    --- PASS: TestHandleRoundDeleteRequest/Failure_-_Nil_Round_ID (1.03s)
    --- PASS: TestHandleRoundDeleteRequest/Failure_-_Non-Existent_Round_ID (2.57s)
    --- PASS: TestHandleRoundDeleteRequest/Failure_-_Unauthorized_User (1.30s)
    --- PASS: TestHandleRoundDeleteRequest/Failure_-_Invalid_JSON_Message (0.94s)
=== RUN   TestHandleRoundDeleteAuthorized
=== RUN   TestHandleRoundDeleteAuthorized/Success_-_Delete_Existing_Round
2025/05/31 09:00:34 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:36 INFO round deleted from DB
2025/05/31 09:00:37 Starting lightweight round handler cleanup...
2025/05/31 09:00:37 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundDeleteAuthorized/Failure_-_Non-Existent_Round_ID
2025/05/31 09:00:37 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:38 Starting lightweight round handler cleanup...
2025/05/31 09:00:38 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundDeleteAuthorized/Failure_-_Invalid_JSON_Message
2025/05/31 09:00:38 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:39 Starting lightweight round handler cleanup...
2025/05/31 09:00:39 Lightweight cleanup completed successfully
--- PASS: TestHandleRoundDeleteAuthorized (5.03s)
    --- PASS: TestHandleRoundDeleteAuthorized/Success_-_Delete_Existing_Round (2.42s)
    --- PASS: TestHandleRoundDeleteAuthorized/Failure_-_Non-Existent_Round_ID (1.64s)
    --- PASS: TestHandleRoundDeleteAuthorized/Failure_-_Invalid_JSON_Message (0.96s)
=== RUN   TestHandleAllScoresSubmitted
=== RUN   TestHandleAllScoresSubmitted/Success_-_Valid_All_Scores_Submitted
2025/05/31 09:00:39 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:41 Starting lightweight round handler cleanup...
2025/05/31 09:00:41 Lightweight cleanup completed successfully
=== RUN   TestHandleAllScoresSubmitted/Failure_-_Non-Existent_Round_ID
2025/05/31 09:00:41 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:43 Starting lightweight round handler cleanup...
2025/05/31 09:00:43 Lightweight cleanup completed successfully
=== RUN   TestHandleAllScoresSubmitted/Failure_-_Invalid_JSON_Message
2025/05/31 09:00:43 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:44 Starting lightweight round handler cleanup...
2025/05/31 09:00:44 Lightweight cleanup completed successfully
--- PASS: TestHandleAllScoresSubmitted (5.06s)
    --- PASS: TestHandleAllScoresSubmitted/Success_-_Valid_All_Scores_Submitted (1.93s)
    --- PASS: TestHandleAllScoresSubmitted/Failure_-_Non-Existent_Round_ID (2.19s)
    --- PASS: TestHandleAllScoresSubmitted/Failure_-_Invalid_JSON_Message (0.94s)
=== RUN   TestHandleRoundFinalized
=== RUN   TestHandleRoundFinalized/Success_-_Valid_Round_Finalized
2025/05/31 09:00:44 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:46 Starting lightweight round handler cleanup...
2025/05/31 09:00:46 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundFinalized/Failure_-_Non-Existent_Round_ID
2025/05/31 09:00:46 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:48 Starting lightweight round handler cleanup...
2025/05/31 09:00:48 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundFinalized/Failure_-_Invalid_JSON_Message
2025/05/31 09:00:48 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:49 Starting lightweight round handler cleanup...
2025/05/31 09:00:49 Lightweight cleanup completed successfully
--- PASS: TestHandleRoundFinalized (5.05s)
    --- PASS: TestHandleRoundFinalized/Success_-_Valid_Round_Finalized (1.31s)
    --- PASS: TestHandleRoundFinalized/Failure_-_Non-Existent_Round_ID (2.70s)
    --- PASS: TestHandleRoundFinalized/Failure_-_Invalid_JSON_Message (1.04s)
=== RUN   TestHandleParticipantJoinValidationRequest
=== RUN   TestHandleParticipantJoinValidationRequest/Success_-_Accept_Response_for_Scheduled_Round
2025/05/31 09:00:49 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:52 Starting lightweight round handler cleanup...
2025/05/31 09:00:52 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinValidationRequest/Success_-_Accept_Response_for_InProgress_Round_(Late_Join)
2025/05/31 09:00:52 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:53 Starting lightweight round handler cleanup...
2025/05/31 09:00:53 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinValidationRequest/Success_-_Decline_Response_for_Scheduled_Round
2025/05/31 09:00:53 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=650887432, Response=DECLINE, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{650887432 <nil> DECLINE <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:00:57 Starting lightweight round handler cleanup...
2025/05/31 09:00:57 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinValidationRequest/Failure_-_Round_Not_Found
2025/05/31 09:00:57 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:00:59 Starting lightweight round handler cleanup...
2025/05/31 09:00:59 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinValidationRequest/Failure_-_Empty_User_ID
2025/05/31 09:01:00 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:03 Starting lightweight round handler cleanup...
2025/05/31 09:01:03 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinValidationRequest/Failure_-_Invalid_JSON_Message
2025/05/31 09:01:03 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:06 Starting lightweight round handler cleanup...
2025/05/31 09:01:06 Lightweight cleanup completed successfully
--- PASS: TestHandleParticipantJoinValidationRequest (16.40s)
    --- PASS: TestHandleParticipantJoinValidationRequest/Success_-_Accept_Response_for_Scheduled_Round (2.31s)
    --- PASS: TestHandleParticipantJoinValidationRequest/Success_-_Accept_Response_for_InProgress_Round_(Late_Join) (1.70s)
    --- PASS: TestHandleParticipantJoinValidationRequest/Success_-_Decline_Response_for_Scheduled_Round (3.43s)
    --- PASS: TestHandleParticipantJoinValidationRequest/Failure_-_Round_Not_Found (2.55s)
    --- PASS: TestHandleParticipantJoinValidationRequest/Failure_-_Empty_User_ID (3.91s)
    --- PASS: TestHandleParticipantJoinValidationRequest/Failure_-_Invalid_JSON_Message (2.51s)
=== RUN   TestHandleParticipantStatusUpdateRequest
=== RUN   TestHandleParticipantStatusUpdateRequest/Success_-_Accept_Response_with_Tag_Number
2025/05/31 09:01:06 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=215837061, Response=ACCEPT, TagNumber=42, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{215837061 42 ACCEPT <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:09 Starting lightweight round handler cleanup...
2025/05/31 09:01:09 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantStatusUpdateRequest/Success_-_Decline_Response
2025/05/31 09:01:09 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=215837061, Response=DECLINE, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{215837061 <nil> DECLINE <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:12 Starting lightweight round handler cleanup...
2025/05/31 09:01:12 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantStatusUpdateRequest/Success_-_Tentative_Response_with_Late_Join
2025/05/31 09:01:12 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=215837061, Response=TENTATIVE, TagNumber=99, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{215837061 99 TENTATIVE <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:15 Starting lightweight round handler cleanup...
2025/05/31 09:01:15 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantStatusUpdateRequest/Success_-_Accept_Response_without_Tag_Number
2025/05/31 09:01:15 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=215837061, Response=ACCEPT, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{215837061 <nil> ACCEPT <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:18 Starting lightweight round handler cleanup...
2025/05/31 09:01:18 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantStatusUpdateRequest/Failure_-_Round_Not_Found
2025/05/31 09:01:18 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:20 Starting lightweight round handler cleanup...
2025/05/31 09:01:20 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantStatusUpdateRequest/Failure_-_Invalid_JSON_Message
2025/05/31 09:01:21 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:23 Starting lightweight round handler cleanup...
2025/05/31 09:01:23 Lightweight cleanup completed successfully
--- PASS: TestHandleParticipantStatusUpdateRequest (17.08s)
    --- PASS: TestHandleParticipantStatusUpdateRequest/Success_-_Accept_Response_with_Tag_Number (3.11s)
    --- PASS: TestHandleParticipantStatusUpdateRequest/Success_-_Decline_Response (2.70s)
    --- PASS: TestHandleParticipantStatusUpdateRequest/Success_-_Tentative_Response_with_Late_Join (3.34s)
    --- PASS: TestHandleParticipantStatusUpdateRequest/Success_-_Accept_Response_without_Tag_Number (2.95s)
    --- PASS: TestHandleParticipantStatusUpdateRequest/Failure_-_Round_Not_Found (2.58s)
    --- PASS: TestHandleParticipantStatusUpdateRequest/Failure_-_Invalid_JSON_Message (2.39s)
=== RUN   TestHandleParticipantRemovalRequest
=== RUN   TestHandleParticipantRemovalRequest/Success_-_Remove_Existing_Accepted_Participant
2025/05/31 09:01:23 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:25 Starting lightweight round handler cleanup...
2025/05/31 09:01:26 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantRemovalRequest/Success_-_Remove_Existing_Tentative_Participant
2025/05/31 09:01:26 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:28 Starting lightweight round handler cleanup...
2025/05/31 09:01:29 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantRemovalRequest/Success_-_Remove_Existing_Declined_Participant
2025/05/31 09:01:29 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:31 Starting lightweight round handler cleanup...
2025/05/31 09:01:31 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantRemovalRequest/Failure_-_Round_Not_Found
2025/05/31 09:01:32 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:33 Starting lightweight round handler cleanup...
2025/05/31 09:01:33 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantRemovalRequest/Failure_-_Invalid_JSON_Message
2025/05/31 09:01:34 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:36 Starting lightweight round handler cleanup...
2025/05/31 09:01:36 Lightweight cleanup completed successfully
--- PASS: TestHandleParticipantRemovalRequest (13.11s)
    --- PASS: TestHandleParticipantRemovalRequest/Success_-_Remove_Existing_Accepted_Participant (2.64s)
    --- PASS: TestHandleParticipantRemovalRequest/Success_-_Remove_Existing_Tentative_Participant (3.05s)
    --- PASS: TestHandleParticipantRemovalRequest/Success_-_Remove_Existing_Declined_Participant (2.82s)
    --- PASS: TestHandleParticipantRemovalRequest/Failure_-_Round_Not_Found (2.11s)
    --- PASS: TestHandleParticipantRemovalRequest/Failure_-_Invalid_JSON_Message (2.49s)
=== RUN   TestHandleTagNumberFound
=== RUN   TestHandleTagNumberFound/Success_-_Accept_Response_with_Tag_Found
2025/05/31 09:01:36 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=632157076, Response=ACCEPT, TagNumber=42, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{632157076 42 ACCEPT <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:38 Starting lightweight round handler cleanup...
2025/05/31 09:01:38 Lightweight cleanup completed successfully
=== RUN   TestHandleTagNumberFound/Success_-_Tentative_Response_with_Tag_Found
2025/05/31 09:01:38 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=632157076, Response=TENTATIVE, TagNumber=99, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{632157076 99 TENTATIVE <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:41 Starting lightweight round handler cleanup...
2025/05/31 09:01:41 Lightweight cleanup completed successfully
=== RUN   TestHandleTagNumberFound/Success_-_Accept_Response_with_Late_Join
2025/05/31 09:01:41 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=632157076, Response=ACCEPT, TagNumber=77, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{632157076 77 ACCEPT <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:43 Starting lightweight round handler cleanup...
2025/05/31 09:01:43 Lightweight cleanup completed successfully
=== RUN   TestHandleTagNumberFound/Failure_-_Round_Not_Found_(Tag_Found)
2025/05/31 09:01:43 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:45 Starting lightweight round handler cleanup...
2025/05/31 09:01:45 Lightweight cleanup completed successfully
--- PASS: TestHandleTagNumberFound (8.83s)
    --- PASS: TestHandleTagNumberFound/Success_-_Accept_Response_with_Tag_Found (2.21s)
    --- PASS: TestHandleTagNumberFound/Success_-_Tentative_Response_with_Tag_Found (2.86s)
    --- PASS: TestHandleTagNumberFound/Success_-_Accept_Response_with_Late_Join (1.87s)
    --- PASS: TestHandleTagNumberFound/Failure_-_Round_Not_Found_(Tag_Found) (1.88s)
=== RUN   TestHandleTagNumberNotFound
=== RUN   TestHandleTagNumberNotFound/Success_-_Accept_Response_with_No_Tag_(Still_Allows_Join)
2025/05/31 09:01:45 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=591532392, Response=ACCEPT, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{591532392 <nil> ACCEPT <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:47 Starting lightweight round handler cleanup...
2025/05/31 09:01:47 Lightweight cleanup completed successfully
=== RUN   TestHandleTagNumberNotFound/Success_-_Tentative_Response_with_No_Tag
2025/05/31 09:01:47 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=591532392, Response=TENTATIVE, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{591532392 <nil> TENTATIVE <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:49 Starting lightweight round handler cleanup...
2025/05/31 09:01:49 Lightweight cleanup completed successfully
=== RUN   TestHandleTagNumberNotFound/Success_-_Accept_Response_with_Late_Join_and_No_Tag
2025/05/31 09:01:49 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=591532392, Response=ACCEPT, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{591532392 <nil> ACCEPT <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:01:51 Starting lightweight round handler cleanup...
2025/05/31 09:01:51 Lightweight cleanup completed successfully
=== RUN   TestHandleTagNumberNotFound/Failure_-_Round_Not_Found_(Tag_Not_Found)
2025/05/31 09:01:51 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:54 Starting lightweight round handler cleanup...
2025/05/31 09:01:54 Lightweight cleanup completed successfully
--- PASS: TestHandleTagNumberNotFound (8.97s)
    --- PASS: TestHandleTagNumberNotFound/Success_-_Accept_Response_with_No_Tag_(Still_Allows_Join) (2.10s)
    --- PASS: TestHandleTagNumberNotFound/Success_-_Tentative_Response_with_No_Tag (2.39s)
    --- PASS: TestHandleTagNumberNotFound/Success_-_Accept_Response_with_Late_Join_and_No_Tag (1.99s)
    --- PASS: TestHandleTagNumberNotFound/Failure_-_Round_Not_Found_(Tag_Not_Found) (2.49s)
=== RUN   TestHandleTagLookupInvalidMessages
=== RUN   TestHandleTagLookupInvalidMessages/Invalid_JSON_-_Tag_Found_Handler
2025/05/31 09:01:54 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:56 Starting lightweight round handler cleanup...
2025/05/31 09:01:56 Lightweight cleanup completed successfully
=== RUN   TestHandleTagLookupInvalidMessages/Invalid_JSON_-_Tag_Not_Found_Handler
2025/05/31 09:01:56 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:01:59 Starting lightweight round handler cleanup...
2025/05/31 09:01:59 Lightweight cleanup completed successfully
--- PASS: TestHandleTagLookupInvalidMessages (4.90s)
    --- PASS: TestHandleTagLookupInvalidMessages/Invalid_JSON_-_Tag_Found_Handler (2.50s)
    --- PASS: TestHandleTagLookupInvalidMessages/Invalid_JSON_-_Tag_Not_Found_Handler (2.40s)
=== RUN   TestHandleParticipantDeclined
=== RUN   TestHandleParticipantDeclined/Success_-_Participant_Declined_(Upcoming_Round)
2025/05/31 09:01:59 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=474566630, Response=DECLINE, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{474566630 <nil> DECLINE <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:02:02 Starting lightweight round handler cleanup...
2025/05/31 09:02:02 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantDeclined/Success_-_Participant_Declined_(In_Progress_Round)
2025/05/31 09:02:02 Truncating tables: users, scores, leaderboards, rounds
>>> Adding new participant: UserID=474566630, Response=DECLINE, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{474566630 <nil> DECLINE <nil>}]
>>> Update successful. Final participants count: 1
2025/05/31 09:02:05 Starting lightweight round handler cleanup...
2025/05/31 09:02:06 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantDeclined/Failure_-_Round_Not_Found_(Participant_Declined)
2025/05/31 09:02:06 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:02:08 Starting lightweight round handler cleanup...
2025/05/31 09:02:08 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantDeclined/Invalid_JSON_-_Participant_Declined_Handler
2025/05/31 09:02:08 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:02:11 Starting lightweight round handler cleanup...
2025/05/31 09:02:11 Lightweight cleanup completed successfully
--- PASS: TestHandleParticipantDeclined (11.95s)
    --- PASS: TestHandleParticipantDeclined/Success_-_Participant_Declined_(Upcoming_Round) (3.31s)
    --- PASS: TestHandleParticipantDeclined/Success_-_Participant_Declined_(In_Progress_Round) (3.57s)
    --- PASS: TestHandleParticipantDeclined/Failure_-_Round_Not_Found_(Participant_Declined) (2.63s)
    --- PASS: TestHandleParticipantDeclined/Invalid_JSON_-_Participant_Declined_Handler (2.43s)
=== RUN   TestHandleParticipantJoinRequest
=== RUN   TestHandleParticipantJoinRequest/Success_-_New_Join_Request_(Accept)
2025/05/31 09:02:11 Truncating tables: users, scores, leaderboards, rounds
    participant_status_test.go:137: Starting test case: Success - New Join Request (Accept)
    participant_status_test.go:143: Waiting for message processing and capture...
    participant_status_test.go:152: Messages captured: validation=1, removal=0, error=0
2025/05/31 09:02:16 Starting lightweight round handler cleanup...
2025/05/31 09:02:16 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinRequest/Success_-_New_Join_Request_(Tentative)
2025/05/31 09:02:16 Truncating tables: users, scores, leaderboards, rounds
    participant_status_test.go:137: Starting test case: Success - New Join Request (Tentative)
    participant_status_test.go:143: Waiting for message processing and capture...
    participant_status_test.go:152: Messages captured: validation=1, removal=0, error=0
2025/05/31 09:02:21 Starting lightweight round handler cleanup...
2025/05/31 09:02:22 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinRequest/Success_-_New_Join_Request_(Decline)
2025/05/31 09:02:22 Truncating tables: users, scores, leaderboards, rounds
    participant_status_test.go:137: Starting test case: Success - New Join Request (Decline)
    participant_status_test.go:143: Waiting for message processing and capture...
>>> Adding new participant: UserID=868178094, Response=DECLINE, TagNumber=<nil>, Score=<nil>
>>> After update: ParticipantsCount=1, Participants=[{868178094 <nil> DECLINE <nil>}]
>>> Update successful. Final participants count: 1
    participant_status_test.go:152: Messages captured: validation=1, removal=0, error=0
2025/05/31 09:02:27 Starting lightweight round handler cleanup...
2025/05/31 09:02:27 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinRequest/Success_-_Toggle_Removal_(Accept_to_Accept)
2025/05/31 09:02:27 Truncating tables: users, scores, leaderboards, rounds
    participant_status_test.go:137: Starting test case: Success - Toggle Removal (Accept to Accept)
    participant_status_test.go:143: Waiting for message processing and capture...
    participant_status_test.go:152: Messages captured: validation=0, removal=1, error=0
2025/05/31 09:02:32 Starting lightweight round handler cleanup...
2025/05/31 09:02:32 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinRequest/Success_-_Toggle_Removal_(Decline_to_Decline)
2025/05/31 09:02:32 Truncating tables: users, scores, leaderboards, rounds
    participant_status_test.go:137: Starting test case: Success - Toggle Removal (Decline to Decline)
    participant_status_test.go:143: Waiting for message processing and capture...
    participant_status_test.go:152: Messages captured: validation=0, removal=1, error=0
2025/05/31 09:02:38 Starting lightweight round handler cleanup...
2025/05/31 09:02:38 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinRequest/Success_-_Status_Change_(Accept_to_Decline)
2025/05/31 09:02:38 Truncating tables: users, scores, leaderboards, rounds
    participant_status_test.go:137: Starting test case: Success - Status Change (Accept to Decline)
    participant_status_test.go:143: Waiting for message processing and capture...
>>> Found existing participant 805346005 at index 0, updating...
>>> Updating response for user 805346005: Old=ACCEPT, New=DECLINE
>>> Updating tag number for user 805346005: Old=16, New=<nil>
>>> After update: ParticipantsCount=1, Participants=[{805346005 <nil> DECLINE <nil>}]
>>> Update successful. Final participants count: 1
    participant_status_test.go:152: Messages captured: validation=1, removal=0, error=0
2025/05/31 09:02:43 Starting lightweight round handler cleanup...
2025/05/31 09:02:43 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinRequest/Success_-_Status_Change_(Decline_to_Accept)
2025/05/31 09:02:43 Truncating tables: users, scores, leaderboards, rounds
    participant_status_test.go:137: Starting test case: Success - Status Change (Decline to Accept)
    participant_status_test.go:143: Waiting for message processing and capture...
    participant_status_test.go:152: Messages captured: validation=1, removal=0, error=0
2025/05/31 09:02:49 Starting lightweight round handler cleanup...
2025/05/31 09:02:49 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantJoinRequest/Failure_-_Non-Existent_Round_ID
2025/05/31 09:02:49 Truncating tables: users, scores, leaderboards, rounds
    participant_status_test.go:137: Starting test case: Failure - Non-Existent Round ID
    participant_status_test.go:143: Waiting for message processing and capture...
    participant_status_test.go:152: Messages captured: validation=0, removal=0, error=1
2025/05/31 09:02:54 Starting lightweight round handler cleanup...
2025/05/31 09:02:54 Lightweight cleanup completed successfully
--- PASS: TestHandleParticipantJoinRequest (43.59s)
    --- PASS: TestHandleParticipantJoinRequest/Success_-_New_Join_Request_(Accept) (5.39s)
    --- PASS: TestHandleParticipantJoinRequest/Success_-_New_Join_Request_(Tentative) (5.57s)
    --- PASS: TestHandleParticipantJoinRequest/Success_-_New_Join_Request_(Decline) (5.43s)
    --- PASS: TestHandleParticipantJoinRequest/Success_-_Toggle_Removal_(Accept_to_Accept) (5.37s)
    --- PASS: TestHandleParticipantJoinRequest/Success_-_Toggle_Removal_(Decline_to_Decline) (5.42s)
    --- PASS: TestHandleParticipantJoinRequest/Success_-_Status_Change_(Accept_to_Decline) (5.48s)
    --- PASS: TestHandleParticipantJoinRequest/Success_-_Status_Change_(Decline_to_Accept) (5.49s)
    --- PASS: TestHandleParticipantJoinRequest/Failure_-_Non-Existent_Round_ID (5.44s)
=== RUN   TestHandleScheduledRoundTagUpdate
=== RUN   TestHandleScheduledRoundTagUpdate/Success_-_Tag_Update_for_Single_Round_with_Multiple_Participants
2025/05/31 09:02:54 Truncating tables: users, scores, leaderboards, rounds
    participant_tags_test.go:37: Created upcoming round 662d681e-f554-4426-90e2-fed69c480242 with participant 192927826 (tag: 10)
    participant_tags_test.go:38: Created upcoming round 726b3da7-e6d9-4554-b7bd-6cbb7181fcf1 with participant 325613745 (tag: 20)
    participant_tags_test.go:39: Created upcoming round a5290dbc-ee46-4bd0-ace2-161fa273e2af with participant 436513762 (tag: <nil>)
    participant_tags_test.go:42: Created rounds: 662d681e-f554-4426-90e2-fed69c480242, 726b3da7-e6d9-4554-b7bd-6cbb7181fcf1, a5290dbc-ee46-4bd0-ace2-161fa273e2af
    participant_tags_test.go:43: User1: 192927826 (tag 10), User2: 325613745 (tag 20), User3: 436513762 (no tag)
    participant_tags_test.go:55: Changing tags for: User1 192927826 -> 42, User2 325613745 -> 99
    participant_tags_test.go:278: Tag update success: 2 rounds, 2 participants
2025/05/31 09:02:57 Starting lightweight round handler cleanup...
2025/05/31 09:02:57 Lightweight cleanup completed successfully
=== RUN   TestHandleScheduledRoundTagUpdate/Success_-_Tag_Update_for_Multiple_Rounds_with_Same_Participant
2025/05/31 09:02:57 Truncating tables: users, scores, leaderboards, rounds
    participant_tags_test.go:278: Tag update success: 1 rounds, 1 participants
2025/05/31 09:03:01 Starting lightweight round handler cleanup...
2025/05/31 09:03:01 Lightweight cleanup completed successfully
=== RUN   TestHandleScheduledRoundTagUpdate/Success_-_Empty_Tag_Update_(No_Upcoming_Rounds_with_Matching_Participants)
2025/05/31 09:03:01 Truncating tables: users, scores, leaderboards, rounds
    participant_tags_test.go:278: Tag update success: 0 rounds, 0 participants
2025/05/31 09:03:03 Starting lightweight round handler cleanup...
2025/05/31 09:03:03 Lightweight cleanup completed successfully
=== RUN   TestHandleScheduledRoundTagUpdate/Success_-_Tag_Update_Only_Affects_Upcoming_Rounds
2025/05/31 09:03:03 Truncating tables: users, scores, leaderboards, rounds
    participant_tags_test.go:278: Tag update success: 0 rounds, 0 participants
2025/05/31 09:03:05 Starting lightweight round handler cleanup...
2025/05/31 09:03:05 Lightweight cleanup completed successfully
=== RUN   TestHandleScheduledRoundTagUpdate/Invalid_JSON_-_Scheduled_Round_Tag_Update_Handler
2025/05/31 09:03:05 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:07 Starting lightweight round handler cleanup...
2025/05/31 09:03:08 Lightweight cleanup completed successfully
--- PASS: TestHandleScheduledRoundTagUpdate (13.38s)
    --- PASS: TestHandleScheduledRoundTagUpdate/Success_-_Tag_Update_for_Single_Round_with_Multiple_Participants (3.18s)
    --- PASS: TestHandleScheduledRoundTagUpdate/Success_-_Tag_Update_for_Multiple_Rounds_with_Same_Participant (3.49s)
    --- PASS: TestHandleScheduledRoundTagUpdate/Success_-_Empty_Tag_Update_(No_Upcoming_Rounds_with_Matching_Participants) (2.20s)
    --- PASS: TestHandleScheduledRoundTagUpdate/Success_-_Tag_Update_Only_Affects_Upcoming_Rounds (2.11s)
    --- PASS: TestHandleScheduledRoundTagUpdate/Invalid_JSON_-_Scheduled_Round_Tag_Update_Handler (2.41s)
=== RUN   TestHandleRoundReminder
=== RUN   TestHandleRoundReminder/Success_-_Process_Round_Reminder_for_Upcoming_Round_with_Participants
2025/05/31 09:03:08 Truncating tables: users, scores, leaderboards, rounds
    round_reminder_test.go:33: Created upcoming round 47e69541-bd31-40a5-97f1-b7794312a3c0 with participant 683619090 (tag: 1)
    round_reminder_test.go:237: Reminder processed successfully for round: 47e69541-bd31-40a5-97f1-b7794312a3c0
2025/05/31 09:03:10 Starting lightweight round handler cleanup...
2025/05/31 09:03:10 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundReminder/Success_-_Process_Round_Reminder_with_No_Participants
2025/05/31 09:03:10 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:12 Starting lightweight round handler cleanup...
2025/05/31 09:03:12 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundReminder/Success_-_Process_Round_Reminder_with_Empty_User_List
2025/05/31 09:03:12 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:14 Starting lightweight round handler cleanup...
2025/05/31 09:03:14 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundReminder/Failure_-_Process_Reminder_for_Non-Existent_Round
2025/05/31 09:03:14 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:17 Starting lightweight round handler cleanup...
2025/05/31 09:03:17 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundReminder/Failure_-_Invalid_JSON_Message
2025/05/31 09:03:17 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:19 Starting lightweight round handler cleanup...
2025/05/31 09:03:19 Lightweight cleanup completed successfully
--- PASS: TestHandleRoundReminder (11.51s)
    --- PASS: TestHandleRoundReminder/Success_-_Process_Round_Reminder_for_Upcoming_Round_with_Participants (2.59s)
    --- PASS: TestHandleRoundReminder/Success_-_Process_Round_Reminder_with_No_Participants (1.99s)
    --- PASS: TestHandleRoundReminder/Success_-_Process_Round_Reminder_with_Empty_User_List (2.01s)
    --- PASS: TestHandleRoundReminder/Failure_-_Process_Reminder_for_Non-Existent_Round (3.01s)
    --- PASS: TestHandleRoundReminder/Failure_-_Invalid_JSON_Message (1.90s)
=== RUN   TestHandleGetRoundRequest
=== RUN   TestHandleGetRoundRequest/Success_-_Retrieve_Existing_Round
2025/05/31 09:03:19 Truncating tables: users, scores, leaderboards, rounds
    round_retrieval_test.go:269: Round retrieved successfully: ef7a3333-6385-4b80-8672-6dde9d3a6775
2025/05/31 09:03:22 Starting lightweight round handler cleanup...
2025/05/31 09:03:22 Lightweight cleanup completed successfully
=== RUN   TestHandleGetRoundRequest/Success_-_Retrieve_Round_with_Participants
2025/05/31 09:03:22 Truncating tables: users, scores, leaderboards, rounds
    round_retrieval_test.go:56: Created upcoming round 458dc52f-4197-43e5-b2b1-2df75986ea20 with participant 832928556 (tag: 1)
    round_retrieval_test.go:269: Round retrieved successfully: 458dc52f-4197-43e5-b2b1-2df75986ea20
2025/05/31 09:03:24 Starting lightweight round handler cleanup...
2025/05/31 09:03:24 Lightweight cleanup completed successfully
=== RUN   TestHandleGetRoundRequest/Success_-_Retrieve_In-Progress_Round
2025/05/31 09:03:24 Truncating tables: users, scores, leaderboards, rounds
    round_retrieval_test.go:269: Round retrieved successfully: 7d23a686-d79a-4905-952f-0f371230a494
2025/05/31 09:03:28 Starting lightweight round handler cleanup...
2025/05/31 09:03:28 Lightweight cleanup completed successfully
=== RUN   TestHandleGetRoundRequest/Success_-_Retrieve_Completed_Round
2025/05/31 09:03:28 Truncating tables: users, scores, leaderboards, rounds
    round_retrieval_test.go:269: Round retrieved successfully: 1cbd1f1e-9310-4380-9b42-00fcc040fe66
2025/05/31 09:03:30 Starting lightweight round handler cleanup...
2025/05/31 09:03:30 Lightweight cleanup completed successfully
=== RUN   TestHandleGetRoundRequest/Failure_-_Retrieve_Non-Existent_Round
2025/05/31 09:03:30 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:33 Starting lightweight round handler cleanup...
2025/05/31 09:03:33 Lightweight cleanup completed successfully
=== RUN   TestHandleGetRoundRequest/Failure_-_Invalid_JSON_Message
2025/05/31 09:03:33 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:35 Starting lightweight round handler cleanup...
2025/05/31 09:03:35 Lightweight cleanup completed successfully
--- PASS: TestHandleGetRoundRequest (15.55s)
    --- PASS: TestHandleGetRoundRequest/Success_-_Retrieve_Existing_Round (2.68s)
    --- PASS: TestHandleGetRoundRequest/Success_-_Retrieve_Round_with_Participants (2.59s)
    --- PASS: TestHandleGetRoundRequest/Success_-_Retrieve_In-Progress_Round (3.81s)
    --- PASS: TestHandleGetRoundRequest/Success_-_Retrieve_Completed_Round (1.91s)
    --- PASS: TestHandleGetRoundRequest/Failure_-_Retrieve_Non-Existent_Round (2.59s)
    --- PASS: TestHandleGetRoundRequest/Failure_-_Invalid_JSON_Message (1.97s)
=== RUN   TestHandleDiscordMessageIDUpdated
=== RUN   TestHandleDiscordMessageIDUpdated/Success_-_Schedule_Events_for_Future_Round
2025/05/31 09:03:35 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:37 Starting lightweight round handler cleanup...
2025/05/31 09:03:37 Lightweight cleanup completed successfully
=== RUN   TestHandleDiscordMessageIDUpdated/Success_-_Schedule_Events_for_Round_Less_Than_1_Hour_Away
2025/05/31 09:03:37 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:39 Starting lightweight round handler cleanup...
2025/05/31 09:03:39 Lightweight cleanup completed successfully
=== RUN   TestHandleDiscordMessageIDUpdated/Success_-_Schedule_Events_for_Round_Far_in_Future
2025/05/31 09:03:39 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:41 Starting lightweight round handler cleanup...
2025/05/31 09:03:41 Lightweight cleanup completed successfully
=== RUN   TestHandleDiscordMessageIDUpdated/Success_-_Handle_Round_with_Past_Start_Time
2025/05/31 09:03:41 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:43 Starting lightweight round handler cleanup...
2025/05/31 09:03:43 Lightweight cleanup completed successfully
=== RUN   TestHandleDiscordMessageIDUpdated/Failure_-_Invalid_JSON_Message
2025/05/31 09:03:43 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:03:45 Starting lightweight round handler cleanup...
2025/05/31 09:03:45 Lightweight cleanup completed successfully
--- PASS: TestHandleDiscordMessageIDUpdated (10.34s)
    --- PASS: TestHandleDiscordMessageIDUpdated/Success_-_Schedule_Events_for_Future_Round (2.02s)
    --- PASS: TestHandleDiscordMessageIDUpdated/Success_-_Schedule_Events_for_Round_Less_Than_1_Hour_Away (2.33s)
    --- PASS: TestHandleDiscordMessageIDUpdated/Success_-_Schedule_Events_for_Round_Far_in_Future (2.06s)
    --- PASS: TestHandleDiscordMessageIDUpdated/Success_-_Handle_Round_with_Past_Start_Time (1.94s)
    --- PASS: TestHandleDiscordMessageIDUpdated/Failure_-_Invalid_JSON_Message (1.99s)
=== RUN   TestHandleScoreUpdateValidated
=== RUN   TestHandleScoreUpdateValidated/Success_-_Update_Participant_Score_(Single_Participant)
2025/05/31 09:03:45 Truncating tables: users, scores, leaderboards, rounds
    score_round2_test.go:35: Created round e2e90593-349d-4227-869c-650cf6e089e5 with 1 participants
    score_round2_test.go:330: Participant score updated successfully for round: e2e90593-349d-4227-869c-650cf6e089e5, participant: 412508120, score: -1 under par, participants: 1
2025/05/31 09:03:48 Starting lightweight round handler cleanup...
2025/05/31 09:03:48 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateValidated/Success_-_Update_Participant_Score_(Multiple_Participants)
2025/05/31 09:03:49 Truncating tables: users, scores, leaderboards, rounds
    score_round2_test.go:70: Created round 1cfa1f47-5b5f-44ae-9adb-599d8a942f19 with 3 participants
    score_round2_test.go:330: Participant score updated successfully for round: 1cfa1f47-5b5f-44ae-9adb-599d8a942f19, participant: 412508120, score: +3 over par, participants: 3
2025/05/31 09:03:50 Starting lightweight round handler cleanup...
2025/05/31 09:03:51 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateValidated/Success_-_Update_Score_for_Participant_with_Existing_Score
2025/05/31 09:03:51 Truncating tables: users, scores, leaderboards, rounds
    score_round2_test.go:117: Created round 3a7e93ae-bff2-4e14-b6ad-5785ee6be42d with 1 participants
    score_round2_test.go:330: Participant score updated successfully for round: 3a7e93ae-bff2-4e14-b6ad-5785ee6be42d, participant: 412508120, score: -2 under par, participants: 1
2025/05/31 09:03:54 Starting lightweight round handler cleanup...
2025/05/31 09:03:54 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateValidated/Failure_-_Round_Not_Found
2025/05/31 09:03:54 Truncating tables: users, scores, leaderboards, rounds
    score_round2_test.go:343: Score update validation failed with error: Failed to update score in database: failed to fetch round: sql: no rows in result set
2025/05/31 09:03:57 Starting lightweight round handler cleanup...
2025/05/31 09:03:57 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateValidated/Failure_-_Participant_Not_Found_in_Round
2025/05/31 09:03:57 Truncating tables: users, scores, leaderboards, rounds
    score_round2_test.go:154: Created round c0f3ac6a-9bb2-455d-9d27-e7052120fe5e with 1 participants
    score_round2_test.go:343: Score update validation failed with error: Failed to update score in database: participant not found in round
2025/05/31 09:03:59 Starting lightweight round handler cleanup...
2025/05/31 09:03:59 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateValidated/Failure_-_Invalid_JSON_Message
2025/05/31 09:03:59 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:04:01 Starting lightweight round handler cleanup...
2025/05/31 09:04:01 Lightweight cleanup completed successfully
--- PASS: TestHandleScoreUpdateValidated (15.78s)
    --- PASS: TestHandleScoreUpdateValidated/Success_-_Update_Participant_Score_(Single_Participant) (3.39s)
    --- PASS: TestHandleScoreUpdateValidated/Success_-_Update_Participant_Score_(Multiple_Participants) (2.18s)
    --- PASS: TestHandleScoreUpdateValidated/Success_-_Update_Score_for_Participant_with_Existing_Score (3.61s)
    --- PASS: TestHandleScoreUpdateValidated/Failure_-_Round_Not_Found (2.59s)
    --- PASS: TestHandleScoreUpdateValidated/Failure_-_Participant_Not_Found_in_Round (2.11s)
    --- PASS: TestHandleScoreUpdateValidated/Failure_-_Invalid_JSON_Message (1.90s)
=== RUN   TestHandleParticipantScoreUpdated
=== RUN   TestHandleParticipantScoreUpdated/Success_-_All_Scores_Submitted_(Single_Participant)
2025/05/31 09:04:01 Truncating tables: users, scores, leaderboards, rounds
    score_round3_test.go:37: Created round acbe754f-d09b-4795-af92-0ea4e42fbc8c with 1 participants
    score_round3_test.go:433: All scores submitted for round: acbe754f-d09b-4795-af92-0ea4e42fbc8c, participants: 1
2025/05/31 09:04:03 Starting lightweight round handler cleanup...
2025/05/31 09:04:03 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantScoreUpdated/Success_-_All_Scores_Submitted_(Multiple_Participants)
2025/05/31 09:04:04 Truncating tables: users, scores, leaderboards, rounds
    score_round3_test.go:67: Created round db1a89ab-1092-442e-af87-33607b6b8945 with 3 participants
    score_round3_test.go:433: All scores submitted for round: db1a89ab-1092-442e-af87-33607b6b8945, participants: 3
2025/05/31 09:04:06 Starting lightweight round handler cleanup...
2025/05/31 09:04:07 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantScoreUpdated/Success_-_Not_All_Scores_Submitted_(Single_Participant_Without_Score)
2025/05/31 09:04:07 Truncating tables: users, scores, leaderboards, rounds
    score_round3_test.go:103: Created round 53d8a336-f605-45e4-a1d2-9225f4a5660f with 2 participants
    score_round3_test.go:446: Not all scores submitted for round: 53d8a336-f605-45e4-a1d2-9225f4a5660f, updated participant: 630021600, score: +2 over par, total participants: 2
2025/05/31 09:04:10 Starting lightweight round handler cleanup...
2025/05/31 09:04:10 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantScoreUpdated/Success_-_Not_All_Scores_Submitted_(Multiple_Missing_Scores)
2025/05/31 09:04:10 Truncating tables: users, scores, leaderboards, rounds
    score_round3_test.go:136: Created round bf2ec62d-1d0d-460d-b0d8-7d9f5bd4540d with 4 participants
    score_round3_test.go:446: Not all scores submitted for round: bf2ec62d-1d0d-460d-b0d8-7d9f5bd4540d, updated participant: 630021600, score: -1 under par, total participants: 4
2025/05/31 09:04:13 Starting lightweight round handler cleanup...
2025/05/31 09:04:13 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantScoreUpdated/Success_-_Last_Score_Submitted_Triggers_All_Scores_Submitted
2025/05/31 09:04:13 Truncating tables: users, scores, leaderboards, rounds
    score_round3_test.go:180: Created round 152c85b9-26d6-418a-a838-a2a6fd4a779d with 3 participants
    score_round3_test.go:433: All scores submitted for round: 152c85b9-26d6-418a-a838-a2a6fd4a779d, participants: 3
2025/05/31 09:04:16 Starting lightweight round handler cleanup...
2025/05/31 09:04:16 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantScoreUpdated/Failure_-_Round_Not_Found
2025/05/31 09:04:16 Truncating tables: users, scores, leaderboards, rounds
    score_round3_test.go:459: Score check failed with error: round with ID e15258f3-137b-4f2d-9636-8c60501a39a2 not found
2025/05/31 09:04:19 Starting lightweight round handler cleanup...
2025/05/31 09:04:19 Lightweight cleanup completed successfully
=== RUN   TestHandleParticipantScoreUpdated/Failure_-_Invalid_JSON_Message
2025/05/31 09:04:19 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:04:21 Starting lightweight round handler cleanup...
2025/05/31 09:04:21 Lightweight cleanup completed successfully
--- PASS: TestHandleParticipantScoreUpdated (20.32s)
    --- PASS: TestHandleParticipantScoreUpdated/Success_-_All_Scores_Submitted_(Single_Participant) (2.70s)
    --- PASS: TestHandleParticipantScoreUpdated/Success_-_All_Scores_Submitted_(Multiple_Participants) (3.11s)
    --- PASS: TestHandleParticipantScoreUpdated/Success_-_Not_All_Scores_Submitted_(Single_Participant_Without_Score) (3.21s)
    --- PASS: TestHandleParticipantScoreUpdated/Success_-_Not_All_Scores_Submitted_(Multiple_Missing_Scores) (3.10s)
    --- PASS: TestHandleParticipantScoreUpdated/Success_-_Last_Score_Submitted_Triggers_All_Scores_Submitted (3.19s)
    --- PASS: TestHandleParticipantScoreUpdated/Failure_-_Round_Not_Found (3.01s)
    --- PASS: TestHandleParticipantScoreUpdated/Failure_-_Invalid_JSON_Message (2.00s)
=== RUN   TestHandleScoreUpdateRequest
=== RUN   TestHandleScoreUpdateRequest/Success_-_Valid_Score_Update_Request_(Under_Par)
2025/05/31 09:04:21 Truncating tables: users, scores, leaderboards, rounds
    score_round_test.go:304: Score update validated successfully for round: 310e922f-a4bf-4c67-88dc-10ba4a1a1d11, participant: 279795300, score: -2 under par
2025/05/31 09:04:23 Starting lightweight round handler cleanup...
2025/05/31 09:04:23 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateRequest/Success_-_Valid_Score_Update_Request_(Over_Par)
2025/05/31 09:04:23 Truncating tables: users, scores, leaderboards, rounds
    score_round_test.go:304: Score update validated successfully for round: 3ff16d0b-c146-4e85-bb13-29224d6673ae, participant: 533486318, score: +5 over par
2025/05/31 09:04:25 Starting lightweight round handler cleanup...
2025/05/31 09:04:26 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateRequest/Success_-_Valid_Score_Update_Request_(Even_Par)
2025/05/31 09:04:26 Truncating tables: users, scores, leaderboards, rounds
    score_round_test.go:304: Score update validated successfully for round: 2734230b-2624-4887-ab65-8ee7b4f57694, participant: 279795300, score: even par
2025/05/31 09:04:27 Starting lightweight round handler cleanup...
2025/05/31 09:04:27 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateRequest/Failure_-_Empty_Round_ID
2025/05/31 09:04:27 Truncating tables: users, scores, leaderboards, rounds
    score_round_test.go:317: Score update validation failed with error: validation errors: round ID cannot be zero
2025/05/31 09:04:30 Starting lightweight round handler cleanup...
2025/05/31 09:04:30 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateRequest/Failure_-_Empty_Participant_ID
2025/05/31 09:04:31 Truncating tables: users, scores, leaderboards, rounds
    score_round_test.go:317: Score update validation failed with error: validation errors: participant Discord ID cannot be empty
2025/05/31 09:04:32 Starting lightweight round handler cleanup...
2025/05/31 09:04:32 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateRequest/Failure_-_Nil_Score
2025/05/31 09:04:32 Truncating tables: users, scores, leaderboards, rounds
    score_round_test.go:317: Score update validation failed with error: validation errors: score cannot be empty
2025/05/31 09:04:35 Starting lightweight round handler cleanup...
2025/05/31 09:04:35 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateRequest/Failure_-_Multiple_Validation_Errors
2025/05/31 09:04:35 Truncating tables: users, scores, leaderboards, rounds
    score_round_test.go:317: Score update validation failed with error: validation errors: round ID cannot be zero; participant Discord ID cannot be empty; score cannot be empty
2025/05/31 09:04:37 Starting lightweight round handler cleanup...
2025/05/31 09:04:37 Lightweight cleanup completed successfully
=== RUN   TestHandleScoreUpdateRequest/Failure_-_Invalid_JSON_Message
2025/05/31 09:04:38 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:04:39 Starting lightweight round handler cleanup...
2025/05/31 09:04:39 Lightweight cleanup completed successfully
--- PASS: TestHandleScoreUpdateRequest (18.37s)
    --- PASS: TestHandleScoreUpdateRequest/Success_-_Valid_Score_Update_Request_(Under_Par) (2.08s)
    --- PASS: TestHandleScoreUpdateRequest/Success_-_Valid_Score_Update_Request_(Over_Par) (2.39s)
    --- PASS: TestHandleScoreUpdateRequest/Success_-_Valid_Score_Update_Request_(Even_Par) (1.72s)
    --- PASS: TestHandleScoreUpdateRequest/Failure_-_Empty_Round_ID (3.11s)
    --- PASS: TestHandleScoreUpdateRequest/Failure_-_Empty_Participant_ID (2.00s)
    --- PASS: TestHandleScoreUpdateRequest/Failure_-_Nil_Score (2.29s)
    --- PASS: TestHandleScoreUpdateRequest/Failure_-_Multiple_Validation_Errors (2.73s)
    --- PASS: TestHandleScoreUpdateRequest/Failure_-_Invalid_JSON_Message (2.06s)
=== RUN   TestHandleRoundStarted
=== RUN   TestHandleRoundStarted/Success_-_Start_Round_with_Single_Participant
2025/05/31 09:04:40 Truncating tables: users, scores, leaderboards, rounds
    start_round_test.go:34: Created round 03afac86-aab7-4c4b-b227-8ba922491cd1 with 1 participants
    start_round_test.go:360: Round started successfully: 03afac86-aab7-4c4b-b227-8ba922491cd1 ('Test Round'), participants: 1
2025/05/31 09:04:43 Starting lightweight round handler cleanup...
2025/05/31 09:04:43 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundStarted/Success_-_Start_Round_with_Multiple_Participants
2025/05/31 09:04:43 Truncating tables: users, scores, leaderboards, rounds
    start_round_test.go:71: Created round 0a937d9c-6327-4b2a-ab00-8cc26f765c2e with 3 participants
    start_round_test.go:360: Round started successfully: 0a937d9c-6327-4b2a-ab00-8cc26f765c2e ('Multi-Player Round'), participants: 3
2025/05/31 09:04:47 Starting lightweight round handler cleanup...
2025/05/31 09:04:47 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundStarted/Success_-_Start_Round_with_No_Participants
2025/05/31 09:04:47 Truncating tables: users, scores, leaderboards, rounds
    start_round_test.go:139: Created round 53e969ef-14a9-4819-a083-f23b547535e2 with 0 participants
    start_round_test.go:360: Round started successfully: 53e969ef-14a9-4819-a083-f23b547535e2 ('Solo Round'), participants: 0
2025/05/31 09:04:51 Starting lightweight round handler cleanup...
2025/05/31 09:04:51 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundStarted/Success_-_Start_Round_with_Participant_Tag_Numbers
2025/05/31 09:04:51 Truncating tables: users, scores, leaderboards, rounds
    start_round_test.go:161: Created round ae35a119-1619-4eb4-85ba-8944d60c9163 with 2 participants
    start_round_test.go:360: Round started successfully: ae35a119-1619-4eb4-85ba-8944d60c9163 ('Tagged Round'), participants: 2
2025/05/31 09:04:54 Starting lightweight round handler cleanup...
2025/05/31 09:04:54 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundStarted/Failure_-_Round_Not_Found
2025/05/31 09:04:54 Truncating tables: users, scores, leaderboards, rounds
    start_round_test.go:373: Round start failed with error: round with ID a792ea60-ef3a-446a-8790-a7bd2379edbf not found
2025/05/31 09:04:56 Starting lightweight round handler cleanup...
2025/05/31 09:04:56 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundStarted/Failure_-_Invalid_JSON_Message
2025/05/31 09:04:56 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:04:57 Starting lightweight round handler cleanup...
2025/05/31 09:04:58 Lightweight cleanup completed successfully
--- PASS: TestHandleRoundStarted (18.11s)
    --- PASS: TestHandleRoundStarted/Success_-_Start_Round_with_Single_Participant (3.26s)
    --- PASS: TestHandleRoundStarted/Success_-_Start_Round_with_Multiple_Participants (4.18s)
    --- PASS: TestHandleRoundStarted/Success_-_Start_Round_with_No_Participants (3.98s)
    --- PASS: TestHandleRoundStarted/Success_-_Start_Round_with_Participant_Tag_Numbers (3.11s)
    --- PASS: TestHandleRoundStarted/Failure_-_Round_Not_Found (1.59s)
    --- PASS: TestHandleRoundStarted/Failure_-_Invalid_JSON_Message (1.98s)
=== RUN   TestHandleRoundUpdateValidated
=== RUN   TestHandleRoundUpdateValidated/Success_-_Update_Title_Only
2025/05/31 09:04:58 Truncating tables: users, scores, leaderboards, rounds
    update_round2_test.go:32: Created round d3257049-fe1a-480d-b989-d72b27cde1d3 with 1 participants
    update_round2_test.go:418: Round entity updated successfully: d3257049-fe1a-480d-b989-d72b27cde1d3 ('Updated Round Title')
2025/05/31 09:04:59 Starting lightweight round handler cleanup...
2025/05/31 09:05:00 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateValidated/Success_-_Update_Description_Only
2025/05/31 09:05:00 Truncating tables: users, scores, leaderboards, rounds
    update_round2_test.go:67: Created round 1c7cf79a-0ccf-4b3b-89d4-85f53d13c5fa with 0 participants
    update_round2_test.go:418: Round entity updated successfully: 1c7cf79a-0ccf-4b3b-89d4-85f53d13c5fa ('Will nobody an moreover.')
2025/05/31 09:05:02 Starting lightweight round handler cleanup...
2025/05/31 09:05:03 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateValidated/Success_-_Update_Location_Only
2025/05/31 09:05:03 Truncating tables: users, scores, leaderboards, rounds
    update_round2_test.go:93: Created round 34150d73-902a-499f-8ad2-9aebcd59735c with 0 participants
    update_round2_test.go:418: Round entity updated successfully: 34150d73-902a-499f-8ad2-9aebcd59735c ('His all.')
2025/05/31 09:05:05 Starting lightweight round handler cleanup...
2025/05/31 09:05:06 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateValidated/Success_-_Update_Start_Time_Only
2025/05/31 09:05:06 Truncating tables: users, scores, leaderboards, rounds
    update_round2_test.go:110: Created round 216b3b9c-4509-4a79-830d-5ab6e7bc5c07 with 0 participants
    update_round2_test.go:418: Round entity updated successfully: 216b3b9c-4509-4a79-830d-5ab6e7bc5c07 ('You yet have.')
2025/05/31 09:05:08 Starting lightweight round handler cleanup...
2025/05/31 09:05:08 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateValidated/Success_-_Update_Event_Type_Only
2025/05/31 09:05:08 Truncating tables: users, scores, leaderboards, rounds
    update_round2_test.go:132: Created round 94f5853f-3a7d-4a49-b6d3-ea204bccb57f with 0 participants
    update_round2_test.go:418: Round entity updated successfully: 94f5853f-3a7d-4a49-b6d3-ea204bccb57f ('What please.')
2025/05/31 09:05:10 Starting lightweight round handler cleanup...
2025/05/31 09:05:10 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateValidated/Success_-_Update_Multiple_Fields
2025/05/31 09:05:10 Truncating tables: users, scores, leaderboards, rounds
    update_round2_test.go:149: Created round a9eb1f6b-8d8d-4afc-9cd8-3165b128762e with 1 participants
    update_round2_test.go:418: Round entity updated successfully: a9eb1f6b-8d8d-4afc-9cd8-3165b128762e ('Multi-Update Round')
2025/05/31 09:05:12 Starting lightweight round handler cleanup...
2025/05/31 09:05:13 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateValidated/Success_-_Update_Round_with_Existing_Participants
2025/05/31 09:05:13 Truncating tables: users, scores, leaderboards, rounds
    update_round2_test.go:192: Created round 48114951-4feb-46ce-b7c9-0eac53484f30 with 1 participants
    update_round2_test.go:418: Round entity updated successfully: 48114951-4feb-46ce-b7c9-0eac53484f30 ('Updated Round with Participants')
2025/05/31 09:05:16 Starting lightweight round handler cleanup...
2025/05/31 09:05:16 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateValidated/Failure_-_Round_Not_Found
2025/05/31 09:05:16 Truncating tables: users, scores, leaderboards, rounds
    update_round2_test.go:431: Round entity update failed with error: round with ID 5d605e18-78db-4e28-9591-74bfe3d1afb7 not found
2025/05/31 09:05:20 Starting lightweight round handler cleanup...
2025/05/31 09:05:20 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateValidated/Failure_-_Invalid_JSON_Message
2025/05/31 09:05:20 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:05:22 Starting lightweight round handler cleanup...
2025/05/31 09:05:22 Lightweight cleanup completed successfully
--- PASS: TestHandleRoundUpdateValidated (24.52s)
    --- PASS: TestHandleRoundUpdateValidated/Success_-_Update_Title_Only (1.99s)
    --- PASS: TestHandleRoundUpdateValidated/Success_-_Update_Description_Only (3.02s)
    --- PASS: TestHandleRoundUpdateValidated/Success_-_Update_Location_Only (2.92s)
    --- PASS: TestHandleRoundUpdateValidated/Success_-_Update_Start_Time_Only (2.49s)
    --- PASS: TestHandleRoundUpdateValidated/Success_-_Update_Event_Type_Only (2.21s)
    --- PASS: TestHandleRoundUpdateValidated/Success_-_Update_Multiple_Fields (2.37s)
    --- PASS: TestHandleRoundUpdateValidated/Success_-_Update_Round_with_Existing_Participants (3.61s)
    --- PASS: TestHandleRoundUpdateValidated/Failure_-_Round_Not_Found (3.91s)
    --- PASS: TestHandleRoundUpdateValidated/Failure_-_Invalid_JSON_Message (2.00s)
=== RUN   TestHandleRoundScheduleUpdate
=== RUN   TestHandleRoundScheduleUpdate/Success_-_Update_Schedule_for_Round_with_No_Participants
2025/05/31 09:05:22 Truncating tables: users, scores, leaderboards, rounds
    update_round3_test.go:33: Created round 97ac0ddb-0e24-4a82-a545-9cb737800034 with 0 participants
    update_round3_test.go:36: DEBUG: Created round ID: 97ac0ddb-0e24-4a82-a545-9cb737800034
    update_round3_test.go:45: DEBUG: Original round from DBService - ID: 97ac0ddb-0e24-4a82-a545-9cb737800034, Title: Apart besides e.g. library daily., CreatedBy: 258838786, Participants: 0
    update_round3_test.go:53: DEBUG: Round via direct DB - ID: 97ac0ddb-0e24-4a82-a545-9cb737800034, Title: Apart besides e.g. library daily., CreatedBy: 258838786, Participants: 0
    update_round3_test.go:67: DEBUG: About to publish message with payload for round 97ac0ddb-0e24-4a82-a545-9cb737800034
    update_round3_test.go:399: DEBUG: Received round data - ID: 97ac0ddb-0e24-4a82-a545-9cb737800034, Title: Apart besides e.g. library daily., CreatedBy: 258838786, Participants: 0
    update_round3_test.go:399: Round schedule updated successfully: 97ac0ddb-0e24-4a82-a545-9cb737800034 ('Apart besides e.g. library daily.'), participants: 0
2025/05/31 09:05:25 Starting lightweight round handler cleanup...
2025/05/31 09:05:25 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundScheduleUpdate/Success_-_Update_Schedule_for_Round_with_Participants
2025/05/31 09:05:25 Truncating tables: users, scores, leaderboards, rounds
    update_round3_test.go:89: Created round 98b8cdd7-0a84-44fc-a34a-64c242b322ca with 2 participants
    update_round3_test.go:399: DEBUG: Received round data - ID: 98b8cdd7-0a84-44fc-a34a-64c242b322ca, Title: Where despite to number me., CreatedBy: 258838786, Participants: 2
    update_round3_test.go:399: Round schedule updated successfully: 98b8cdd7-0a84-44fc-a34a-64c242b322ca ('Where despite to number me.'), participants: 2
2025/05/31 09:05:27 Starting lightweight round handler cleanup...
2025/05/31 09:05:27 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundScheduleUpdate/Success_-_Update_Schedule_with_Minimal_Payload_Data
2025/05/31 09:05:27 Truncating tables: users, scores, leaderboards, rounds
    update_round3_test.go:142: Created round 6cb330d9-312a-4a29-bd9d-e1a99dfc780d with 1 participants
    update_round3_test.go:399: DEBUG: Received round data - ID: 6cb330d9-312a-4a29-bd9d-e1a99dfc780d, Title: Some behind lastly earlier., CreatedBy: 258838786, Participants: 1
    update_round3_test.go:399: Round schedule updated successfully: 6cb330d9-312a-4a29-bd9d-e1a99dfc780d ('Some behind lastly earlier.'), participants: 1
2025/05/31 09:05:30 Starting lightweight round handler cleanup...
2025/05/31 09:05:30 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundScheduleUpdate/Success_-_Update_Schedule_for_Round_with_All_Field_Types
2025/05/31 09:05:30 Truncating tables: users, scores, leaderboards, rounds
    update_round3_test.go:166: Created round 29c412fb-0285-466e-9a39-030f823529cb with 2 participants
    update_round3_test.go:399: DEBUG: Received round data - ID: 29c412fb-0285-466e-9a39-030f823529cb, Title: Besides according., CreatedBy: 258838786, Participants: 2
    update_round3_test.go:399: Round schedule updated successfully: 29c412fb-0285-466e-9a39-030f823529cb ('Besides according.'), participants: 2
2025/05/31 09:05:34 Starting lightweight round handler cleanup...
2025/05/31 09:05:34 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundScheduleUpdate/Failure_-_Round_Not_Found
2025/05/31 09:05:34 Truncating tables: users, scores, leaderboards, rounds
    update_round3_test.go:412: Round schedule update failed with error: round with ID 3d288403-4b2c-41c9-8a6f-323cbfcd86c4 not found
2025/05/31 09:05:36 Starting lightweight round handler cleanup...
2025/05/31 09:05:36 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundScheduleUpdate/Failure_-_Invalid_JSON_Message
2025/05/31 09:05:36 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:05:38 Starting lightweight round handler cleanup...
2025/05/31 09:05:38 Lightweight cleanup completed successfully
--- PASS: TestHandleRoundScheduleUpdate (15.70s)
    --- PASS: TestHandleRoundScheduleUpdate/Success_-_Update_Schedule_for_Round_with_No_Participants (3.00s)
    --- PASS: TestHandleRoundScheduleUpdate/Success_-_Update_Schedule_for_Round_with_Participants (1.66s)
    --- PASS: TestHandleRoundScheduleUpdate/Success_-_Update_Schedule_with_Minimal_Payload_Data (3.33s)
    --- PASS: TestHandleRoundScheduleUpdate/Success_-_Update_Schedule_for_Round_with_All_Field_Types (3.51s)
    --- PASS: TestHandleRoundScheduleUpdate/Failure_-_Round_Not_Found (2.02s)
    --- PASS: TestHandleRoundScheduleUpdate/Failure_-_Invalid_JSON_Message (2.19s)
=== RUN   TestHandleRoundUpdateRequest
=== RUN   TestHandleRoundUpdateRequest/Success_-_Valid_Title_Update
2025/05/31 09:05:38 Truncating tables: users, scores, leaderboards, rounds
    update_round_test.go:31: Created round 442da7ba-ec7a-48c5-ad99-686d57906e50 with 0 participants
    update_round_test.go:383: Round update request validated for round: 442da7ba-ec7a-48c5-ad99-686d57906e50, user: 806668285
2025/05/31 09:05:40 Starting lightweight round handler cleanup...
2025/05/31 09:05:40 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateRequest/Success_-_Valid_Description_Update
2025/05/31 09:05:40 Truncating tables: users, scores, leaderboards, rounds
    update_round_test.go:54: Created round ebd48d28-8552-4f45-baf2-af59f7282a0b with 0 participants
    update_round_test.go:383: Round update request validated for round: ebd48d28-8552-4f45-baf2-af59f7282a0b, user: 806668285
2025/05/31 09:05:42 Starting lightweight round handler cleanup...
2025/05/31 09:05:42 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateRequest/Success_-_Valid_Location_Update
2025/05/31 09:05:42 Truncating tables: users, scores, leaderboards, rounds
    update_round_test.go:74: Created round 8b85a5e9-8541-4c4c-a1c4-79f51674bd66 with 0 participants
    update_round_test.go:383: Round update request validated for round: 8b85a5e9-8541-4c4c-a1c4-79f51674bd66, user: 806668285
2025/05/31 09:05:43 Starting lightweight round handler cleanup...
2025/05/31 09:05:44 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateRequest/Success_-_Valid_Start_Time_Update
2025/05/31 09:05:44 Truncating tables: users, scores, leaderboards, rounds
    update_round_test.go:91: Created round 81cc323a-cdf1-4253-97a7-cd415acabdc8 with 0 participants
    update_round_test.go:383: Round update request validated for round: 81cc323a-cdf1-4253-97a7-cd415acabdc8, user: 806668285
2025/05/31 09:05:46 Starting lightweight round handler cleanup...
2025/05/31 09:05:46 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateRequest/Success_-_Multiple_Fields_Update
2025/05/31 09:05:46 Truncating tables: users, scores, leaderboards, rounds
    update_round_test.go:109: Created round fe4a53f7-eee3-48d8-829e-504d76730414 with 0 participants
    update_round_test.go:383: Round update request validated for round: fe4a53f7-eee3-48d8-829e-504d76730414, user: 806668285
2025/05/31 09:05:51 Starting lightweight round handler cleanup...
2025/05/31 09:05:51 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateRequest/Failure_-_Zero_Round_ID
2025/05/31 09:05:51 Truncating tables: users, scores, leaderboards, rounds
    update_round_test.go:396: Round update request failed with error: validation errors: round ID cannot be zero
2025/05/31 09:05:54 Starting lightweight round handler cleanup...
2025/05/31 09:05:54 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateRequest/Failure_-_No_Fields_to_Update
2025/05/31 09:05:54 Truncating tables: users, scores, leaderboards, rounds
    update_round_test.go:162: Created round 1175ca52-c9e1-4f4a-8388-77649dc82b01 with 0 participants
    update_round_test.go:396: Round update request failed with error: validation errors: at least one field to update must be provided
2025/05/31 09:05:58 Starting lightweight round handler cleanup...
2025/05/31 09:05:58 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateRequest/Failure_-_Empty_Title_with_No_Other_Fields
2025/05/31 09:05:58 Truncating tables: users, scores, leaderboards, rounds
    update_round_test.go:178: Created round c14699d6-3fe6-4364-822a-507a4c5e8088 with 0 participants
    update_round_test.go:396: Round update request failed with error: validation errors: at least one field to update must be provided
2025/05/31 09:06:01 Starting lightweight round handler cleanup...
2025/05/31 09:06:01 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateRequest/Failure_-_Multiple_Validation_Errors
2025/05/31 09:06:01 Truncating tables: users, scores, leaderboards, rounds
    update_round_test.go:396: Round update request failed with error: validation errors: round ID cannot be zero; at least one field to update must be provided
2025/05/31 09:06:03 Starting lightweight round handler cleanup...
2025/05/31 09:06:03 Lightweight cleanup completed successfully
=== RUN   TestHandleRoundUpdateRequest/Failure_-_Invalid_JSON_Message
2025/05/31 09:06:03 Truncating tables: users, scores, leaderboards, rounds
2025/05/31 09:06:05 Starting lightweight round handler cleanup...
2025/05/31 09:06:05 Lightweight cleanup completed successfully
--- PASS: TestHandleRoundUpdateRequest (27.17s)
    --- PASS: TestHandleRoundUpdateRequest/Success_-_Valid_Title_Update (2.28s)
    --- PASS: TestHandleRoundUpdateRequest/Success_-_Valid_Description_Update (1.71s)
    --- PASS: TestHandleRoundUpdateRequest/Success_-_Valid_Location_Update (1.79s)
    --- PASS: TestHandleRoundUpdateRequest/Success_-_Valid_Start_Time_Update (2.70s)
    --- PASS: TestHandleRoundUpdateRequest/Success_-_Multiple_Fields_Update (4.39s)
    --- PASS: TestHandleRoundUpdateRequest/Failure_-_Zero_Round_ID (3.44s)
    --- PASS: TestHandleRoundUpdateRequest/Failure_-_No_Fields_to_Update (4.18s)
    --- PASS: TestHandleRoundUpdateRequest/Failure_-_Empty_Title_with_No_Other_Fields (2.99s)
    --- PASS: TestHandleRoundUpdateRequest/Failure_-_Multiple_Validation_Errors (1.72s)
    --- PASS: TestHandleRoundUpdateRequest/Failure_-_Invalid_JSON_Message (1.96s)
FAIL
coverage: 25.9% of statements in ./app/...
2025/05/31 09:06:05 TestMain: finished with exit code: 1
FAIL	github.com/Black-And-White-Club/frolf-bot/integration_tests/modules/round/handler_tests	411.223s
2025/05/31 08:59:17 TestMain started in package scoreintegrationtests
=== RUN   TestCorrectScore
2025/05/31 08:59:17 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:17 github.com/testcontainers/testcontainers-go - Connected to docker: 
  Server Version: 28.1.1
  API Version: 1.48
  Operating System: Ubuntu 24.04.1 LTS
  Total Memory: 5923 MB
  Testcontainers for Go Version: v0.37.0
  Resolved Docker Host: unix:///Users/jace/.colima/default/docker.sock
  Resolved Docker Socket Path: /var/run/docker.sock
  Test SessionID: 3bcca53efbc96e46a6c192358bf7642f396e27e5bff8699ef9bf67ff02cc0815
  Test ProcessID: 2f918a33-4b69-4eed-a510-bd9d3092c386
2025/05/31 08:59:17  Creating container for image postgres:16-alpine
2025/05/31 08:59:17  Waiting for Reaper "f69f8f9c" to be ready
2025/05/31 08:59:18  Reaper obtained from Docker for this test session f69f8f9c
2025/05/31 08:59:18  Container created: a00d34bec123
2025/05/31 08:59:18  Starting container: a00d34bec123
2025/05/31 08:59:19  Container started: a00d34bec123
2025/05/31 08:59:19  Waiting for container id a00d34bec123 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000012360 Strategies:[0xc00049c8d0]}
2025/05/31 08:59:29  Container is ready: a00d34bec123
2025/05/31 08:59:29 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38814/testdb?sslmode=disable
2025/05/31 08:59:29 Starting NATS container with resource limits...
2025/05/31 08:59:29  Creating container for image nats:2.10-alpine
2025/05/31 08:59:30  Container created: dd4d2de3aa22
2025/05/31 08:59:30  Starting container: dd4d2de3aa22
2025/05/31 08:59:31  Container started: dd4d2de3aa22
2025/05/31 08:59:31  Waiting for container id dd4d2de3aa22 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000030ac0 Strategies:[0xc0000b6c60 0xc0005813b0]}
2025/05/31 08:59:32  Container is ready: dd4d2de3aa22
2025/05/31 08:59:32 NATS container started with resource limits. URL: nats://localhost:38833
Creating user table...
User table created successfully!
2025/05/31 08:59:32 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 08:59:32 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 08:59:32 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:32 Ran leaderboard migrations group #4
2025/05/31 08:59:32 All migrations ran successfully
2025/05/31 08:59:32 newDBServiceWithDB - Registering models
2025/05/31 08:59:32 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:32 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007c628 RoundDB:0xc00007c630 ScoreDB:0xc00007c638 LeaderboardDB:0xc00007c640 db:0xc00039d540}
2025/05/31 08:59:33 Truncating tables: scores
2025/05/31 08:59:33 Truncating tables: scores
=== RUN   TestCorrectScore/Add_initial_score_with_tag_number
[DEBUG LogScores] Insert/Update Executed for RoundID 8c7adfee-7a72-42a4-8c7f-2a7d07e4948e. Error: <nil>, Result: {Locker:0xc000549a80 resi:1}
=== RUN   TestCorrectScore/Add_initial_score_without_tag_number
[DEBUG LogScores] Insert/Update Executed for RoundID 59dfb5f0-23d7-4ddf-a5a0-6b20d008fc5e. Error: <nil>, Result: {Locker:0xc000549a80 resi:1}
=== RUN   TestCorrectScore/Update_existing_score_with_new_tag
[DEBUG LogScores] Insert/Update Executed for RoundID 3a19af6e-e511-472f-a5b0-987897d017f2. Error: <nil>, Result: {Locker:0xc000549a80 resi:1}
=== RUN   TestCorrectScore/Update_existing_score_without_tag
[DEBUG LogScores] Insert/Update Executed for RoundID 277a54e2-3301-4862-9d66-02314b4632be. Error: <nil>, Result: {Locker:0xc000549a80 resi:1}
=== RUN   TestCorrectScore/Fails_with_invalid_round_ID
2025/05/31 08:59:33 Cleaning up test environment...
2025/05/31 08:59:33 Context cancelled.
2025/05/31 08:59:33 EventBus closed.
2025/05/31 08:59:33 NATS connection closed.
2025/05/31 08:59:33 DB connection closed.
2025/05/31 08:59:33  Stopping container: dd4d2de3aa22
2025/05/31 08:59:35  Container stopped: dd4d2de3aa22
2025/05/31 08:59:35  Terminating container: dd4d2de3aa22
2025/05/31 08:59:35  Container terminated: dd4d2de3aa22
2025/05/31 08:59:35 NATS container terminated.
2025/05/31 08:59:35  Stopping container: a00d34bec123
2025/05/31 08:59:36  Container stopped: a00d34bec123
2025/05/31 08:59:36  Terminating container: a00d34bec123
2025/05/31 08:59:37  Container terminated: a00d34bec123
2025/05/31 08:59:37 PostgreSQL container terminated.
2025/05/31 08:59:37 Cleanup complete.
--- PASS: TestCorrectScore (19.61s)
    --- PASS: TestCorrectScore/Add_initial_score_with_tag_number (0.03s)
    --- PASS: TestCorrectScore/Add_initial_score_without_tag_number (0.05s)
    --- PASS: TestCorrectScore/Update_existing_score_with_new_tag (0.05s)
    --- PASS: TestCorrectScore/Update_existing_score_without_tag (0.02s)
    --- PASS: TestCorrectScore/Fails_with_invalid_round_ID (0.01s)
=== RUN   TestProcessRoundScores
2025/05/31 08:59:37 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:37  Creating container for image postgres:16-alpine
2025/05/31 08:59:37  Container created: a7fc08f2ffdf
2025/05/31 08:59:37  Starting container: a7fc08f2ffdf
2025/05/31 08:59:38  Container started: a7fc08f2ffdf
2025/05/31 08:59:38  Waiting for container id a7fc08f2ffdf image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000291b50 Strategies:[0xc00052a3f0]}
2025/05/31 08:59:47  Container is ready: a7fc08f2ffdf
2025/05/31 08:59:47 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38844/testdb?sslmode=disable
2025/05/31 08:59:47 Starting NATS container with resource limits...
2025/05/31 08:59:47  Creating container for image nats:2.10-alpine
2025/05/31 08:59:48  Container created: 2723c45e7d79
2025/05/31 08:59:48  Starting container: 2723c45e7d79
2025/05/31 08:59:49  Container started: 2723c45e7d79
2025/05/31 08:59:49  Waiting for container id 2723c45e7d79 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00057b550 Strategies:[0xc000853440 0xc0000c82a0]}
2025/05/31 08:59:50  Container is ready: 2723c45e7d79
2025/05/31 08:59:50 NATS container started with resource limits. URL: nats://localhost:38855
Creating user table...
User table created successfully!
2025/05/31 08:59:50 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 08:59:50 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 08:59:50 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:50 Ran leaderboard migrations group #4
2025/05/31 08:59:50 All migrations ran successfully
2025/05/31 08:59:50 newDBServiceWithDB - Registering models
2025/05/31 08:59:50 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:50 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00069c190 RoundDB:0xc00069c1a0 ScoreDB:0xc00069c1a8 LeaderboardDB:0xc00069c1c0 db:0xc00005ff40}
2025/05/31 08:59:51 Truncating tables: scores
2025/05/31 08:59:51 Truncating tables: scores
=== RUN   TestProcessRoundScores/Successfully_processes_round_scores_with_tags
[DEBUG LogScores] Insert/Update Executed for RoundID dc777af6-308b-4146-8521-82346d005b9c. Error: <nil>, Result: {Locker:0xc00014d000 resi:1}
=== RUN   TestProcessRoundScores/Successfully_processes_round_scores_without_tags
[DEBUG LogScores] Insert/Update Executed for RoundID ce7e54c3-734c-48ec-9b17-9ffc0fec6e1a. Error: <nil>, Result: {Locker:0xc00014d000 resi:1}
=== RUN   TestProcessRoundScores/Handles_empty_score_list
=== RUN   TestProcessRoundScores/Correctly_sorts_scores
[DEBUG LogScores] Insert/Update Executed for RoundID c3199b3b-f982-4aca-9bf5-f620278d7417. Error: <nil>, Result: {Locker:0xc00014d000 resi:1}
=== RUN   TestProcessRoundScores/Handles_concurrent_score_processing
[DEBUG LogScores] Insert/Update Executed for RoundID 846542da-cdcd-4def-8d83-2ebc34a9b359. Error: <nil>, Result: {Locker:0xc00014d000 resi:1}
[DEBUG LogScores] Insert/Update Executed for RoundID 366e4951-ac4a-4217-9f06-912468dc2469. Error: <nil>, Result: {Locker:0xc00014c880 resi:1}
[DEBUG LogScores] Insert/Update Executed for RoundID a4e58217-b40d-4409-8171-701420898a15. Error: <nil>, Result: {Locker:0xc00014ca80 resi:1}
2025/05/31 08:59:51 Cleaning up test environment...
2025/05/31 08:59:51 Context cancelled.
2025/05/31 08:59:51 EventBus closed.
2025/05/31 08:59:51 NATS connection closed.
2025/05/31 08:59:51 DB connection closed.
2025/05/31 08:59:51  Stopping container: 2723c45e7d79
2025/05/31 08:59:52  Container stopped: 2723c45e7d79
2025/05/31 08:59:52  Terminating container: 2723c45e7d79
2025/05/31 08:59:52  Container terminated: 2723c45e7d79
2025/05/31 08:59:52 NATS container terminated.
2025/05/31 08:59:52  Stopping container: a7fc08f2ffdf
2025/05/31 08:59:52  Container stopped: a7fc08f2ffdf
2025/05/31 08:59:52  Terminating container: a7fc08f2ffdf
2025/05/31 08:59:52  Container terminated: a7fc08f2ffdf
2025/05/31 08:59:52 PostgreSQL container terminated.
2025/05/31 08:59:52 Cleanup complete.
--- PASS: TestProcessRoundScores (15.44s)
    --- PASS: TestProcessRoundScores/Successfully_processes_round_scores_with_tags (0.02s)
    --- PASS: TestProcessRoundScores/Successfully_processes_round_scores_without_tags (0.02s)
    --- PASS: TestProcessRoundScores/Handles_empty_score_list (0.00s)
    --- PASS: TestProcessRoundScores/Correctly_sorts_scores (0.01s)
    --- PASS: TestProcessRoundScores/Handles_concurrent_score_processing (0.09s)
=== RUN   TestProcessScoresForStorage
2025/05/31 08:59:52 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:52  Creating container for image postgres:16-alpine
2025/05/31 08:59:52  Container created: 8b02dec01e6d
2025/05/31 08:59:52  Starting container: 8b02dec01e6d
2025/05/31 08:59:53  Container started: 8b02dec01e6d
2025/05/31 08:59:53  Waiting for container id 8b02dec01e6d image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005d2280 Strategies:[0xc00052b1d0]}
2025/05/31 09:00:00  Container is ready: 8b02dec01e6d
2025/05/31 09:00:00 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38868/testdb?sslmode=disable
2025/05/31 09:00:00 Starting NATS container with resource limits...
2025/05/31 09:00:00  Creating container for image nats:2.10-alpine
2025/05/31 09:00:00  Container created: 9246bf4fb646
2025/05/31 09:00:00  Starting container: 9246bf4fb646
2025/05/31 09:00:02  Container started: 9246bf4fb646
2025/05/31 09:00:02  Waiting for container id 9246bf4fb646 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00083b320 Strategies:[0xc00098af00 0xc000980bd0]}
2025/05/31 09:00:05  Container is ready: 9246bf4fb646
2025/05/31 09:00:05 NATS container started with resource limits. URL: nats://localhost:38877
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:05 Ran leaderboard migrations group #1
Creating user table...
User table created successfully!
2025/05/31 09:00:05 Ran user migrations group #2
Creating round table...
Round table created successfully!
2025/05/31 09:00:06 Ran round migrations group #3
Creating score table...
Score table created successfully!
2025/05/31 09:00:06 Ran score migrations group #4
2025/05/31 09:00:06 All migrations ran successfully
2025/05/31 09:00:06 newDBServiceWithDB - Registering models
2025/05/31 09:00:06 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:06 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0004b0080 RoundDB:0xc0004b0088 ScoreDB:0xc0004b0090 LeaderboardDB:0xc0004b0098 db:0xc000910100}
2025/05/31 09:00:06 Truncating tables: scores
2025/05/31 09:00:06 Truncating tables: scores
=== RUN   TestProcessScoresForStorage/Correctly_processes_and_sorts_scores
=== RUN   TestProcessScoresForStorage/Handles_empty_score_list_correctly
=== RUN   TestProcessScoresForStorage/Handles_extreme_scores
2025/05/31 09:00:06 Cleaning up test environment...
2025/05/31 09:00:06 Context cancelled.
2025/05/31 09:00:06 EventBus closed.
2025/05/31 09:00:06 NATS connection closed.
2025/05/31 09:00:06 DB connection closed.
2025/05/31 09:00:06  Stopping container: 9246bf4fb646
2025/05/31 09:00:07  Container stopped: 9246bf4fb646
2025/05/31 09:00:07  Terminating container: 9246bf4fb646
2025/05/31 09:00:07  Container terminated: 9246bf4fb646
2025/05/31 09:00:07 NATS container terminated.
2025/05/31 09:00:07  Stopping container: 8b02dec01e6d
2025/05/31 09:00:08  Container stopped: 8b02dec01e6d
2025/05/31 09:00:08  Terminating container: 8b02dec01e6d
2025/05/31 09:00:08  Container terminated: 8b02dec01e6d
2025/05/31 09:00:08 PostgreSQL container terminated.
2025/05/31 09:00:08 Cleanup complete.
--- PASS: TestProcessScoresForStorage (15.81s)
    --- PASS: TestProcessScoresForStorage/Correctly_processes_and_sorts_scores (0.00s)
    --- PASS: TestProcessScoresForStorage/Handles_empty_score_list_correctly (0.00s)
    --- PASS: TestProcessScoresForStorage/Handles_extreme_scores (0.00s)
PASS
coverage: 3.0% of statements in ./app/...
2025/05/31 09:00:08 TestMain: finished with exit code: 0
ok  	github.com/Black-And-White-Club/frolf-bot/integration_tests/modules/score/application_tests	54.274s	coverage: 3.0% of statements in ./app/...
2025/05/31 08:59:19 TestMain started in package scorehandler_integration_tests
=== RUN   TestHandleCorrectScoreRequest
=== RUN   TestHandleCorrectScoreRequest/Success_-_Correct_score_with_valid_data
2025/05/31 08:59:19 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:19 github.com/testcontainers/testcontainers-go - Connected to docker: 
  Server Version: 28.1.1
  API Version: 1.48
  Operating System: Ubuntu 24.04.1 LTS
  Total Memory: 5923 MB
  Testcontainers for Go Version: v0.37.0
  Resolved Docker Host: unix:///Users/jace/.colima/default/docker.sock
  Resolved Docker Socket Path: /var/run/docker.sock
  Test SessionID: 3bcca53efbc96e46a6c192358bf7642f396e27e5bff8699ef9bf67ff02cc0815
  Test ProcessID: feeec1ab-1d15-4252-bd62-780a37a03d3a
2025/05/31 08:59:19  Creating container for image postgres:16-alpine
2025/05/31 08:59:19  Waiting for Reaper "f69f8f9c" to be ready
2025/05/31 08:59:19  Reaper obtained from Docker for this test session f69f8f9c
2025/05/31 08:59:19  Container created: 7fffb2baad15
2025/05/31 08:59:19  Starting container: 7fffb2baad15
2025/05/31 08:59:20  Container started: 7fffb2baad15
2025/05/31 08:59:20  Waiting for container id 7fffb2baad15 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005001a8 Strategies:[0xc0003647b0]}
2025/05/31 08:59:29  Container is ready: 7fffb2baad15
2025/05/31 08:59:29 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38816/testdb?sslmode=disable
2025/05/31 08:59:29 Starting NATS container with resource limits...
2025/05/31 08:59:29  Creating container for image nats:2.10-alpine
2025/05/31 08:59:30  Container created: 78713ab159dd
2025/05/31 08:59:30  Starting container: 78713ab159dd
2025/05/31 08:59:31  Container started: 78713ab159dd
2025/05/31 08:59:31  Waiting for container id 78713ab159dd image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0004fd130 Strategies:[0xc00048c2a0 0xc000517f20]}
2025/05/31 08:59:32  Container is ready: 78713ab159dd
2025/05/31 08:59:32 NATS container started with resource limits. URL: nats://localhost:38836
Creating user table...
User table created successfully!
2025/05/31 08:59:32 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 08:59:32 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 08:59:32 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:32 Ran leaderboard migrations group #4
2025/05/31 08:59:32 All migrations ran successfully
2025/05/31 08:59:32 newDBServiceWithDB - Registering models
2025/05/31 08:59:32 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:32 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00012c3c8 RoundDB:0xc00012c4c8 ScoreDB:0xc00012c4e0 LeaderboardDB:0xc00012c4e8 db:0xc00005ee80}
2025/05/31 08:59:32 Truncating tables: scores
2025/05/31 08:59:32 Truncating tables: scores, users, rounds, leaderboards
[DEBUG LogScores] Insert/Update Executed for RoundID 6b13a55e-739c-4e27-aa14-3fe688af6240. Error: <nil>, Result: {Locker:0xc0005dcb80 resi:1}
    correct_scores_test.go:291: Waiting for 1 messages on topic "discord.score.update.success" with timeout 5s
2025/05/31 08:59:33 Test received message 0e8931bf-fa28-4514-95c5-73b98fe60c69 on topic "discord.score.update.success"
    correct_scores_test.go:291: Successfully received 1 messages on topic "discord.score.update.success"
2025/05/31 08:59:33 Test Case "TestHandleCorrectScoreRequest/Success_-_Correct_score_with_valid_data": Canceling subscription context.
2025/05/31 08:59:33 Test Case "TestHandleCorrectScoreRequest/Success_-_Correct_score_with_valid_data": Waiting for subscriber goroutines to finish.
2025/05/31 08:59:33 Test Case "TestHandleCorrectScoreRequest/Success_-_Correct_score_with_valid_data": Subscriber goroutines finished.
2025/05/31 08:59:33 Running score handler test cleanup...
2025/05/31 08:59:34 Error closing Score module: error closing ScoreRouter: router close timeout
2025/05/31 08:59:34 Score handler router goroutine finished.
2025/05/31 08:59:34 Score handler test cleanup finished.
2025/05/31 08:59:34 Cleaning up test environment...
2025/05/31 08:59:34 Context cancelled.
2025/05/31 08:59:34 EventBus closed.
2025/05/31 08:59:34 NATS connection closed.
2025/05/31 08:59:34 DB connection closed.
2025/05/31 08:59:34  Stopping container: 78713ab159dd
2025/05/31 08:59:36  Container stopped: 78713ab159dd
2025/05/31 08:59:36  Terminating container: 78713ab159dd
2025/05/31 08:59:36  Container terminated: 78713ab159dd
2025/05/31 08:59:36 NATS container terminated.
2025/05/31 08:59:36  Stopping container: 7fffb2baad15
2025/05/31 08:59:37  Container stopped: 7fffb2baad15
2025/05/31 08:59:37  Terminating container: 7fffb2baad15
2025/05/31 08:59:37  Container terminated: 7fffb2baad15
2025/05/31 08:59:37 PostgreSQL container terminated.
2025/05/31 08:59:37 Cleanup complete.
=== RUN   TestHandleCorrectScoreRequest/Failure_-_Score_record_not_found
2025/05/31 08:59:37 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:37  Creating container for image postgres:16-alpine
2025/05/31 08:59:37  Container created: 326d9e5b7e4c
2025/05/31 08:59:37  Starting container: 326d9e5b7e4c
2025/05/31 08:59:39  Container started: 326d9e5b7e4c
2025/05/31 08:59:39  Waiting for container id 326d9e5b7e4c image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007242e0 Strategies:[0xc000594210]}
2025/05/31 08:59:48  Container is ready: 326d9e5b7e4c
2025/05/31 08:59:48 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38845/testdb?sslmode=disable
2025/05/31 08:59:48 Starting NATS container with resource limits...
2025/05/31 08:59:48  Creating container for image nats:2.10-alpine
2025/05/31 08:59:48  Container created: b94b5fd35323
2025/05/31 08:59:48  Starting container: b94b5fd35323
2025/05/31 08:59:50  Container started: b94b5fd35323
2025/05/31 08:59:50  Waiting for container id b94b5fd35323 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000724618 Strategies:[0xc00048d740 0xc000645c20]}
2025/05/31 08:59:54  Container is ready: b94b5fd35323
2025/05/31 08:59:54 NATS container started with resource limits. URL: nats://localhost:38861
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:54 Ran leaderboard migrations group #1
Creating user table...
User table created successfully!
2025/05/31 08:59:54 Ran user migrations group #2
Creating round table...
Round table created successfully!
2025/05/31 08:59:54 Ran round migrations group #3
Creating score table...
Score table created successfully!
2025/05/31 08:59:54 Ran score migrations group #4
2025/05/31 08:59:54 All migrations ran successfully
2025/05/31 08:59:54 newDBServiceWithDB - Registering models
2025/05/31 08:59:54 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:54 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00012c3f8 RoundDB:0xc00012c400 ScoreDB:0xc00012c408 LeaderboardDB:0xc00012c418 db:0xc00067c300}
2025/05/31 08:59:55 Truncating tables: scores
2025/05/31 08:59:55 Truncating tables: scores, users, rounds, leaderboards
    correct_scores_test.go:291: Waiting for 1 messages on topic "discord.score.update.fail" with timeout 5s
2025/05/31 08:59:56 Test received message 8e76e044-e1ab-44f3-b8c6-64a37fb9a028 on topic "discord.score.update.fail"
    correct_scores_test.go:291: Successfully received 1 messages on topic "discord.score.update.fail"
2025/05/31 08:59:56 Test Case "TestHandleCorrectScoreRequest/Failure_-_Score_record_not_found": Canceling subscription context.
2025/05/31 08:59:56 Test Case "TestHandleCorrectScoreRequest/Failure_-_Score_record_not_found": Waiting for subscriber goroutines to finish.
2025/05/31 08:59:56 Test Case "TestHandleCorrectScoreRequest/Failure_-_Score_record_not_found": Subscriber goroutines finished.
2025/05/31 08:59:56 Running score handler test cleanup...
2025/05/31 08:59:57 Error closing Score module: error closing ScoreRouter: router close timeout
2025/05/31 08:59:57 Score handler router goroutine finished.
2025/05/31 08:59:57 Score handler test cleanup finished.
2025/05/31 08:59:57 Cleaning up test environment...
2025/05/31 08:59:57 Context cancelled.
2025/05/31 08:59:57 EventBus closed.
2025/05/31 08:59:57 NATS connection closed.
2025/05/31 08:59:57 DB connection closed.
2025/05/31 08:59:57  Stopping container: b94b5fd35323
2025/05/31 08:59:58  Container stopped: b94b5fd35323
2025/05/31 08:59:58  Terminating container: b94b5fd35323
2025/05/31 08:59:58  Container terminated: b94b5fd35323
2025/05/31 08:59:58 NATS container terminated.
2025/05/31 08:59:58  Stopping container: 326d9e5b7e4c
2025/05/31 08:59:59  Container stopped: 326d9e5b7e4c
2025/05/31 08:59:59  Terminating container: 326d9e5b7e4c
2025/05/31 08:59:59  Container terminated: 326d9e5b7e4c
2025/05/31 08:59:59 PostgreSQL container terminated.
2025/05/31 08:59:59 Cleanup complete.
=== RUN   TestHandleCorrectScoreRequest/Failure_-_Invalid_Score_Value
2025/05/31 08:59:59 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:59  Creating container for image postgres:16-alpine
2025/05/31 09:00:00  Container created: 5193fa1fa29b
2025/05/31 09:00:00  Starting container: 5193fa1fa29b
2025/05/31 09:00:01  Container started: 5193fa1fa29b
2025/05/31 09:00:01  Waiting for container id 5193fa1fa29b image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000725fc8 Strategies:[0xc000512ae0]}
2025/05/31 09:00:08  Container is ready: 5193fa1fa29b
2025/05/31 09:00:08 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38873/testdb?sslmode=disable
2025/05/31 09:00:08 Starting NATS container with resource limits...
2025/05/31 09:00:08  Creating container for image nats:2.10-alpine
2025/05/31 09:00:08  Container created: 74e80f0db022
2025/05/31 09:00:08  Starting container: 74e80f0db022
2025/05/31 09:00:09  Container started: 74e80f0db022
2025/05/31 09:00:09  Waiting for container id 74e80f0db022 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007490f8 Strategies:[0xc0007ef020 0xc000364960]}
2025/05/31 09:00:11  Container is ready: 74e80f0db022
2025/05/31 09:00:11 NATS container started with resource limits. URL: nats://localhost:38892
Creating user table...
User table created successfully!
2025/05/31 09:00:11 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:11 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:11 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:11 Ran leaderboard migrations group #4
2025/05/31 09:00:11 All migrations ran successfully
2025/05/31 09:00:11 newDBServiceWithDB - Registering models
2025/05/31 09:00:11 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:11 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0006461f0 RoundDB:0xc0006461f8 ScoreDB:0xc000646200 LeaderboardDB:0xc000646208 db:0xc00064b600}
2025/05/31 09:00:12 Truncating tables: scores
2025/05/31 09:00:12 Truncating tables: scores, users, rounds, leaderboards
[DEBUG LogScores] Insert/Update Executed for RoundID afdadae1-0816-4bc6-875c-d3bc5ef76a57. Error: <nil>, Result: {Locker:0xc000677b80 resi:1}
    correct_scores_test.go:291: Waiting for 1 messages on topic "discord.score.update.fail" with timeout 5s
2025/05/31 09:00:13 Test received message 1c2c688f-c39b-4c27-abc8-f66314ff1a9c on topic "discord.score.update.fail"
    correct_scores_test.go:291: Successfully received 1 messages on topic "discord.score.update.fail"
2025/05/31 09:00:13 Test Case "TestHandleCorrectScoreRequest/Failure_-_Invalid_Score_Value": Canceling subscription context.
2025/05/31 09:00:13 Test Case "TestHandleCorrectScoreRequest/Failure_-_Invalid_Score_Value": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:13 Test Case "TestHandleCorrectScoreRequest/Failure_-_Invalid_Score_Value": Subscriber goroutines finished.
2025/05/31 09:00:13 Running score handler test cleanup...
2025/05/31 09:00:14 Error closing Score module: error closing ScoreRouter: router close timeout
2025/05/31 09:00:14 Score handler router goroutine finished.
2025/05/31 09:00:14 Score handler test cleanup finished.
2025/05/31 09:00:14 Cleaning up test environment...
2025/05/31 09:00:14 Context cancelled.
2025/05/31 09:00:14 EventBus closed.
2025/05/31 09:00:14 NATS connection closed.
2025/05/31 09:00:14 DB connection closed.
2025/05/31 09:00:14  Stopping container: 74e80f0db022
2025/05/31 09:00:14  Container stopped: 74e80f0db022
2025/05/31 09:00:14  Terminating container: 74e80f0db022
2025/05/31 09:00:15  Container terminated: 74e80f0db022
2025/05/31 09:00:15 NATS container terminated.
2025/05/31 09:00:15  Stopping container: 5193fa1fa29b
2025/05/31 09:00:15  Container stopped: 5193fa1fa29b
2025/05/31 09:00:15  Terminating container: 5193fa1fa29b
2025/05/31 09:00:16  Container terminated: 5193fa1fa29b
2025/05/31 09:00:16 PostgreSQL container terminated.
2025/05/31 09:00:16 Cleanup complete.
=== RUN   TestHandleCorrectScoreRequest/Failure_-_Invalid_Payload_Format
2025/05/31 09:00:16 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:16  Creating container for image postgres:16-alpine
2025/05/31 09:00:16  Container created: d63efba8201f
2025/05/31 09:00:16  Starting container: d63efba8201f
2025/05/31 09:00:17  Container started: d63efba8201f
2025/05/31 09:00:17  Waiting for container id d63efba8201f image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc00038ee18 Strategies:[0xc000488fc0]}
2025/05/31 09:00:22  Container is ready: d63efba8201f
2025/05/31 09:00:22 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38904/testdb?sslmode=disable
2025/05/31 09:00:22 Starting NATS container with resource limits...
2025/05/31 09:00:22  Creating container for image nats:2.10-alpine
2025/05/31 09:00:22  Container created: 80c916fd4b59
2025/05/31 09:00:22  Starting container: 80c916fd4b59
2025/05/31 09:00:23  Container started: 80c916fd4b59
2025/05/31 09:00:23  Waiting for container id 80c916fd4b59 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005f72a0 Strategies:[0xc0006cfe60 0xc000765740]}
2025/05/31 09:00:26  Container is ready: 80c916fd4b59
2025/05/31 09:00:26 NATS container started with resource limits. URL: nats://localhost:38913
Creating score table...
Score table created successfully!
2025/05/31 09:00:26 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:26 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:00:26 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:00:26 Ran round migrations group #4
2025/05/31 09:00:26 All migrations ran successfully
2025/05/31 09:00:26 newDBServiceWithDB - Registering models
2025/05/31 09:00:26 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:26 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0006462e8 RoundDB:0xc0006462f8 ScoreDB:0xc000646308 LeaderboardDB:0xc000646320 db:0xc0002c59c0}
2025/05/31 09:00:27 Truncating tables: scores
2025/05/31 09:00:27 Truncating tables: scores, users, rounds, leaderboards
2025/05/31 09:00:27 Test Case "TestHandleCorrectScoreRequest/Failure_-_Invalid_Payload_Format": Canceling subscription context.
2025/05/31 09:00:27 Test Case "TestHandleCorrectScoreRequest/Failure_-_Invalid_Payload_Format": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:27 Test Case "TestHandleCorrectScoreRequest/Failure_-_Invalid_Payload_Format": Subscriber goroutines finished.
2025/05/31 09:00:27 Running score handler test cleanup...
2025/05/31 09:00:28 Error closing Score module: error closing ScoreRouter: router close timeout
2025/05/31 09:00:28 Score handler router goroutine finished.
2025/05/31 09:00:28 Score handler test cleanup finished.
2025/05/31 09:00:28 Cleaning up test environment...
2025/05/31 09:00:28 Context cancelled.
2025/05/31 09:00:28 EventBus closed.
2025/05/31 09:00:28 NATS connection closed.
2025/05/31 09:00:28 DB connection closed.
2025/05/31 09:00:28  Stopping container: 80c916fd4b59
2025/05/31 09:00:29  Container stopped: 80c916fd4b59
2025/05/31 09:00:29  Terminating container: 80c916fd4b59
2025/05/31 09:00:29  Container terminated: 80c916fd4b59
2025/05/31 09:00:29 NATS container terminated.
2025/05/31 09:00:29  Stopping container: d63efba8201f
2025/05/31 09:00:30  Container stopped: d63efba8201f
2025/05/31 09:00:30  Terminating container: d63efba8201f
2025/05/31 09:00:30  Container terminated: d63efba8201f
2025/05/31 09:00:30 PostgreSQL container terminated.
2025/05/31 09:00:30 Cleanup complete.
--- PASS: TestHandleCorrectScoreRequest (71.72s)
    --- PASS: TestHandleCorrectScoreRequest/Success_-_Correct_score_with_valid_data (18.26s)
    --- PASS: TestHandleCorrectScoreRequest/Failure_-_Score_record_not_found (22.07s)
    --- PASS: TestHandleCorrectScoreRequest/Failure_-_Invalid_Score_Value (16.52s)
    --- PASS: TestHandleCorrectScoreRequest/Failure_-_Invalid_Payload_Format (14.87s)
=== RUN   TestHandleProcessRoundScoresRequest
=== RUN   TestHandleProcessRoundScoresRequest/Success_-_Process_Valid_Round_Scores
2025/05/31 09:00:30 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:30  Creating container for image postgres:16-alpine
2025/05/31 09:00:31  Container created: a20205f8f788
2025/05/31 09:00:31  Starting container: a20205f8f788
2025/05/31 09:00:32  Container started: a20205f8f788
2025/05/31 09:00:32  Waiting for container id a20205f8f788 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc00038f250 Strategies:[0xc00080f230]}
2025/05/31 09:00:37  Container is ready: a20205f8f788
2025/05/31 09:00:37 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38930/testdb?sslmode=disable
2025/05/31 09:00:37 Starting NATS container with resource limits...
2025/05/31 09:00:37  Creating container for image nats:2.10-alpine
2025/05/31 09:00:37  Container created: 68dda34e773a
2025/05/31 09:00:37  Starting container: 68dda34e773a
2025/05/31 09:00:38  Container started: 68dda34e773a
2025/05/31 09:00:38  Waiting for container id 68dda34e773a image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000359f30 Strategies:[0xc0008956e0 0xc00026d0e0]}
2025/05/31 09:00:41  Container is ready: 68dda34e773a
2025/05/31 09:00:41 NATS container started with resource limits. URL: nats://localhost:38941
Creating user table...
User table created successfully!
2025/05/31 09:00:41 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:41 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:41 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:41 Ran leaderboard migrations group #4
2025/05/31 09:00:41 All migrations ran successfully
2025/05/31 09:00:41 newDBServiceWithDB - Registering models
2025/05/31 09:00:41 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:41 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00012c478 RoundDB:0xc00012c480 ScoreDB:0xc00012c488 LeaderboardDB:0xc00012c490 db:0xc00077aac0}
2025/05/31 09:00:42 Truncating tables: scores
2025/05/31 09:00:42 Truncating tables: scores, users, rounds, leaderboards
    process_scores_test.go:273: Waiting for 1 messages on topic "leaderboard.batch.tag.assignment.requested" with timeout 10s
[DEBUG LogScores] Insert/Update Executed for RoundID 63893399-c835-4fb4-8f8d-665f2c585589. Error: <nil>, Result: {Locker:0xc0006b5100 resi:1}
2025/05/31 09:00:43 Test received message 96d51dd7-b6d9-466b-806b-251af8069bba on topic "leaderboard.batch.tag.assignment.requested"
    process_scores_test.go:273: Successfully received 1 messages on topic "leaderboard.batch.tag.assignment.requested"
2025/05/31 09:00:43 Test Case "TestHandleProcessRoundScoresRequest/Success_-_Process_Valid_Round_Scores": Canceling subscription context.
2025/05/31 09:00:43 Test Case "TestHandleProcessRoundScoresRequest/Success_-_Process_Valid_Round_Scores": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:43 Test Case "TestHandleProcessRoundScoresRequest/Success_-_Process_Valid_Round_Scores": Subscriber goroutines finished.
2025/05/31 09:00:43 Running score handler test cleanup...
2025/05/31 09:00:44 Error closing Score module: error closing ScoreRouter: router close timeout
2025/05/31 09:00:44 Score handler router goroutine finished.
2025/05/31 09:00:44 Score handler test cleanup finished.
2025/05/31 09:00:44 Cleaning up test environment...
2025/05/31 09:00:44 Context cancelled.
2025/05/31 09:00:44 EventBus closed.
2025/05/31 09:00:44 NATS connection closed.
2025/05/31 09:00:44 DB connection closed.
2025/05/31 09:00:44  Stopping container: 68dda34e773a
2025/05/31 09:00:44  Container stopped: 68dda34e773a
2025/05/31 09:00:44  Terminating container: 68dda34e773a
2025/05/31 09:00:44  Container terminated: 68dda34e773a
2025/05/31 09:00:44 NATS container terminated.
2025/05/31 09:00:44  Stopping container: a20205f8f788
2025/05/31 09:00:45  Container stopped: a20205f8f788
2025/05/31 09:00:45  Terminating container: a20205f8f788
2025/05/31 09:00:45  Container terminated: a20205f8f788
2025/05/31 09:00:45 PostgreSQL container terminated.
2025/05/31 09:00:45 Cleanup complete.
=== RUN   TestHandleProcessRoundScoresRequest/Failure_-_Empty_Scores_List
2025/05/31 09:00:45 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:45  Creating container for image postgres:16-alpine
2025/05/31 09:00:45  Container created: 63b1b236f274
2025/05/31 09:00:45  Starting container: 63b1b236f274
2025/05/31 09:00:46  Container started: 63b1b236f274
2025/05/31 09:00:46  Waiting for container id 63b1b236f274 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0004adeb8 Strategies:[0xc00059b7a0]}
2025/05/31 09:00:51  Container is ready: 63b1b236f274
2025/05/31 09:00:51 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38957/testdb?sslmode=disable
2025/05/31 09:00:51 Starting NATS container with resource limits...
2025/05/31 09:00:51  Creating container for image nats:2.10-alpine
2025/05/31 09:00:51  Container created: e56aca76cb75
2025/05/31 09:00:51  Starting container: e56aca76cb75
2025/05/31 09:00:52  Container started: e56aca76cb75
2025/05/31 09:00:52  Waiting for container id e56aca76cb75 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0009917a0 Strategies:[0xc0007efb00 0xc000945110]}
2025/05/31 09:00:53  Container is ready: e56aca76cb75
2025/05/31 09:00:54 NATS container started with resource limits. URL: nats://localhost:38964
Creating score table...
Score table created successfully!
2025/05/31 09:00:54 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:54 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:00:54 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:00:54 Ran round migrations group #4
2025/05/31 09:00:54 All migrations ran successfully
2025/05/31 09:00:54 newDBServiceWithDB - Registering models
2025/05/31 09:00:54 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:54 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0002824a8 RoundDB:0xc0002824b0 ScoreDB:0xc0002824b8 LeaderboardDB:0xc0002824c0 db:0xc00067c0c0}
2025/05/31 09:00:54 Truncating tables: scores
2025/05/31 09:00:54 Truncating tables: scores, users, rounds, leaderboards
    process_scores_test.go:273: Waiting for 1 messages on topic "score.process.round.scores.fail" with timeout 5s
2025/05/31 09:00:55 Test received message 108dfbc8-d0ac-4b7d-b008-59f906236e0b on topic "score.process.round.scores.fail"
    process_scores_test.go:273: Successfully received 1 messages on topic "score.process.round.scores.fail"
2025/05/31 09:00:55 Test Case "TestHandleProcessRoundScoresRequest/Failure_-_Empty_Scores_List": Canceling subscription context.
2025/05/31 09:00:55 Test Case "TestHandleProcessRoundScoresRequest/Failure_-_Empty_Scores_List": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:55 Test Case "TestHandleProcessRoundScoresRequest/Failure_-_Empty_Scores_List": Subscriber goroutines finished.
2025/05/31 09:00:55 Running score handler test cleanup...
2025/05/31 09:00:56 Error closing Score module: error closing ScoreRouter: router close timeout
2025/05/31 09:00:56 Score handler router goroutine finished.
2025/05/31 09:00:56 Score handler test cleanup finished.
2025/05/31 09:00:56 Cleaning up test environment...
2025/05/31 09:00:56 Context cancelled.
2025/05/31 09:00:56 EventBus closed.
2025/05/31 09:00:56 NATS connection closed.
2025/05/31 09:00:56 DB connection closed.
2025/05/31 09:00:56  Stopping container: e56aca76cb75
2025/05/31 09:00:57  Container stopped: e56aca76cb75
2025/05/31 09:00:57  Terminating container: e56aca76cb75
2025/05/31 09:00:57  Container terminated: e56aca76cb75
2025/05/31 09:00:57 NATS container terminated.
2025/05/31 09:00:57  Stopping container: 63b1b236f274
2025/05/31 09:00:57  Container stopped: 63b1b236f274
2025/05/31 09:00:57  Terminating container: 63b1b236f274
2025/05/31 09:00:57  Container terminated: 63b1b236f274
2025/05/31 09:00:57 PostgreSQL container terminated.
2025/05/31 09:00:57 Cleanup complete.
=== RUN   TestHandleProcessRoundScoresRequest/Failure_-_Invalid_Message_Payload
2025/05/31 09:00:57 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:57  Creating container for image postgres:16-alpine
2025/05/31 09:00:58  Container created: 8d755c77b4f6
2025/05/31 09:00:58  Starting container: 8d755c77b4f6
2025/05/31 09:00:58  Container started: 8d755c77b4f6
2025/05/31 09:00:58  Waiting for container id 8d755c77b4f6 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000770148 Strategies:[0xc000989890]}
2025/05/31 09:01:02  Container is ready: 8d755c77b4f6
2025/05/31 09:01:02 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38981/testdb?sslmode=disable
2025/05/31 09:01:02 Starting NATS container with resource limits...
2025/05/31 09:01:02  Creating container for image nats:2.10-alpine
2025/05/31 09:01:02  Container created: 43b11480cf98
2025/05/31 09:01:02  Starting container: 43b11480cf98
2025/05/31 09:01:03  Container started: 43b11480cf98
2025/05/31 09:01:03  Waiting for container id 43b11480cf98 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000990098 Strategies:[0xc0008411a0 0xc000488d50]}
2025/05/31 09:01:05  Container is ready: 43b11480cf98
2025/05/31 09:01:05 NATS container started with resource limits. URL: nats://localhost:38986
Creating score table...
Score table created successfully!
2025/05/31 09:01:05 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:05 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:01:05 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:01:05 Ran round migrations group #4
2025/05/31 09:01:05 All migrations ran successfully
2025/05/31 09:01:05 newDBServiceWithDB - Registering models
2025/05/31 09:01:05 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:05 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007c2b8 RoundDB:0xc00007c2c0 ScoreDB:0xc00007c2c8 LeaderboardDB:0xc00007c328 db:0xc000b22b40}
2025/05/31 09:01:05 Truncating tables: scores
2025/05/31 09:01:05 Truncating tables: scores, users, rounds, leaderboards
2025/05/31 09:01:06 Test Case "TestHandleProcessRoundScoresRequest/Failure_-_Invalid_Message_Payload": Canceling subscription context.
2025/05/31 09:01:06 Test Case "TestHandleProcessRoundScoresRequest/Failure_-_Invalid_Message_Payload": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:06 Test Case "TestHandleProcessRoundScoresRequest/Failure_-_Invalid_Message_Payload": Subscriber goroutines finished.
2025/05/31 09:01:06 Running score handler test cleanup...
2025/05/31 09:01:07 Error closing Score module: error closing ScoreRouter: router close timeout
2025/05/31 09:01:07 Score handler router goroutine finished.
2025/05/31 09:01:07 Score handler test cleanup finished.
2025/05/31 09:01:07 Cleaning up test environment...
2025/05/31 09:01:07 Context cancelled.
2025/05/31 09:01:07 EventBus closed.
2025/05/31 09:01:07 NATS connection closed.
2025/05/31 09:01:07 DB connection closed.
2025/05/31 09:01:07  Stopping container: 43b11480cf98
2025/05/31 09:01:08  Container stopped: 43b11480cf98
2025/05/31 09:01:08  Terminating container: 43b11480cf98
2025/05/31 09:01:08  Container terminated: 43b11480cf98
2025/05/31 09:01:08 NATS container terminated.
2025/05/31 09:01:08  Stopping container: 8d755c77b4f6
2025/05/31 09:01:08  Container stopped: 8d755c77b4f6
2025/05/31 09:01:08  Terminating container: 8d755c77b4f6
2025/05/31 09:01:09  Container terminated: 8d755c77b4f6
2025/05/31 09:01:09 PostgreSQL container terminated.
2025/05/31 09:01:09 Cleanup complete.
--- PASS: TestHandleProcessRoundScoresRequest (38.15s)
    --- PASS: TestHandleProcessRoundScoresRequest/Success_-_Process_Valid_Round_Scores (14.73s)
    --- PASS: TestHandleProcessRoundScoresRequest/Failure_-_Empty_Scores_List (12.18s)
    --- PASS: TestHandleProcessRoundScoresRequest/Failure_-_Invalid_Message_Payload (11.24s)
PASS
coverage: 5.4% of statements in ./app/...
2025/05/31 09:01:09 TestMain: finished with exit code: 0
ok  	github.com/Black-And-White-Club/frolf-bot/integration_tests/modules/score/handler_tests	114.001s	coverage: 5.4% of statements in ./app/...
2025/05/31 08:59:18 TestMain started in package userintegrationtests
=== RUN   TestCreateUser
=== RUN   TestCreateUser/Success_-_Valid_user_creation
2025/05/31 08:59:18 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:18 github.com/testcontainers/testcontainers-go - Connected to docker: 
  Server Version: 28.1.1
  API Version: 1.48
  Operating System: Ubuntu 24.04.1 LTS
  Total Memory: 5923 MB
  Testcontainers for Go Version: v0.37.0
  Resolved Docker Host: unix:///Users/jace/.colima/default/docker.sock
  Resolved Docker Socket Path: /var/run/docker.sock
  Test SessionID: 3bcca53efbc96e46a6c192358bf7642f396e27e5bff8699ef9bf67ff02cc0815
  Test ProcessID: 0da612de-d936-4a72-bce7-5faa96c3bb78
2025/05/31 08:59:18  Creating container for image postgres:16-alpine
2025/05/31 08:59:18  Waiting for Reaper "f69f8f9c" to be ready
2025/05/31 08:59:18  Reaper obtained from Docker for this test session f69f8f9c
2025/05/31 08:59:18  Container created: c526ff6166c5
2025/05/31 08:59:18  Starting container: c526ff6166c5
2025/05/31 08:59:20  Container started: c526ff6166c5
2025/05/31 08:59:20  Waiting for container id c526ff6166c5 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000591510 Strategies:[0xc0004526f0]}
2025/05/31 08:59:29  Container is ready: c526ff6166c5
2025/05/31 08:59:29 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38815/testdb?sslmode=disable
2025/05/31 08:59:29 Starting NATS container with resource limits...
2025/05/31 08:59:29  Creating container for image nats:2.10-alpine
2025/05/31 08:59:29  Container created: 1962f21a646f
2025/05/31 08:59:29  Starting container: 1962f21a646f
2025/05/31 08:59:31  Container started: 1962f21a646f
2025/05/31 08:59:31  Waiting for container id 1962f21a646f image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000636a30 Strategies:[0xc00064a660 0xc0006634d0]}
2025/05/31 08:59:32  Container is ready: 1962f21a646f
2025/05/31 08:59:32 NATS container started with resource limits. URL: nats://localhost:38830
Creating user table...
User table created successfully!
2025/05/31 08:59:32 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 08:59:32 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 08:59:32 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:32 Ran leaderboard migrations group #4
2025/05/31 08:59:32 All migrations ran successfully
2025/05/31 08:59:32 newDBServiceWithDB - Registering models
2025/05/31 08:59:32 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:32 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00011e3f0 RoundDB:0xc00011e408 ScoreDB:0xc00011e418 LeaderboardDB:0xc00011e428 db:0xc0004c4480}
2025/05/31 08:59:33 Truncating tables: users
2025/05/31 08:59:33 Truncating tables: users
2025/05/31 08:59:33 Truncating tables: users
2025/05/31 08:59:33 Cleaning up test environment...
2025/05/31 08:59:33 Context cancelled.
2025/05/31 08:59:33 EventBus closed.
2025/05/31 08:59:33 NATS connection closed.
2025/05/31 08:59:33 DB connection closed.
2025/05/31 08:59:33  Stopping container: 1962f21a646f
2025/05/31 08:59:34  Container stopped: 1962f21a646f
2025/05/31 08:59:34  Terminating container: 1962f21a646f
2025/05/31 08:59:34  Container terminated: 1962f21a646f
2025/05/31 08:59:34 NATS container terminated.
2025/05/31 08:59:34  Stopping container: c526ff6166c5
2025/05/31 08:59:35  Container stopped: c526ff6166c5
2025/05/31 08:59:35  Terminating container: c526ff6166c5
2025/05/31 08:59:35  Container terminated: c526ff6166c5
2025/05/31 08:59:35 PostgreSQL container terminated.
2025/05/31 08:59:35 Cleanup complete.
=== RUN   TestCreateUser/Failure_-_Empty_Discord_ID
2025/05/31 08:59:35 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:35  Creating container for image postgres:16-alpine
2025/05/31 08:59:36  Container created: 80912991093f
2025/05/31 08:59:36  Starting container: 80912991093f
2025/05/31 08:59:37  Container started: 80912991093f
2025/05/31 08:59:37  Waiting for container id 80912991093f image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007a4090 Strategies:[0xc0005d4720]}
2025/05/31 08:59:46  Container is ready: 80912991093f
2025/05/31 08:59:46 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38843/testdb?sslmode=disable
2025/05/31 08:59:46 Starting NATS container with resource limits...
2025/05/31 08:59:46  Creating container for image nats:2.10-alpine
2025/05/31 08:59:46  Container created: 46a6ada7bca3
2025/05/31 08:59:46  Starting container: 46a6ada7bca3
2025/05/31 08:59:48  Container started: 46a6ada7bca3
2025/05/31 08:59:48  Waiting for container id 46a6ada7bca3 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007a4e40 Strategies:[0xc0006994a0 0xc000293170]}
2025/05/31 08:59:50  Container is ready: 46a6ada7bca3
2025/05/31 08:59:50 NATS container started with resource limits. URL: nats://localhost:38851
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:50 Ran leaderboard migrations group #1
Creating user table...
User table created successfully!
2025/05/31 08:59:50 Ran user migrations group #2
Creating round table...
Round table created successfully!
2025/05/31 08:59:50 Ran round migrations group #3
Creating score table...
Score table created successfully!
2025/05/31 08:59:50 Ran score migrations group #4
2025/05/31 08:59:50 All migrations ran successfully
2025/05/31 08:59:50 newDBServiceWithDB - Registering models
2025/05/31 08:59:50 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:50 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00011e470 RoundDB:0xc00011e478 ScoreDB:0xc00011e480 LeaderboardDB:0xc00011e488 db:0xc00042b500}
2025/05/31 08:59:51 Truncating tables: users
2025/05/31 08:59:51 Truncating tables: users
2025/05/31 08:59:51 Truncating tables: users
2025/05/31 08:59:51 Cleaning up test environment...
2025/05/31 08:59:51 Context cancelled.
2025/05/31 08:59:51 EventBus closed.
2025/05/31 08:59:51 NATS connection closed.
2025/05/31 08:59:51 DB connection closed.
2025/05/31 08:59:51  Stopping container: 46a6ada7bca3
2025/05/31 08:59:51  Container stopped: 46a6ada7bca3
2025/05/31 08:59:51  Terminating container: 46a6ada7bca3
2025/05/31 08:59:51  Container terminated: 46a6ada7bca3
2025/05/31 08:59:51 NATS container terminated.
2025/05/31 08:59:51  Stopping container: 80912991093f
2025/05/31 08:59:52  Container stopped: 80912991093f
2025/05/31 08:59:52  Terminating container: 80912991093f
2025/05/31 08:59:52  Container terminated: 80912991093f
2025/05/31 08:59:52 PostgreSQL container terminated.
2025/05/31 08:59:52 Cleanup complete.
=== RUN   TestCreateUser/Failure_-_Negative_tag_number
2025/05/31 08:59:52 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:52  Creating container for image postgres:16-alpine
2025/05/31 08:59:52  Container created: 1c3e52d46338
2025/05/31 08:59:52  Starting container: 1c3e52d46338
2025/05/31 08:59:53  Container started: 1c3e52d46338
2025/05/31 08:59:53  Waiting for container id 1c3e52d46338 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc00011bca8 Strategies:[0xc0005dcb40]}
2025/05/31 09:00:00  Container is ready: 1c3e52d46338
2025/05/31 09:00:00 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38867/testdb?sslmode=disable
2025/05/31 09:00:00 Starting NATS container with resource limits...
2025/05/31 09:00:00  Creating container for image nats:2.10-alpine
2025/05/31 09:00:00  Container created: 1e91aed9bce8
2025/05/31 09:00:00  Starting container: 1e91aed9bce8
2025/05/31 09:00:01  Container started: 1e91aed9bce8
2025/05/31 09:00:01  Waiting for container id 1e91aed9bce8 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00044f130 Strategies:[0xc0004653e0 0xc000470060]}
2025/05/31 09:00:02  Container is ready: 1e91aed9bce8
2025/05/31 09:00:02 NATS container started with resource limits. URL: nats://localhost:38874
Creating user table...
User table created successfully!
2025/05/31 09:00:02 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:02 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:02 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:02 Ran leaderboard migrations group #4
2025/05/31 09:00:02 All migrations ran successfully
2025/05/31 09:00:02 newDBServiceWithDB - Registering models
2025/05/31 09:00:02 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:02 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0002700c0 RoundDB:0xc0002700c8 ScoreDB:0xc0002700d0 LeaderboardDB:0xc0002700e8 db:0xc00060e680}
2025/05/31 09:00:02 Truncating tables: users
2025/05/31 09:00:02 Truncating tables: users
2025/05/31 09:00:02 Truncating tables: users
2025/05/31 09:00:02 Cleaning up test environment...
2025/05/31 09:00:02 Context cancelled.
2025/05/31 09:00:02 EventBus closed.
2025/05/31 09:00:02 NATS connection closed.
2025/05/31 09:00:02 DB connection closed.
2025/05/31 09:00:02  Stopping container: 1e91aed9bce8
2025/05/31 09:00:03  Container stopped: 1e91aed9bce8
2025/05/31 09:00:03  Terminating container: 1e91aed9bce8
2025/05/31 09:00:03  Container terminated: 1e91aed9bce8
2025/05/31 09:00:03 NATS container terminated.
2025/05/31 09:00:03  Stopping container: 1c3e52d46338
2025/05/31 09:00:04  Container stopped: 1c3e52d46338
2025/05/31 09:00:04  Terminating container: 1c3e52d46338
2025/05/31 09:00:04  Container terminated: 1c3e52d46338
2025/05/31 09:00:04 PostgreSQL container terminated.
2025/05/31 09:00:04 Cleanup complete.
=== RUN   TestCreateUser/Success_-_Nil_tag_number
2025/05/31 09:00:04 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:04  Creating container for image postgres:16-alpine
2025/05/31 09:00:05  Container created: c88e1b4fe36d
2025/05/31 09:00:05  Starting container: c88e1b4fe36d
2025/05/31 09:00:06  Container started: c88e1b4fe36d
2025/05/31 09:00:06  Waiting for container id c88e1b4fe36d image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007a5278 Strategies:[0xc000529b00]}
2025/05/31 09:00:11  Container is ready: c88e1b4fe36d
2025/05/31 09:00:11 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38884/testdb?sslmode=disable
2025/05/31 09:00:11 Starting NATS container with resource limits...
2025/05/31 09:00:11  Creating container for image nats:2.10-alpine
2025/05/31 09:00:11  Container created: 0a24f3f3e349
2025/05/31 09:00:11  Starting container: 0a24f3f3e349
2025/05/31 09:00:12  Container started: 0a24f3f3e349
2025/05/31 09:00:12  Waiting for container id 0a24f3f3e349 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0006376b8 Strategies:[0xc000698ea0 0xc000452510]}
2025/05/31 09:00:14  Container is ready: 0a24f3f3e349
2025/05/31 09:00:14 NATS container started with resource limits. URL: nats://localhost:38896
Creating user table...
User table created successfully!
2025/05/31 09:00:14 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:14 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:14 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:14 Ran leaderboard migrations group #4
2025/05/31 09:00:14 All migrations ran successfully
2025/05/31 09:00:14 newDBServiceWithDB - Registering models
2025/05/31 09:00:14 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:14 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0002700d0 RoundDB:0xc0002700e8 ScoreDB:0xc0002700f0 LeaderboardDB:0xc0002700f8 db:0xc000504180}
2025/05/31 09:00:15 Truncating tables: users
2025/05/31 09:00:15 Truncating tables: users
2025/05/31 09:00:15 Truncating tables: users
2025/05/31 09:00:15 Cleaning up test environment...
2025/05/31 09:00:15 Context cancelled.
2025/05/31 09:00:15 EventBus closed.
2025/05/31 09:00:15 NATS connection closed.
2025/05/31 09:00:15 DB connection closed.
2025/05/31 09:00:15  Stopping container: 0a24f3f3e349
2025/05/31 09:00:16  Container stopped: 0a24f3f3e349
2025/05/31 09:00:16  Terminating container: 0a24f3f3e349
2025/05/31 09:00:16  Container terminated: 0a24f3f3e349
2025/05/31 09:00:16 NATS container terminated.
2025/05/31 09:00:16  Stopping container: c88e1b4fe36d
2025/05/31 09:00:17  Container stopped: c88e1b4fe36d
2025/05/31 09:00:17  Terminating container: c88e1b4fe36d
2025/05/31 09:00:17  Container terminated: c88e1b4fe36d
2025/05/31 09:00:17 PostgreSQL container terminated.
2025/05/31 09:00:17 Cleanup complete.
=== RUN   TestCreateUser/Failure_-_Nil_context
=== RUN   TestCreateUser/Success_-_Large_tag_number
2025/05/31 09:00:17 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:17  Creating container for image postgres:16-alpine
2025/05/31 09:00:17  Container created: 13a1bbad77ef
2025/05/31 09:00:17  Starting container: 13a1bbad77ef
2025/05/31 09:00:18  Container started: 13a1bbad77ef
2025/05/31 09:00:18  Waiting for container id 13a1bbad77ef image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000311c60 Strategies:[0xc0004533b0]}
2025/05/31 09:00:23  Container is ready: 13a1bbad77ef
2025/05/31 09:00:23 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38906/testdb?sslmode=disable
2025/05/31 09:00:23 Starting NATS container with resource limits...
2025/05/31 09:00:23  Creating container for image nats:2.10-alpine
2025/05/31 09:00:23  Container created: fb94045770e4
2025/05/31 09:00:23  Starting container: fb94045770e4
2025/05/31 09:00:24  Container started: fb94045770e4
2025/05/31 09:00:24  Waiting for container id fb94045770e4 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00044f2d8 Strategies:[0xc000805740 0xc0007f2180]}
2025/05/31 09:00:26  Container is ready: fb94045770e4
2025/05/31 09:00:26 NATS container started with resource limits. URL: nats://localhost:38916
Creating score table...
Score table created successfully!
2025/05/31 09:00:26 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:26 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:00:26 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:00:26 Ran round migrations group #4
2025/05/31 09:00:26 All migrations ran successfully
2025/05/31 09:00:26 newDBServiceWithDB - Registering models
2025/05/31 09:00:26 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:26 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005c4338 RoundDB:0xc0005c4340 ScoreDB:0xc0005c4348 LeaderboardDB:0xc0005c4350 db:0xc00005f1c0}
2025/05/31 09:00:26 Truncating tables: users
2025/05/31 09:00:26 Truncating tables: users
2025/05/31 09:00:26 Truncating tables: users
2025/05/31 09:00:26 Cleaning up test environment...
2025/05/31 09:00:26 Context cancelled.
2025/05/31 09:00:26 EventBus closed.
2025/05/31 09:00:26 NATS connection closed.
2025/05/31 09:00:26 DB connection closed.
2025/05/31 09:00:26  Stopping container: fb94045770e4
2025/05/31 09:00:27  Container stopped: fb94045770e4
2025/05/31 09:00:27  Terminating container: fb94045770e4
2025/05/31 09:00:27  Container terminated: fb94045770e4
2025/05/31 09:00:27 NATS container terminated.
2025/05/31 09:00:27  Stopping container: 13a1bbad77ef
2025/05/31 09:00:27  Container stopped: 13a1bbad77ef
2025/05/31 09:00:27  Terminating container: 13a1bbad77ef
2025/05/31 09:00:28  Container terminated: 13a1bbad77ef
2025/05/31 09:00:28 PostgreSQL container terminated.
2025/05/31 09:00:28 Cleanup complete.
=== RUN   TestCreateUser/Failure_-_User_already_exists
2025/05/31 09:00:28 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:28  Creating container for image postgres:16-alpine
2025/05/31 09:00:28  Container created: 85b909d4e6fb
2025/05/31 09:00:28  Starting container: 85b909d4e6fb
2025/05/31 09:00:28  Container started: 85b909d4e6fb
2025/05/31 09:00:28  Waiting for container id 85b909d4e6fb image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000311098 Strategies:[0xc000314450]}
2025/05/31 09:00:33  Container is ready: 85b909d4e6fb
2025/05/31 09:00:33 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38927/testdb?sslmode=disable
2025/05/31 09:00:33 Starting NATS container with resource limits...
2025/05/31 09:00:33  Creating container for image nats:2.10-alpine
2025/05/31 09:00:33  Container created: 664220f14002
2025/05/31 09:00:33  Starting container: 664220f14002
2025/05/31 09:00:34  Container started: 664220f14002
2025/05/31 09:00:34  Waiting for container id 664220f14002 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007a4b88 Strategies:[0xc0004c6960 0xc0006cc420]}
2025/05/31 09:00:35  Container is ready: 664220f14002
2025/05/31 09:00:35 NATS container started with resource limits. URL: nats://localhost:38935
Creating round table...
Round table created successfully!
2025/05/31 09:00:35 Ran round migrations group #1
Creating score table...
Score table created successfully!
2025/05/31 09:00:35 Ran score migrations group #2
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:35 Ran leaderboard migrations group #3
Creating user table...
User table created successfully!
2025/05/31 09:00:35 Ran user migrations group #4
2025/05/31 09:00:35 All migrations ran successfully
2025/05/31 09:00:35 newDBServiceWithDB - Registering models
2025/05/31 09:00:35 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:35 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005c43a0 RoundDB:0xc0005c43a8 ScoreDB:0xc0005c43b0 LeaderboardDB:0xc0005c43b8 db:0xc0004c4980}
2025/05/31 09:00:36 Truncating tables: users
2025/05/31 09:00:36 Truncating tables: users
2025/05/31 09:00:36 Truncating tables: users
2025/05/31 09:00:36 Cleaning up test environment...
2025/05/31 09:00:36 Context cancelled.
2025/05/31 09:00:36 EventBus closed.
2025/05/31 09:00:36 NATS connection closed.
2025/05/31 09:00:36 DB connection closed.
2025/05/31 09:00:36  Stopping container: 664220f14002
2025/05/31 09:00:37  Container stopped: 664220f14002
2025/05/31 09:00:37  Terminating container: 664220f14002
2025/05/31 09:00:37  Container terminated: 664220f14002
2025/05/31 09:00:37 NATS container terminated.
2025/05/31 09:00:37  Stopping container: 85b909d4e6fb
2025/05/31 09:00:37  Container stopped: 85b909d4e6fb
2025/05/31 09:00:37  Terminating container: 85b909d4e6fb
2025/05/31 09:00:37  Container terminated: 85b909d4e6fb
2025/05/31 09:00:37 PostgreSQL container terminated.
2025/05/31 09:00:37 Cleanup complete.
--- PASS: TestCreateUser (79.20s)
    --- PASS: TestCreateUser/Success_-_Valid_user_creation (17.48s)
    --- PASS: TestCreateUser/Failure_-_Empty_Discord_ID (16.63s)
    --- PASS: TestCreateUser/Failure_-_Negative_tag_number (12.17s)
    --- PASS: TestCreateUser/Success_-_Nil_tag_number (12.76s)
    --- PASS: TestCreateUser/Failure_-_Nil_context (0.00s)
    --- PASS: TestCreateUser/Success_-_Large_tag_number (10.54s)
    --- PASS: TestCreateUser/Failure_-_User_already_exists (9.62s)
=== RUN   TestGetUser
=== RUN   TestGetUser/Success_-_User_exists
2025/05/31 09:00:37 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:37  Creating container for image postgres:16-alpine
2025/05/31 09:00:37  Container created: baf4a4c5e580
2025/05/31 09:00:38  Starting container: baf4a4c5e580
2025/05/31 09:00:38  Container started: baf4a4c5e580
2025/05/31 09:00:38  Waiting for container id baf4a4c5e580 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000601400 Strategies:[0xc000663650]}
2025/05/31 09:00:41  Container is ready: baf4a4c5e580
2025/05/31 09:00:41 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38945/testdb?sslmode=disable
2025/05/31 09:00:41 Starting NATS container with resource limits...
2025/05/31 09:00:41  Creating container for image nats:2.10-alpine
2025/05/31 09:00:42  Container created: 499f7ce5c91e
2025/05/31 09:00:42  Starting container: 499f7ce5c91e
2025/05/31 09:00:43  Container started: 499f7ce5c91e
2025/05/31 09:00:43  Waiting for container id 499f7ce5c91e image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00044e058 Strategies:[0xc00013f1a0 0xc0003156e0]}
2025/05/31 09:00:44  Container is ready: 499f7ce5c91e
2025/05/31 09:00:44 NATS container started with resource limits. URL: nats://localhost:38950
Creating user table...
User table created successfully!
2025/05/31 09:00:44 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:44 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:44 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:44 Ran leaderboard migrations group #4
2025/05/31 09:00:44 All migrations ran successfully
2025/05/31 09:00:44 newDBServiceWithDB - Registering models
2025/05/31 09:00:44 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:44 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00011e4f0 RoundDB:0xc00011e4f8 ScoreDB:0xc00011e500 LeaderboardDB:0xc00011e508 db:0xc0007edb40}
2025/05/31 09:00:44 Truncating tables: users
2025/05/31 09:00:44 Truncating tables: users
2025/05/31 09:00:44 Truncating tables: users
2025/05/31 09:00:44 Cleaning up test environment...
2025/05/31 09:00:44 Context cancelled.
2025/05/31 09:00:44 EventBus closed.
2025/05/31 09:00:44 NATS connection closed.
2025/05/31 09:00:44 DB connection closed.
2025/05/31 09:00:44  Stopping container: 499f7ce5c91e
2025/05/31 09:00:45  Container stopped: 499f7ce5c91e
2025/05/31 09:00:45  Terminating container: 499f7ce5c91e
2025/05/31 09:00:45  Container terminated: 499f7ce5c91e
2025/05/31 09:00:45 NATS container terminated.
2025/05/31 09:00:45  Stopping container: baf4a4c5e580
2025/05/31 09:00:46  Container stopped: baf4a4c5e580
2025/05/31 09:00:46  Terminating container: baf4a4c5e580
2025/05/31 09:00:46  Container terminated: baf4a4c5e580
2025/05/31 09:00:46 PostgreSQL container terminated.
2025/05/31 09:00:46 Cleanup complete.
=== RUN   TestGetUser/Failure_-_User_does_not_exist
2025/05/31 09:00:46 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:46  Creating container for image postgres:16-alpine
2025/05/31 09:00:46  Container created: 0ad9853850b7
2025/05/31 09:00:46  Starting container: 0ad9853850b7
2025/05/31 09:00:47  Container started: 0ad9853850b7
2025/05/31 09:00:47  Waiting for container id 0ad9853850b7 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005f60d0 Strategies:[0xc000292e10]}
2025/05/31 09:00:51  Container is ready: 0ad9853850b7
2025/05/31 09:00:51 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38959/testdb?sslmode=disable
2025/05/31 09:00:51 Starting NATS container with resource limits...
2025/05/31 09:00:51  Creating container for image nats:2.10-alpine
2025/05/31 09:00:52  Container created: db3e033770d8
2025/05/31 09:00:52  Starting container: db3e033770d8
2025/05/31 09:00:52  Container started: db3e033770d8
2025/05/31 09:00:52  Waiting for container id db3e033770d8 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0003819d0 Strategies:[0xc00013f860 0xc000663860]}
2025/05/31 09:00:56  Container is ready: db3e033770d8
2025/05/31 09:00:56 NATS container started with resource limits. URL: nats://localhost:38970
Creating score table...
Score table created successfully!
2025/05/31 09:00:56 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:56 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:00:56 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:00:56 Ran round migrations group #4
2025/05/31 09:00:56 All migrations ran successfully
2025/05/31 09:00:56 newDBServiceWithDB - Registering models
2025/05/31 09:00:56 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:56 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005c4138 RoundDB:0xc0005c4160 ScoreDB:0xc0005c4170 LeaderboardDB:0xc0005c4178 db:0xc00005f480}
2025/05/31 09:00:56 Truncating tables: users
2025/05/31 09:00:56 Truncating tables: users
2025/05/31 09:00:56 Truncating tables: users
2025/05/31 09:00:56 Truncating tables: users
2025/05/31 09:00:56 Cleaning up test environment...
2025/05/31 09:00:56 Context cancelled.
2025/05/31 09:00:56 EventBus closed.
2025/05/31 09:00:56 NATS connection closed.
2025/05/31 09:00:56 DB connection closed.
2025/05/31 09:00:56  Stopping container: db3e033770d8
2025/05/31 09:00:57  Container stopped: db3e033770d8
2025/05/31 09:00:57  Terminating container: db3e033770d8
2025/05/31 09:00:57  Container terminated: db3e033770d8
2025/05/31 09:00:57 NATS container terminated.
2025/05/31 09:00:57  Stopping container: 0ad9853850b7
2025/05/31 09:00:57  Container stopped: 0ad9853850b7
2025/05/31 09:00:57  Terminating container: 0ad9853850b7
2025/05/31 09:00:57  Container terminated: 0ad9853850b7
2025/05/31 09:00:57 PostgreSQL container terminated.
2025/05/31 09:00:57 Cleanup complete.
=== RUN   TestGetUser/Failure_-_Empty_Discord_ID
2025/05/31 09:00:57 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:57  Creating container for image postgres:16-alpine
2025/05/31 09:00:58  Container created: 96a49495fb13
2025/05/31 09:00:58  Starting container: 96a49495fb13
2025/05/31 09:00:58  Container started: 96a49495fb13
2025/05/31 09:00:58  Waiting for container id 96a49495fb13 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000013cd8 Strategies:[0xc000603110]}
2025/05/31 09:01:02  Container is ready: 96a49495fb13
2025/05/31 09:01:02 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38982/testdb?sslmode=disable
2025/05/31 09:01:02 Starting NATS container with resource limits...
2025/05/31 09:01:02  Creating container for image nats:2.10-alpine
2025/05/31 09:01:02  Container created: fb4dbee035a6
2025/05/31 09:01:02  Starting container: fb4dbee035a6
2025/05/31 09:01:03  Container started: fb4dbee035a6
2025/05/31 09:01:03  Waiting for container id fb4dbee035a6 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000600708 Strategies:[0xc00070a5a0 0xc000663bc0]}
2025/05/31 09:01:05  Container is ready: fb4dbee035a6
2025/05/31 09:01:05 NATS container started with resource limits. URL: nats://localhost:38990
Creating user table...
User table created successfully!
2025/05/31 09:01:05 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:05 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:05 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:05 Ran leaderboard migrations group #4
2025/05/31 09:01:05 All migrations ran successfully
2025/05/31 09:01:05 newDBServiceWithDB - Registering models
2025/05/31 09:01:05 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:05 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005ae1b8 RoundDB:0xc0005ae1c0 ScoreDB:0xc0005ae1d0 LeaderboardDB:0xc0005ae1d8 db:0xc0007eccc0}
2025/05/31 09:01:05 Truncating tables: users
2025/05/31 09:01:05 Truncating tables: users
2025/05/31 09:01:05 Truncating tables: users
2025/05/31 09:01:05 Cleaning up test environment...
2025/05/31 09:01:05 Context cancelled.
2025/05/31 09:01:05 EventBus closed.
2025/05/31 09:01:05 NATS connection closed.
2025/05/31 09:01:05 DB connection closed.
2025/05/31 09:01:05  Stopping container: fb4dbee035a6
2025/05/31 09:01:06  Container stopped: fb4dbee035a6
2025/05/31 09:01:06  Terminating container: fb4dbee035a6
2025/05/31 09:01:06  Container terminated: fb4dbee035a6
2025/05/31 09:01:06 NATS container terminated.
2025/05/31 09:01:06  Stopping container: 96a49495fb13
2025/05/31 09:01:07  Container stopped: 96a49495fb13
2025/05/31 09:01:07  Terminating container: 96a49495fb13
2025/05/31 09:01:07  Container terminated: 96a49495fb13
2025/05/31 09:01:07 PostgreSQL container terminated.
2025/05/31 09:01:07 Cleanup complete.
--- PASS: TestGetUser (29.65s)
    --- PASS: TestGetUser/Success_-_User_exists (9.06s)
    --- PASS: TestGetUser/Failure_-_User_does_not_exist (11.28s)
    --- PASS: TestGetUser/Failure_-_Empty_Discord_ID (9.30s)
=== RUN   TestGetUserRole
=== RUN   TestGetUserRole/Success_-_Valid_user_role
2025/05/31 09:01:07 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:07  Creating container for image postgres:16-alpine
2025/05/31 09:01:07  Container created: 9c44c37c5928
2025/05/31 09:01:07  Starting container: 9c44c37c5928
2025/05/31 09:01:08  Container started: 9c44c37c5928
2025/05/31 09:01:08  Waiting for container id 9c44c37c5928 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005bdee0 Strategies:[0xc000603740]}
2025/05/31 09:01:11  Container is ready: 9c44c37c5928
2025/05/31 09:01:11 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38997/testdb?sslmode=disable
2025/05/31 09:01:11 Starting NATS container with resource limits...
2025/05/31 09:01:11  Creating container for image nats:2.10-alpine
2025/05/31 09:01:12  Container created: 37160e125c11
2025/05/31 09:01:12  Starting container: 37160e125c11
2025/05/31 09:01:12  Container started: 37160e125c11
2025/05/31 09:01:12  Waiting for container id 37160e125c11 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000636fb0 Strategies:[0xc00070a120 0xc000652570]}
2025/05/31 09:01:14  Container is ready: 37160e125c11
2025/05/31 09:01:14 NATS container started with resource limits. URL: nats://localhost:38999
Creating user table...
User table created successfully!
2025/05/31 09:01:14 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:14 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:14 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:14 Ran leaderboard migrations group #4
2025/05/31 09:01:14 All migrations ran successfully
2025/05/31 09:01:14 newDBServiceWithDB - Registering models
2025/05/31 09:01:14 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:14 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000270160 RoundDB:0xc000270168 ScoreDB:0xc000270170 LeaderboardDB:0xc000270178 db:0xc00005eb80}
2025/05/31 09:01:14 Truncating tables: users
2025/05/31 09:01:14 Truncating tables: users
2025/05/31 09:01:14 Truncating tables: users
2025/05/31 09:01:14 Cleaning up test environment...
2025/05/31 09:01:14 Context cancelled.
2025/05/31 09:01:14 EventBus closed.
2025/05/31 09:01:14 NATS connection closed.
2025/05/31 09:01:14 DB connection closed.
2025/05/31 09:01:14  Stopping container: 37160e125c11
2025/05/31 09:01:15  Container stopped: 37160e125c11
2025/05/31 09:01:15  Terminating container: 37160e125c11
2025/05/31 09:01:15  Container terminated: 37160e125c11
2025/05/31 09:01:15 NATS container terminated.
2025/05/31 09:01:15  Stopping container: 9c44c37c5928
2025/05/31 09:01:15  Container stopped: 9c44c37c5928
2025/05/31 09:01:15  Terminating container: 9c44c37c5928
2025/05/31 09:01:15  Container terminated: 9c44c37c5928
2025/05/31 09:01:15 PostgreSQL container terminated.
2025/05/31 09:01:15 Cleanup complete.
=== RUN   TestGetUserRole/Failure_-_User_does_not_exist
2025/05/31 09:01:15 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:15  Creating container for image postgres:16-alpine
2025/05/31 09:01:15  Container created: ac52b4b68ab9
2025/05/31 09:01:15  Starting container: ac52b4b68ab9
2025/05/31 09:01:16  Container started: ac52b4b68ab9
2025/05/31 09:01:16  Waiting for container id ac52b4b68ab9 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000636970 Strategies:[0xc0006be8a0]}
2025/05/31 09:01:19  Container is ready: ac52b4b68ab9
2025/05/31 09:01:19 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39006/testdb?sslmode=disable
2025/05/31 09:01:19 Starting NATS container with resource limits...
2025/05/31 09:01:19  Creating container for image nats:2.10-alpine
2025/05/31 09:01:20  Container created: de01c3b4cb1f
2025/05/31 09:01:20  Starting container: de01c3b4cb1f
2025/05/31 09:01:20  Container started: de01c3b4cb1f
2025/05/31 09:01:20  Waiting for container id de01c3b4cb1f image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005f6a10 Strategies:[0xc00070a6c0 0xc00026fef0]}
2025/05/31 09:01:23  Container is ready: de01c3b4cb1f
2025/05/31 09:01:23 NATS container started with resource limits. URL: nats://localhost:39011
Creating user table...
User table created successfully!
2025/05/31 09:01:23 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:23 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:23 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:23 Ran leaderboard migrations group #4
2025/05/31 09:01:23 All migrations ran successfully
2025/05/31 09:01:23 newDBServiceWithDB - Registering models
2025/05/31 09:01:23 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:23 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005c45b8 RoundDB:0xc0005c45c0 ScoreDB:0xc0005c45c8 LeaderboardDB:0xc0005c45d0 db:0xc000504280}
2025/05/31 09:01:23 Truncating tables: users
2025/05/31 09:01:23 Truncating tables: users
2025/05/31 09:01:23 Truncating tables: users
2025/05/31 09:01:23 Truncating tables: users
2025/05/31 09:01:23 Cleaning up test environment...
2025/05/31 09:01:23 Context cancelled.
2025/05/31 09:01:23 EventBus closed.
2025/05/31 09:01:23 NATS connection closed.
2025/05/31 09:01:23 DB connection closed.
2025/05/31 09:01:23  Stopping container: de01c3b4cb1f
2025/05/31 09:01:24  Container stopped: de01c3b4cb1f
2025/05/31 09:01:24  Terminating container: de01c3b4cb1f
2025/05/31 09:01:24  Container terminated: de01c3b4cb1f
2025/05/31 09:01:24 NATS container terminated.
2025/05/31 09:01:24  Stopping container: ac52b4b68ab9
2025/05/31 09:01:24  Container stopped: ac52b4b68ab9
2025/05/31 09:01:24  Terminating container: ac52b4b68ab9
2025/05/31 09:01:24  Container terminated: ac52b4b68ab9
2025/05/31 09:01:24 PostgreSQL container terminated.
2025/05/31 09:01:24 Cleanup complete.
=== RUN   TestGetUserRole/Failure_-_Nil_context
--- PASS: TestGetUserRole (17.56s)
    --- PASS: TestGetUserRole/Success_-_Valid_user_role (8.45s)
    --- PASS: TestGetUserRole/Failure_-_User_does_not_exist (9.11s)
    --- PASS: TestGetUserRole/Failure_-_Nil_context (0.00s)
=== RUN   TestUpdateUserRoleInDatabase
=== RUN   TestUpdateUserRoleInDatabase/Success_-_Update_user_role
2025/05/31 09:01:24 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:24  Creating container for image postgres:16-alpine
2025/05/31 09:01:24  Container created: 00afc975e55e
2025/05/31 09:01:24  Starting container: 00afc975e55e
2025/05/31 09:01:25  Container started: 00afc975e55e
2025/05/31 09:01:25  Waiting for container id 00afc975e55e image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000013678 Strategies:[0xc0004534d0]}
2025/05/31 09:01:29  Container is ready: 00afc975e55e
2025/05/31 09:01:29 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39018/testdb?sslmode=disable
2025/05/31 09:01:29 Starting NATS container with resource limits...
2025/05/31 09:01:29  Creating container for image nats:2.10-alpine
2025/05/31 09:01:29  Container created: ad2d89fca4d3
2025/05/31 09:01:29  Starting container: ad2d89fca4d3
2025/05/31 09:01:30  Container started: ad2d89fca4d3
2025/05/31 09:01:30  Waiting for container id ad2d89fca4d3 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0007a5328 Strategies:[0xc0006999e0 0xc0000d2150]}
2025/05/31 09:01:32  Container is ready: ad2d89fca4d3
2025/05/31 09:01:32 NATS container started with resource limits. URL: nats://localhost:39023
Creating user table...
User table created successfully!
2025/05/31 09:01:32 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:32 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:32 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:32 Ran leaderboard migrations group #4
2025/05/31 09:01:32 All migrations ran successfully
2025/05/31 09:01:32 newDBServiceWithDB - Registering models
2025/05/31 09:01:32 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:32 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0004a6268 RoundDB:0xc0004a6270 ScoreDB:0xc0004a6278 LeaderboardDB:0xc0004a6280 db:0xc00005ee80}
2025/05/31 09:01:32 Truncating tables: users
2025/05/31 09:01:32 Truncating tables: users
2025/05/31 09:01:32 Truncating tables: users
2025/05/31 09:01:32 Truncating tables: users
2025/05/31 09:01:32 Truncating tables: users
2025/05/31 09:01:32 Cleaning up test environment...
2025/05/31 09:01:32 Context cancelled.
2025/05/31 09:01:32 EventBus closed.
2025/05/31 09:01:32 NATS connection closed.
2025/05/31 09:01:32 DB connection closed.
2025/05/31 09:01:32  Stopping container: ad2d89fca4d3
2025/05/31 09:01:33  Container stopped: ad2d89fca4d3
2025/05/31 09:01:33  Terminating container: ad2d89fca4d3
2025/05/31 09:01:33  Container terminated: ad2d89fca4d3
2025/05/31 09:01:33 NATS container terminated.
2025/05/31 09:01:33  Stopping container: 00afc975e55e
2025/05/31 09:01:33  Container stopped: 00afc975e55e
2025/05/31 09:01:33  Terminating container: 00afc975e55e
2025/05/31 09:01:33  Container terminated: 00afc975e55e
2025/05/31 09:01:33 PostgreSQL container terminated.
2025/05/31 09:01:33 Cleanup complete.
=== RUN   TestUpdateUserRoleInDatabase/Failure_-_Invalid_role
2025/05/31 09:01:33 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:33  Creating container for image postgres:16-alpine
2025/05/31 09:01:33  Container created: f1abb6b6f915
2025/05/31 09:01:33  Starting container: f1abb6b6f915
2025/05/31 09:01:33  Container started: f1abb6b6f915
2025/05/31 09:01:33  Waiting for container id f1abb6b6f915 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005f6150 Strategies:[0xc0005228a0]}
2025/05/31 09:01:37  Container is ready: f1abb6b6f915
2025/05/31 09:01:37 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39030/testdb?sslmode=disable
2025/05/31 09:01:37 Starting NATS container with resource limits...
2025/05/31 09:01:37  Creating container for image nats:2.10-alpine
2025/05/31 09:01:37  Container created: cdfc7991b25a
2025/05/31 09:01:37  Starting container: cdfc7991b25a
2025/05/31 09:01:38  Container started: cdfc7991b25a
2025/05/31 09:01:38  Waiting for container id cdfc7991b25a image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000352f68 Strategies:[0xc000699b60 0xc00060b080]}
2025/05/31 09:01:41  Container is ready: cdfc7991b25a
2025/05/31 09:01:41 NATS container started with resource limits. URL: nats://localhost:39035
Creating round table...
Round table created successfully!
2025/05/31 09:01:41 Ran round migrations group #1
Creating score table...
Score table created successfully!
2025/05/31 09:01:41 Ran score migrations group #2
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:41 Ran leaderboard migrations group #3
Creating user table...
User table created successfully!
2025/05/31 09:01:41 Ran user migrations group #4
2025/05/31 09:01:41 All migrations ran successfully
2025/05/31 09:01:41 newDBServiceWithDB - Registering models
2025/05/31 09:01:41 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:41 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005c4340 RoundDB:0xc0005c4348 ScoreDB:0xc0005c4350 LeaderboardDB:0xc0005c4358 db:0xc00016b980}
2025/05/31 09:01:41 Truncating tables: users
2025/05/31 09:01:41 Truncating tables: users
2025/05/31 09:01:42 Truncating tables: users
2025/05/31 09:01:42 Truncating tables: users
2025/05/31 09:01:42 Cleaning up test environment...
2025/05/31 09:01:42 Context cancelled.
2025/05/31 09:01:42 EventBus closed.
2025/05/31 09:01:42 NATS connection closed.
2025/05/31 09:01:42 DB connection closed.
2025/05/31 09:01:42  Stopping container: cdfc7991b25a
2025/05/31 09:01:42  Container stopped: cdfc7991b25a
2025/05/31 09:01:42  Terminating container: cdfc7991b25a
2025/05/31 09:01:42  Container terminated: cdfc7991b25a
2025/05/31 09:01:42 NATS container terminated.
2025/05/31 09:01:42  Stopping container: f1abb6b6f915
2025/05/31 09:01:42  Container stopped: f1abb6b6f915
2025/05/31 09:01:42  Terminating container: f1abb6b6f915
2025/05/31 09:01:42  Container terminated: f1abb6b6f915
2025/05/31 09:01:42 PostgreSQL container terminated.
2025/05/31 09:01:42 Cleanup complete.
=== RUN   TestUpdateUserRoleInDatabase/Failure_-_User_does_not_exist
2025/05/31 09:01:42 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:42  Creating container for image postgres:16-alpine
2025/05/31 09:01:42  Container created: 96853bf14cfb
2025/05/31 09:01:42  Starting container: 96853bf14cfb
2025/05/31 09:01:43  Container started: 96853bf14cfb
2025/05/31 09:01:43  Waiting for container id 96853bf14cfb image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc00059f418 Strategies:[0xc000292db0]}
2025/05/31 09:01:46  Container is ready: 96853bf14cfb
2025/05/31 09:01:46 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39042/testdb?sslmode=disable
2025/05/31 09:01:46 Starting NATS container with resource limits...
2025/05/31 09:01:46  Creating container for image nats:2.10-alpine
2025/05/31 09:01:46  Container created: ea2dd225f353
2025/05/31 09:01:46  Starting container: ea2dd225f353
2025/05/31 09:01:47  Container started: ea2dd225f353
2025/05/31 09:01:47  Waiting for container id ea2dd225f353 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000591e20 Strategies:[0xc00064acc0 0xc00067d440]}
2025/05/31 09:01:50  Container is ready: ea2dd225f353
2025/05/31 09:01:50 NATS container started with resource limits. URL: nats://localhost:39047
Creating user table...
User table created successfully!
2025/05/31 09:01:50 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:50 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:50 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:50 Ran leaderboard migrations group #4
2025/05/31 09:01:50 All migrations ran successfully
2025/05/31 09:01:50 newDBServiceWithDB - Registering models
2025/05/31 09:01:50 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:50 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005ae0e8 RoundDB:0xc0005ae0f0 ScoreDB:0xc0005ae0f8 LeaderboardDB:0xc0005ae100 db:0xc0007ec2c0}
2025/05/31 09:01:50 Truncating tables: users
2025/05/31 09:01:50 Truncating tables: users
2025/05/31 09:01:50 Truncating tables: users
2025/05/31 09:01:50 Truncating tables: users
2025/05/31 09:01:50 Truncating tables: users
2025/05/31 09:01:50 Cleaning up test environment...
2025/05/31 09:01:50 Context cancelled.
2025/05/31 09:01:50 EventBus closed.
2025/05/31 09:01:50 NATS connection closed.
2025/05/31 09:01:50 DB connection closed.
2025/05/31 09:01:50  Stopping container: ea2dd225f353
2025/05/31 09:01:50  Container stopped: ea2dd225f353
2025/05/31 09:01:50  Terminating container: ea2dd225f353
2025/05/31 09:01:51  Container terminated: ea2dd225f353
2025/05/31 09:01:51 NATS container terminated.
2025/05/31 09:01:51  Stopping container: 96853bf14cfb
2025/05/31 09:01:51  Container stopped: 96853bf14cfb
2025/05/31 09:01:51  Terminating container: 96853bf14cfb
2025/05/31 09:01:51  Container terminated: 96853bf14cfb
2025/05/31 09:01:51 PostgreSQL container terminated.
2025/05/31 09:01:51 Cleanup complete.
=== RUN   TestUpdateUserRoleInDatabase/Failure_-_Nil_context
--- PASS: TestUpdateUserRoleInDatabase (26.52s)
    --- PASS: TestUpdateUserRoleInDatabase/Success_-_Update_user_role (8.74s)
    --- PASS: TestUpdateUserRoleInDatabase/Failure_-_Invalid_role (9.27s)
    --- PASS: TestUpdateUserRoleInDatabase/Failure_-_User_does_not_exist (8.50s)
    --- PASS: TestUpdateUserRoleInDatabase/Failure_-_Nil_context (0.00s)
PASS
coverage: 4.0% of statements in ./app/...
2025/05/31 09:01:51 TestMain: finished with exit code: 0
ok  	github.com/Black-And-White-Club/frolf-bot/integration_tests/modules/user/application_tests	156.276s	coverage: 4.0% of statements in ./app/...
2025/05/31 08:59:20 TestMain started in package userhandler_integration_tests
=== RUN   TestHandleTagAvailable
=== RUN   TestHandleTagAvailable/Success_-_user_created_from_tag_available
2025/05/31 08:59:20 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:20 github.com/testcontainers/testcontainers-go - Connected to docker: 
  Server Version: 28.1.1
  API Version: 1.48
  Operating System: Ubuntu 24.04.1 LTS
  Total Memory: 5923 MB
  Testcontainers for Go Version: v0.37.0
  Resolved Docker Host: unix:///Users/jace/.colima/default/docker.sock
  Resolved Docker Socket Path: /var/run/docker.sock
  Test SessionID: 3bcca53efbc96e46a6c192358bf7642f396e27e5bff8699ef9bf67ff02cc0815
  Test ProcessID: 70b2998b-e0d7-4244-a6c9-607e3dcd5c2b
2025/05/31 08:59:20  Creating container for image postgres:16-alpine
2025/05/31 08:59:20  Waiting for Reaper "f69f8f9c" to be ready
2025/05/31 08:59:20  Reaper obtained from Docker for this test session f69f8f9c
2025/05/31 08:59:20  Container created: f2579b97c615
2025/05/31 08:59:20  Starting container: f2579b97c615
2025/05/31 08:59:21  Container started: f2579b97c615
2025/05/31 08:59:21  Waiting for container id f2579b97c615 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc00034e5f0 Strategies:[0xc00040ccf0]}
2025/05/31 08:59:31  Container is ready: f2579b97c615
2025/05/31 08:59:31 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38817/testdb?sslmode=disable
2025/05/31 08:59:31 Starting NATS container with resource limits...
2025/05/31 08:59:31  Creating container for image nats:2.10-alpine
2025/05/31 08:59:31  Container created: e1e6127ff7d9
2025/05/31 08:59:31  Starting container: e1e6127ff7d9
2025/05/31 08:59:32  Container started: e1e6127ff7d9
2025/05/31 08:59:32  Waiting for container id e1e6127ff7d9 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0004c0680 Strategies:[0xc0004e40c0 0xc000414420]}
2025/05/31 08:59:36  Container is ready: e1e6127ff7d9
2025/05/31 08:59:36 NATS container started with resource limits. URL: nats://localhost:38839
Creating user table...
User table created successfully!
2025/05/31 08:59:37 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 08:59:37 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 08:59:37 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:37 Ran leaderboard migrations group #4
2025/05/31 08:59:37 All migrations ran successfully
2025/05/31 08:59:37 newDBServiceWithDB - Registering models
2025/05/31 08:59:37 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:37 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007c620 RoundDB:0xc00007c628 ScoreDB:0xc00007c630 LeaderboardDB:0xc00007c638 db:0xc000446180}
2025/05/31 08:59:37 Truncating tables: users
2025/05/31 08:59:37 Truncating tables: users
    tag_availability_test.go:157: Waiting for 1 messages on topic "user.created" with timeout 5s
2025/05/31 08:59:38 Test received message 38664f41-acf8-4ed0-8833-4b1c157ed570 on topic "user.created"
    tag_availability_test.go:157: Successfully received 1 messages on topic "user.created"
2025/05/31 08:59:38 Test Case "TestHandleTagAvailable/Success_-_user_created_from_tag_available": Canceling subscription context.
2025/05/31 08:59:38 Test Case "TestHandleTagAvailable/Success_-_user_created_from_tag_available": Waiting for subscriber goroutines to finish.
2025/05/31 08:59:38 Test Case "TestHandleTagAvailable/Success_-_user_created_from_tag_available": Subscriber goroutines finished.
2025/05/31 08:59:38 Running user handler test cleanup...
2025/05/31 08:59:39 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 08:59:39 User handler router goroutine finished.
2025/05/31 08:59:39 User handler test cleanup finished.
2025/05/31 08:59:39 Cleaning up test environment...
2025/05/31 08:59:39 Context cancelled.
2025/05/31 08:59:39 EventBus closed.
2025/05/31 08:59:39 NATS connection closed.
2025/05/31 08:59:39 DB connection closed.
2025/05/31 08:59:39  Stopping container: e1e6127ff7d9
2025/05/31 08:59:40  Container stopped: e1e6127ff7d9
2025/05/31 08:59:40  Terminating container: e1e6127ff7d9
2025/05/31 08:59:40  Container terminated: e1e6127ff7d9
2025/05/31 08:59:40 NATS container terminated.
2025/05/31 08:59:40  Stopping container: f2579b97c615
2025/05/31 08:59:41  Container stopped: f2579b97c615
2025/05/31 08:59:41  Terminating container: f2579b97c615
2025/05/31 08:59:41  Container terminated: f2579b97c615
2025/05/31 08:59:41 PostgreSQL container terminated.
2025/05/31 08:59:41 Cleanup complete.
=== RUN   TestHandleTagAvailable/Failure_-_user_already_exists
2025/05/31 08:59:41 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:41  Creating container for image postgres:16-alpine
2025/05/31 08:59:42  Container created: 1dd66cb8d33b
2025/05/31 08:59:42  Starting container: 1dd66cb8d33b
2025/05/31 08:59:42  Container started: 1dd66cb8d33b
2025/05/31 08:59:42  Waiting for container id 1dd66cb8d33b image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005ef240 Strategies:[0xc0003084b0]}
2025/05/31 08:59:50  Container is ready: 1dd66cb8d33b
2025/05/31 08:59:50 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38847/testdb?sslmode=disable
2025/05/31 08:59:50 Starting NATS container with resource limits...
2025/05/31 08:59:50  Creating container for image nats:2.10-alpine
2025/05/31 08:59:50  Container created: b4fecb53efb5
2025/05/31 08:59:50  Starting container: b4fecb53efb5
2025/05/31 08:59:51  Container started: b4fecb53efb5
2025/05/31 08:59:51  Waiting for container id b4fecb53efb5 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005908c0 Strategies:[0xc00086e840 0xc0007ab800]}
2025/05/31 08:59:54  Container is ready: b4fecb53efb5
2025/05/31 08:59:54 NATS container started with resource limits. URL: nats://localhost:38864
Creating user table...
User table created successfully!
2025/05/31 08:59:54 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 08:59:54 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 08:59:54 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 08:59:54 Ran leaderboard migrations group #4
2025/05/31 08:59:54 All migrations ran successfully
2025/05/31 08:59:54 newDBServiceWithDB - Registering models
2025/05/31 08:59:54 newDBServiceWithDB - Models registered successfully
2025/05/31 08:59:54 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007c688 RoundDB:0xc00007c690 ScoreDB:0xc00007c698 LeaderboardDB:0xc00007c6a0 db:0xc0007a89c0}
2025/05/31 08:59:54 Truncating tables: users
2025/05/31 08:59:54 Truncating tables: users
    tag_availability_test.go:157: Waiting for 1 messages on topic "user.creation.failed" with timeout 5s
2025/05/31 08:59:56 Test received message 7ef0cc5e-fdff-4936-90b3-b3f62dd33001 on topic "user.creation.failed"
    tag_availability_test.go:157: Successfully received 1 messages on topic "user.creation.failed"
2025/05/31 08:59:56 Test Case "TestHandleTagAvailable/Failure_-_user_already_exists": Canceling subscription context.
2025/05/31 08:59:56 Test Case "TestHandleTagAvailable/Failure_-_user_already_exists": Waiting for subscriber goroutines to finish.
2025/05/31 08:59:56 Test Case "TestHandleTagAvailable/Failure_-_user_already_exists": Subscriber goroutines finished.
2025/05/31 08:59:56 Running user handler test cleanup...
2025/05/31 08:59:57 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 08:59:57 User handler router goroutine finished.
2025/05/31 08:59:57 User handler test cleanup finished.
2025/05/31 08:59:57 Cleaning up test environment...
2025/05/31 08:59:57 Context cancelled.
2025/05/31 08:59:57 EventBus closed.
2025/05/31 08:59:57 NATS connection closed.
2025/05/31 08:59:57 DB connection closed.
2025/05/31 08:59:57  Stopping container: b4fecb53efb5
2025/05/31 08:59:58  Container stopped: b4fecb53efb5
2025/05/31 08:59:58  Terminating container: b4fecb53efb5
2025/05/31 08:59:58  Container terminated: b4fecb53efb5
2025/05/31 08:59:58 NATS container terminated.
2025/05/31 08:59:58  Stopping container: 1dd66cb8d33b
2025/05/31 08:59:58  Container stopped: 1dd66cb8d33b
2025/05/31 08:59:58  Terminating container: 1dd66cb8d33b
2025/05/31 08:59:59  Container terminated: 1dd66cb8d33b
2025/05/31 08:59:59 PostgreSQL container terminated.
2025/05/31 08:59:59 Cleanup complete.
--- PASS: TestHandleTagAvailable (38.89s)
    --- PASS: TestHandleTagAvailable/Success_-_user_created_from_tag_available (21.57s)
    --- PASS: TestHandleTagAvailable/Failure_-_user_already_exists (17.32s)
=== RUN   TestHandleTagUnavailable
=== RUN   TestHandleTagUnavailable/Always_fails_with_'tag_not_available'
2025/05/31 08:59:59 Starting PostgreSQL container with resource limits...
2025/05/31 08:59:59  Creating container for image postgres:16-alpine
2025/05/31 08:59:59  Container created: 90c5e702909b
2025/05/31 08:59:59  Starting container: 90c5e702909b
2025/05/31 09:00:01  Container started: 90c5e702909b
2025/05/31 09:00:01  Waiting for container id 90c5e702909b image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000590da0 Strategies:[0xc000780c60]}
2025/05/31 09:00:08  Container is ready: 90c5e702909b
2025/05/31 09:00:08 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38872/testdb?sslmode=disable
2025/05/31 09:00:08 Starting NATS container with resource limits...
2025/05/31 09:00:08  Creating container for image nats:2.10-alpine
2025/05/31 09:00:08  Container created: ba542a28d49b
2025/05/31 09:00:08  Starting container: ba542a28d49b
2025/05/31 09:00:09  Container started: ba542a28d49b
2025/05/31 09:00:09  Waiting for container id ba542a28d49b image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0004c0938 Strategies:[0xc000a93080 0xc000288b70]}
2025/05/31 09:00:11  Container is ready: ba542a28d49b
2025/05/31 09:00:11 NATS container started with resource limits. URL: nats://localhost:38889
Creating user table...
User table created successfully!
2025/05/31 09:00:12 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:12 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:12 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:12 Ran leaderboard migrations group #4
2025/05/31 09:00:12 All migrations ran successfully
2025/05/31 09:00:12 newDBServiceWithDB - Registering models
2025/05/31 09:00:12 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:12 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00014c168 RoundDB:0xc00014c170 ScoreDB:0xc00014c178 LeaderboardDB:0xc00014c180 db:0xc0007a8300}
2025/05/31 09:00:12 Truncating tables: users
2025/05/31 09:00:12 Truncating tables: users
    tag_availability_test.go:249: Waiting for 1 messages on topic "user.creation.failed" with timeout 5s
2025/05/31 09:00:13 Test received message 2260be97-4cdb-4e9c-bd59-f4239e468d1e on topic "user.creation.failed"
    tag_availability_test.go:249: Successfully received 1 messages on topic "user.creation.failed"
2025/05/31 09:00:13 Test Case "TestHandleTagUnavailable/Always_fails_with_'tag_not_available'": Canceling subscription context.
2025/05/31 09:00:13 Test Case "TestHandleTagUnavailable/Always_fails_with_'tag_not_available'": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:13 Test Case "TestHandleTagUnavailable/Always_fails_with_'tag_not_available'": Subscriber goroutines finished.
2025/05/31 09:00:13 Running user handler test cleanup...
2025/05/31 09:00:14 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:00:14 User handler router goroutine finished.
2025/05/31 09:00:14 User handler test cleanup finished.
2025/05/31 09:00:14 Cleaning up test environment...
2025/05/31 09:00:14 Context cancelled.
2025/05/31 09:00:14 EventBus closed.
2025/05/31 09:00:14 NATS connection closed.
2025/05/31 09:00:14 DB connection closed.
2025/05/31 09:00:14  Stopping container: ba542a28d49b
2025/05/31 09:00:15  Container stopped: ba542a28d49b
2025/05/31 09:00:15  Terminating container: ba542a28d49b
2025/05/31 09:00:15  Container terminated: ba542a28d49b
2025/05/31 09:00:15 NATS container terminated.
2025/05/31 09:00:15  Stopping container: 90c5e702909b
2025/05/31 09:00:16  Container stopped: 90c5e702909b
2025/05/31 09:00:16  Terminating container: 90c5e702909b
2025/05/31 09:00:17  Container terminated: 90c5e702909b
2025/05/31 09:00:17 PostgreSQL container terminated.
2025/05/31 09:00:17 Cleanup complete.
--- PASS: TestHandleTagUnavailable (18.02s)
    --- PASS: TestHandleTagUnavailable/Always_fails_with_'tag_not_available' (18.02s)
=== RUN   TestHandleUserSignupRequest
=== RUN   TestHandleUserSignupRequest/Success_-_User_Signup_without_Tag
2025/05/31 09:00:17 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:17  Creating container for image postgres:16-alpine
2025/05/31 09:00:17  Container created: aba99f82e831
2025/05/31 09:00:17  Starting container: aba99f82e831
2025/05/31 09:00:18  Container started: aba99f82e831
2025/05/31 09:00:18  Waiting for container id aba99f82e831 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000389868 Strategies:[0xc00040d020]}
2025/05/31 09:00:23  Container is ready: aba99f82e831
2025/05/31 09:00:23 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38905/testdb?sslmode=disable
2025/05/31 09:00:23 Starting NATS container with resource limits...
2025/05/31 09:00:23  Creating container for image nats:2.10-alpine
2025/05/31 09:00:23  Container created: 418674cc5b5c
2025/05/31 09:00:23  Starting container: 418674cc5b5c
2025/05/31 09:00:24  Container started: 418674cc5b5c
2025/05/31 09:00:24  Waiting for container id 418674cc5b5c image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005b7e70 Strategies:[0xc0004e4d80 0xc000b08420]}
2025/05/31 09:00:26  Container is ready: 418674cc5b5c
2025/05/31 09:00:26 NATS container started with resource limits. URL: nats://localhost:38919
Creating user table...
User table created successfully!
2025/05/31 09:00:26 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:26 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:26 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:26 Ran leaderboard migrations group #4
2025/05/31 09:00:26 All migrations ran successfully
2025/05/31 09:00:26 newDBServiceWithDB - Registering models
2025/05/31 09:00:26 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:26 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0006182a8 RoundDB:0xc0006182b0 ScoreDB:0xc0006182b8 LeaderboardDB:0xc0006182c0 db:0xc0006abc80}
2025/05/31 09:00:26 Truncating tables: users
2025/05/31 09:00:26 Truncating tables: users
    user_creation_test.go:321: Waiting for 1 messages on topic "user.created" with timeout 5s
2025/05/31 09:00:27 Test received message 2d3d9c5a-a021-4c98-a19b-d04aa9a53204 on topic "user.created"
    user_creation_test.go:321: Successfully received 1 messages on topic "user.created"
2025/05/31 09:00:27 Test Case "TestHandleUserSignupRequest/Success_-_User_Signup_without_Tag": Canceling subscription context.
2025/05/31 09:00:27 Test Case "TestHandleUserSignupRequest/Success_-_User_Signup_without_Tag": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:27 Test Case "TestHandleUserSignupRequest/Success_-_User_Signup_without_Tag": Subscriber goroutines finished.
2025/05/31 09:00:27 Running user handler test cleanup...
2025/05/31 09:00:28 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:00:28 User handler router goroutine finished.
2025/05/31 09:00:28 User handler test cleanup finished.
2025/05/31 09:00:28 Cleaning up test environment...
2025/05/31 09:00:28 Context cancelled.
2025/05/31 09:00:28 EventBus closed.
2025/05/31 09:00:28 NATS connection closed.
2025/05/31 09:00:28 DB connection closed.
2025/05/31 09:00:28  Stopping container: 418674cc5b5c
2025/05/31 09:00:29  Container stopped: 418674cc5b5c
2025/05/31 09:00:29  Terminating container: 418674cc5b5c
2025/05/31 09:00:29  Container terminated: 418674cc5b5c
2025/05/31 09:00:29 NATS container terminated.
2025/05/31 09:00:29  Stopping container: aba99f82e831
2025/05/31 09:00:30  Container stopped: aba99f82e831
2025/05/31 09:00:30  Terminating container: aba99f82e831
2025/05/31 09:00:30  Container terminated: aba99f82e831
2025/05/31 09:00:30 PostgreSQL container terminated.
2025/05/31 09:00:30 Cleanup complete.
=== RUN   TestHandleUserSignupRequest/Success_-_User_Signup_with_Tag_(requests_availability_check)
2025/05/31 09:00:30 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:30  Creating container for image postgres:16-alpine
2025/05/31 09:00:31  Container created: e01c064d3fa3
2025/05/31 09:00:31  Starting container: e01c064d3fa3
2025/05/31 09:00:31  Container started: e01c064d3fa3
2025/05/31 09:00:31  Waiting for container id e01c064d3fa3 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000307ba0 Strategies:[0xc0007800c0]}
2025/05/31 09:00:37  Container is ready: e01c064d3fa3
2025/05/31 09:00:37 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38929/testdb?sslmode=disable
2025/05/31 09:00:37 Starting NATS container with resource limits...
2025/05/31 09:00:37  Creating container for image nats:2.10-alpine
2025/05/31 09:00:37  Container created: 5815c4f3746b
2025/05/31 09:00:37  Starting container: 5815c4f3746b
2025/05/31 09:00:38  Container started: 5815c4f3746b
2025/05/31 09:00:38  Waiting for container id 5815c4f3746b image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00078de78 Strategies:[0xc00093daa0 0xc00065fc80]}
2025/05/31 09:00:41  Container is ready: 5815c4f3746b
2025/05/31 09:00:41 NATS container started with resource limits. URL: nats://localhost:38938
Creating user table...
User table created successfully!
2025/05/31 09:00:41 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:00:41 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:00:41 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:41 Ran leaderboard migrations group #4
2025/05/31 09:00:41 All migrations ran successfully
2025/05/31 09:00:41 newDBServiceWithDB - Registering models
2025/05/31 09:00:41 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:41 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0006183c8 RoundDB:0xc0006183d0 ScoreDB:0xc0006183d8 LeaderboardDB:0xc0006183e0 db:0xc000d12d40}
2025/05/31 09:00:42 Truncating tables: users
2025/05/31 09:00:42 Truncating tables: users
    user_creation_test.go:321: Waiting for 1 messages on topic "leaderboard.tag.availability.check.requested" with timeout 5s
2025/05/31 09:00:42 Test received message 4e7a6eed-304f-494f-b042-a3751cb063f7 on topic "leaderboard.tag.availability.check.requested"
    user_creation_test.go:321: Successfully received 1 messages on topic "leaderboard.tag.availability.check.requested"
2025/05/31 09:00:43 Test Case "TestHandleUserSignupRequest/Success_-_User_Signup_with_Tag_(requests_availability_check)": Canceling subscription context.
2025/05/31 09:00:43 Test Case "TestHandleUserSignupRequest/Success_-_User_Signup_with_Tag_(requests_availability_check)": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:43 Test Case "TestHandleUserSignupRequest/Success_-_User_Signup_with_Tag_(requests_availability_check)": Subscriber goroutines finished.
2025/05/31 09:00:43 Running user handler test cleanup...
2025/05/31 09:00:44 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:00:44 User handler router goroutine finished.
2025/05/31 09:00:44 User handler test cleanup finished.
2025/05/31 09:00:44 Cleaning up test environment...
2025/05/31 09:00:44 Context cancelled.
2025/05/31 09:00:44 EventBus closed.
2025/05/31 09:00:44 NATS connection closed.
2025/05/31 09:00:44 DB connection closed.
2025/05/31 09:00:44  Stopping container: 5815c4f3746b
2025/05/31 09:00:44  Container stopped: 5815c4f3746b
2025/05/31 09:00:44  Terminating container: 5815c4f3746b
2025/05/31 09:00:44  Container terminated: 5815c4f3746b
2025/05/31 09:00:44 NATS container terminated.
2025/05/31 09:00:44  Stopping container: e01c064d3fa3
2025/05/31 09:00:45  Container stopped: e01c064d3fa3
2025/05/31 09:00:45  Terminating container: e01c064d3fa3
2025/05/31 09:00:45  Container terminated: e01c064d3fa3
2025/05/31 09:00:45 PostgreSQL container terminated.
2025/05/31 09:00:45 Cleanup complete.
=== RUN   TestHandleUserSignupRequest/Failure_-_User_Already_Exists_(no_tag)
2025/05/31 09:00:45 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:45  Creating container for image postgres:16-alpine
2025/05/31 09:00:45  Container created: 34adf8a4245d
2025/05/31 09:00:45  Starting container: 34adf8a4245d
2025/05/31 09:00:46  Container started: 34adf8a4245d
2025/05/31 09:00:46  Waiting for container id 34adf8a4245d image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000b47d68 Strategies:[0xc0004e9830]}
2025/05/31 09:00:51  Container is ready: 34adf8a4245d
2025/05/31 09:00:51 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38958/testdb?sslmode=disable
2025/05/31 09:00:51 Starting NATS container with resource limits...
2025/05/31 09:00:51  Creating container for image nats:2.10-alpine
2025/05/31 09:00:51  Container created: 77437d6fde1c
2025/05/31 09:00:51  Starting container: 77437d6fde1c
2025/05/31 09:00:52  Container started: 77437d6fde1c
2025/05/31 09:00:52  Waiting for container id 77437d6fde1c image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc00061b198 Strategies:[0xc00086f620 0xc000862060]}
2025/05/31 09:00:53  Container is ready: 77437d6fde1c
2025/05/31 09:00:53 NATS container started with resource limits. URL: nats://localhost:38967
Creating round table...
Round table created successfully!
2025/05/31 09:00:53 Ran round migrations group #1
Creating score table...
Score table created successfully!
2025/05/31 09:00:53 Ran score migrations group #2
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:00:53 Ran leaderboard migrations group #3
Creating user table...
User table created successfully!
2025/05/31 09:00:54 Ran user migrations group #4
2025/05/31 09:00:54 All migrations ran successfully
2025/05/31 09:00:54 newDBServiceWithDB - Registering models
2025/05/31 09:00:54 newDBServiceWithDB - Models registered successfully
2025/05/31 09:00:54 newDBServiceWithDB - DBService initialized: &{UserDB:0xc0005ba0c8 RoundDB:0xc0005ba0d0 ScoreDB:0xc0005ba0e8 LeaderboardDB:0xc0005ba100 db:0xc000ade400}
2025/05/31 09:00:54 Truncating tables: users
2025/05/31 09:00:54 Truncating tables: users
2025/05/31 09:00:54 Pre-created user "testuser-exists-789" for test
    user_creation_test.go:321: Waiting for 1 messages on topic "user.creation.failed" with timeout 5s
2025/05/31 09:00:55 Test received message fcf7b629-f3c7-4b91-addf-2478daf73bf9 on topic "user.creation.failed"
    user_creation_test.go:321: Successfully received 1 messages on topic "user.creation.failed"
2025/05/31 09:00:55 Test Case "TestHandleUserSignupRequest/Failure_-_User_Already_Exists_(no_tag)": Canceling subscription context.
2025/05/31 09:00:55 Test Case "TestHandleUserSignupRequest/Failure_-_User_Already_Exists_(no_tag)": Waiting for subscriber goroutines to finish.
2025/05/31 09:00:55 Test Case "TestHandleUserSignupRequest/Failure_-_User_Already_Exists_(no_tag)": Subscriber goroutines finished.
2025/05/31 09:00:55 Running user handler test cleanup...
2025/05/31 09:00:56 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:00:56 User handler router goroutine finished.
2025/05/31 09:00:56 User handler test cleanup finished.
2025/05/31 09:00:56 Cleaning up test environment...
2025/05/31 09:00:56 Context cancelled.
2025/05/31 09:00:56 EventBus closed.
2025/05/31 09:00:56 NATS connection closed.
2025/05/31 09:00:56 DB connection closed.
2025/05/31 09:00:56  Stopping container: 77437d6fde1c
2025/05/31 09:00:56  Container stopped: 77437d6fde1c
2025/05/31 09:00:56  Terminating container: 77437d6fde1c
2025/05/31 09:00:56  Container terminated: 77437d6fde1c
2025/05/31 09:00:56 NATS container terminated.
2025/05/31 09:00:56  Stopping container: 34adf8a4245d
2025/05/31 09:00:57  Container stopped: 34adf8a4245d
2025/05/31 09:00:57  Terminating container: 34adf8a4245d
2025/05/31 09:00:57  Container terminated: 34adf8a4245d
2025/05/31 09:00:57 PostgreSQL container terminated.
2025/05/31 09:00:57 Cleanup complete.
--- PASS: TestHandleUserSignupRequest (40.41s)
    --- PASS: TestHandleUserSignupRequest/Success_-_User_Signup_without_Tag (13.48s)
    --- PASS: TestHandleUserSignupRequest/Success_-_User_Signup_with_Tag_(requests_availability_check) (14.73s)
    --- PASS: TestHandleUserSignupRequest/Failure_-_User_Already_Exists_(no_tag) (12.20s)
=== RUN   TestHandleGetUserRequest
=== RUN   TestHandleGetUserRequest/Success_-_user_found
2025/05/31 09:00:57 Starting PostgreSQL container with resource limits...
2025/05/31 09:00:57  Creating container for image postgres:16-alpine
2025/05/31 09:00:57  Container created: 4f78069bc92c
2025/05/31 09:00:57  Starting container: 4f78069bc92c
2025/05/31 09:00:58  Container started: 4f78069bc92c
2025/05/31 09:00:58  Waiting for container id 4f78069bc92c image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000946e10 Strategies:[0xc0007804b0]}
2025/05/31 09:01:02  Container is ready: 4f78069bc92c
2025/05/31 09:01:02 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38980/testdb?sslmode=disable
2025/05/31 09:01:02 Starting NATS container with resource limits...
2025/05/31 09:01:02  Creating container for image nats:2.10-alpine
2025/05/31 09:01:02  Container created: f0f10fdcbc6a
2025/05/31 09:01:02  Starting container: f0f10fdcbc6a
2025/05/31 09:01:03  Container started: f0f10fdcbc6a
2025/05/31 09:01:03  Waiting for container id f0f10fdcbc6a image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0005ef028 Strategies:[0xc00086fbc0 0xc000780930]}
2025/05/31 09:01:05  Container is ready: f0f10fdcbc6a
2025/05/31 09:01:05 NATS container started with resource limits. URL: nats://localhost:38983
Creating user table...
User table created successfully!
2025/05/31 09:01:05 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:05 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:05 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:05 Ran leaderboard migrations group #4
2025/05/31 09:01:05 All migrations ran successfully
2025/05/31 09:01:05 newDBServiceWithDB - Registering models
2025/05/31 09:01:05 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:05 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000618258 RoundDB:0xc000618260 ScoreDB:0xc000618268 LeaderboardDB:0xc000618270 db:0xc00068f080}
2025/05/31 09:01:06 Truncating tables: users
2025/05/31 09:01:06 Truncating tables: users
2025/05/31 09:01:06 Warning: Could not create user with tag number in setup, assuming user exists: CreateUser operation failed: user already exists
    user_retrieval_test.go:166: Waiting for 1 messages on topic "user.get.response" with timeout 5s
2025/05/31 09:01:07 Test received message e36bc32a-ff23-41d1-833e-892ec6e31036 on topic "user.get.response"
    user_retrieval_test.go:166: Successfully received 1 messages on topic "user.get.response"
2025/05/31 09:01:07 Test Case "TestHandleGetUserRequest/Success_-_user_found": Canceling subscription context.
2025/05/31 09:01:07 Test Case "TestHandleGetUserRequest/Success_-_user_found": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:07 Test Case "TestHandleGetUserRequest/Success_-_user_found": Subscriber goroutines finished.
2025/05/31 09:01:07 Running user handler test cleanup...
2025/05/31 09:01:08 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:01:08 User handler router goroutine finished.
2025/05/31 09:01:08 User handler test cleanup finished.
2025/05/31 09:01:08 Cleaning up test environment...
2025/05/31 09:01:08 Context cancelled.
2025/05/31 09:01:08 EventBus closed.
2025/05/31 09:01:08 NATS connection closed.
2025/05/31 09:01:08 DB connection closed.
2025/05/31 09:01:08  Stopping container: f0f10fdcbc6a
2025/05/31 09:01:08  Container stopped: f0f10fdcbc6a
2025/05/31 09:01:08  Terminating container: f0f10fdcbc6a
2025/05/31 09:01:08  Container terminated: f0f10fdcbc6a
2025/05/31 09:01:08 NATS container terminated.
2025/05/31 09:01:08  Stopping container: 4f78069bc92c
2025/05/31 09:01:09  Container stopped: 4f78069bc92c
2025/05/31 09:01:09  Terminating container: 4f78069bc92c
2025/05/31 09:01:09  Container terminated: 4f78069bc92c
2025/05/31 09:01:09 PostgreSQL container terminated.
2025/05/31 09:01:09 Cleanup complete.
=== RUN   TestHandleGetUserRequest/Failure_-_user_not_found
2025/05/31 09:01:09 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:09  Creating container for image postgres:16-alpine
2025/05/31 09:01:09  Container created: 1416e99b366d
2025/05/31 09:01:09  Starting container: 1416e99b366d
2025/05/31 09:01:09  Container started: 1416e99b366d
2025/05/31 09:01:09  Waiting for container id 1416e99b366d image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000388128 Strategies:[0xc0007aab10]}
2025/05/31 09:01:13  Container is ready: 1416e99b366d
2025/05/31 09:01:13 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:38998/testdb?sslmode=disable
2025/05/31 09:01:13 Starting NATS container with resource limits...
2025/05/31 09:01:13  Creating container for image nats:2.10-alpine
2025/05/31 09:01:13  Container created: f1db93f08e70
2025/05/31 09:01:13  Starting container: f1db93f08e70
2025/05/31 09:01:13  Container started: f1db93f08e70
2025/05/31 09:01:13  Waiting for container id f1db93f08e70 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc0004c06c8 Strategies:[0xc0007b9da0 0xc000b3ccf0]}
2025/05/31 09:01:14  Container is ready: f1db93f08e70
2025/05/31 09:01:14 NATS container started with resource limits. URL: nats://localhost:39002
Creating round table...
Round table created successfully!
2025/05/31 09:01:14 Ran round migrations group #1
Creating score table...
Score table created successfully!
2025/05/31 09:01:14 Ran score migrations group #2
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:14 Ran leaderboard migrations group #3
Creating user table...
User table created successfully!
2025/05/31 09:01:14 Ran user migrations group #4
2025/05/31 09:01:14 All migrations ran successfully
2025/05/31 09:01:14 newDBServiceWithDB - Registering models
2025/05/31 09:01:14 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:14 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007cac0 RoundDB:0xc00007cac8 ScoreDB:0xc00007cad0 LeaderboardDB:0xc00007cad8 db:0xc000447940}
2025/05/31 09:01:14 Truncating tables: users
2025/05/31 09:01:14 Truncating tables: users
    user_retrieval_test.go:166: Waiting for 1 messages on topic "user.get.failed" with timeout 5s
2025/05/31 09:01:15 Test received message 0cf520a6-4dba-42e5-8143-fc53dc07d1f2 on topic "user.get.failed"
    user_retrieval_test.go:166: Successfully received 1 messages on topic "user.get.failed"
2025/05/31 09:01:15 Test Case "TestHandleGetUserRequest/Failure_-_user_not_found": Canceling subscription context.
2025/05/31 09:01:15 Test Case "TestHandleGetUserRequest/Failure_-_user_not_found": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:15 Test Case "TestHandleGetUserRequest/Failure_-_user_not_found": Subscriber goroutines finished.
2025/05/31 09:01:15 Running user handler test cleanup...
2025/05/31 09:01:16 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:01:16 User handler router goroutine finished.
2025/05/31 09:01:16 User handler test cleanup finished.
2025/05/31 09:01:16 Cleaning up test environment...
2025/05/31 09:01:16 Context cancelled.
2025/05/31 09:01:16 EventBus closed.
2025/05/31 09:01:16 NATS connection closed.
2025/05/31 09:01:16 DB connection closed.
2025/05/31 09:01:16  Stopping container: f1db93f08e70
2025/05/31 09:01:17  Container stopped: f1db93f08e70
2025/05/31 09:01:17  Terminating container: f1db93f08e70
2025/05/31 09:01:17  Container terminated: f1db93f08e70
2025/05/31 09:01:17 NATS container terminated.
2025/05/31 09:01:17  Stopping container: 1416e99b366d
2025/05/31 09:01:17  Container stopped: 1416e99b366d
2025/05/31 09:01:17  Terminating container: 1416e99b366d
2025/05/31 09:01:17  Container terminated: 1416e99b366d
2025/05/31 09:01:17 PostgreSQL container terminated.
2025/05/31 09:01:17 Cleanup complete.
--- PASS: TestHandleGetUserRequest (20.33s)
    --- PASS: TestHandleGetUserRequest/Success_-_user_found (11.83s)
    --- PASS: TestHandleGetUserRequest/Failure_-_user_not_found (8.50s)
=== RUN   TestHandleGetUserRoleRequest
=== RUN   TestHandleGetUserRoleRequest/Success_-_role_found
2025/05/31 09:01:17 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:17  Creating container for image postgres:16-alpine
2025/05/31 09:01:18  Container created: 7b8a4b34f23e
2025/05/31 09:01:18  Starting container: 7b8a4b34f23e
2025/05/31 09:01:18  Container started: 7b8a4b34f23e
2025/05/31 09:01:18  Waiting for container id 7b8a4b34f23e image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc0009d25a0 Strategies:[0xc000c1ac30]}
2025/05/31 09:01:21  Container is ready: 7b8a4b34f23e
2025/05/31 09:01:21 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39007/testdb?sslmode=disable
2025/05/31 09:01:21 Starting NATS container with resource limits...
2025/05/31 09:01:21  Creating container for image nats:2.10-alpine
2025/05/31 09:01:21  Container created: 179d7a506226
2025/05/31 09:01:21  Starting container: 179d7a506226
2025/05/31 09:01:22  Container started: 179d7a506226
2025/05/31 09:01:22  Waiting for container id 179d7a506226 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000d105c8 Strategies:[0xc000c6bce0 0xc0007aaf60]}
2025/05/31 09:01:23  Container is ready: 179d7a506226
2025/05/31 09:01:23 NATS container started with resource limits. URL: nats://localhost:39014
Creating user table...
User table created successfully!
2025/05/31 09:01:23 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:23 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:23 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:23 Ran leaderboard migrations group #4
2025/05/31 09:01:23 All migrations ran successfully
2025/05/31 09:01:23 newDBServiceWithDB - Registering models
2025/05/31 09:01:23 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:23 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000682288 RoundDB:0xc000682298 ScoreDB:0xc0006822a0 LeaderboardDB:0xc0006822a8 db:0xc00068e400}
2025/05/31 09:01:23 Truncating tables: users
2025/05/31 09:01:23 Truncating tables: users
    user_retrieval_test.go:321: Waiting for 1 messages on topic "discord.user.role.get.response" with timeout 5s
2025/05/31 09:01:24 Test received message 0f3352b2-203a-407c-b76f-d8603291478a on topic "discord.user.role.get.response"
    user_retrieval_test.go:321: Successfully received 1 messages on topic "discord.user.role.get.response"
2025/05/31 09:01:24 Test Case "TestHandleGetUserRoleRequest/Success_-_role_found": Canceling subscription context.
2025/05/31 09:01:24 Test Case "TestHandleGetUserRoleRequest/Success_-_role_found": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:24 Test Case "TestHandleGetUserRoleRequest/Success_-_role_found": Subscriber goroutines finished.
2025/05/31 09:01:24 Running user handler test cleanup...
2025/05/31 09:01:25 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:01:25 User handler router goroutine finished.
2025/05/31 09:01:25 User handler test cleanup finished.
2025/05/31 09:01:25 Cleaning up test environment...
2025/05/31 09:01:25 Context cancelled.
2025/05/31 09:01:25 EventBus closed.
2025/05/31 09:01:25 NATS connection closed.
2025/05/31 09:01:25 DB connection closed.
2025/05/31 09:01:25  Stopping container: 179d7a506226
2025/05/31 09:01:26  Container stopped: 179d7a506226
2025/05/31 09:01:26  Terminating container: 179d7a506226
2025/05/31 09:01:26  Container terminated: 179d7a506226
2025/05/31 09:01:26 NATS container terminated.
2025/05/31 09:01:26  Stopping container: 7b8a4b34f23e
2025/05/31 09:01:26  Container stopped: 7b8a4b34f23e
2025/05/31 09:01:26  Terminating container: 7b8a4b34f23e
2025/05/31 09:01:27  Container terminated: 7b8a4b34f23e
2025/05/31 09:01:27 PostgreSQL container terminated.
2025/05/31 09:01:27 Cleanup complete.
=== RUN   TestHandleGetUserRoleRequest/Failure_-_user_for_role_not_found
2025/05/31 09:01:27 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:27  Creating container for image postgres:16-alpine
2025/05/31 09:01:27  Container created: ab2c595b42f5
2025/05/31 09:01:27  Starting container: ab2c595b42f5
2025/05/31 09:01:27  Container started: ab2c595b42f5
2025/05/31 09:01:27  Waiting for container id ab2c595b42f5 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000d11ff0 Strategies:[0xc0009c33b0]}
2025/05/31 09:01:30  Container is ready: ab2c595b42f5
2025/05/31 09:01:30 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39019/testdb?sslmode=disable
2025/05/31 09:01:30 Starting NATS container with resource limits...
2025/05/31 09:01:30  Creating container for image nats:2.10-alpine
2025/05/31 09:01:31  Container created: 2d427269a0dd
2025/05/31 09:01:31  Starting container: 2d427269a0dd
2025/05/31 09:01:31  Container started: 2d427269a0dd
2025/05/31 09:01:31  Waiting for container id 2d427269a0dd image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000b466c8 Strategies:[0xc0007b8660 0xc000bfea50]}
2025/05/31 09:01:32  Container is ready: 2d427269a0dd
2025/05/31 09:01:32 NATS container started with resource limits. URL: nats://localhost:39026
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:32 Ran leaderboard migrations group #1
Creating user table...
User table created successfully!
2025/05/31 09:01:32 Ran user migrations group #2
Creating round table...
Round table created successfully!
2025/05/31 09:01:32 Ran round migrations group #3
Creating score table...
Score table created successfully!
2025/05/31 09:01:32 Ran score migrations group #4
2025/05/31 09:01:32 All migrations ran successfully
2025/05/31 09:01:32 newDBServiceWithDB - Registering models
2025/05/31 09:01:32 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:32 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000682598 RoundDB:0xc0006825a0 ScoreDB:0xc0006825c0 LeaderboardDB:0xc0006825d8 db:0xc000142700}
2025/05/31 09:01:32 Truncating tables: users
2025/05/31 09:01:32 Truncating tables: users
    user_retrieval_test.go:321: Waiting for 1 messages on topic "discord.user.role.get.failed" with timeout 5s
2025/05/31 09:01:33 Test received message f75bd7d0-e583-4828-b627-83929c226f4b on topic "discord.user.role.get.failed"
    user_retrieval_test.go:321: Successfully received 1 messages on topic "discord.user.role.get.failed"
2025/05/31 09:01:33 Test Case "TestHandleGetUserRoleRequest/Failure_-_user_for_role_not_found": Canceling subscription context.
2025/05/31 09:01:33 Test Case "TestHandleGetUserRoleRequest/Failure_-_user_for_role_not_found": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:33 Test Case "TestHandleGetUserRoleRequest/Failure_-_user_for_role_not_found": Subscriber goroutines finished.
2025/05/31 09:01:33 Running user handler test cleanup...
2025/05/31 09:01:34 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:01:34 User handler router goroutine finished.
2025/05/31 09:01:34 User handler test cleanup finished.
2025/05/31 09:01:34 Cleaning up test environment...
2025/05/31 09:01:34 Context cancelled.
2025/05/31 09:01:34 EventBus closed.
2025/05/31 09:01:34 NATS connection closed.
2025/05/31 09:01:34 DB connection closed.
2025/05/31 09:01:34  Stopping container: 2d427269a0dd
2025/05/31 09:01:34  Container stopped: 2d427269a0dd
2025/05/31 09:01:34  Terminating container: 2d427269a0dd
2025/05/31 09:01:35  Container terminated: 2d427269a0dd
2025/05/31 09:01:35 NATS container terminated.
2025/05/31 09:01:35  Stopping container: ab2c595b42f5
2025/05/31 09:01:35  Container stopped: ab2c595b42f5
2025/05/31 09:01:35  Terminating container: ab2c595b42f5
2025/05/31 09:01:35  Container terminated: ab2c595b42f5
2025/05/31 09:01:35 PostgreSQL container terminated.
2025/05/31 09:01:35 Cleanup complete.
--- PASS: TestHandleGetUserRoleRequest (17.83s)
    --- PASS: TestHandleGetUserRoleRequest/Success_-_role_found (9.14s)
    --- PASS: TestHandleGetUserRoleRequest/Failure_-_user_for_role_not_found (8.69s)
=== RUN   TestHandleUserRoleUpdateRequest
=== RUN   TestHandleUserRoleUpdateRequest/Success_-_role_updated
2025/05/31 09:01:35 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:35  Creating container for image postgres:16-alpine
2025/05/31 09:01:35  Container created: 2845859fb0b1
2025/05/31 09:01:35  Starting container: 2845859fb0b1
2025/05/31 09:01:36  Container started: 2845859fb0b1
2025/05/31 09:01:36  Waiting for container id 2845859fb0b1 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc00061bd10 Strategies:[0xc000b59cb0]}
2025/05/31 09:01:39  Container is ready: 2845859fb0b1
2025/05/31 09:01:39 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39031/testdb?sslmode=disable
2025/05/31 09:01:39 Starting NATS container with resource limits...
2025/05/31 09:01:39  Creating container for image nats:2.10-alpine
2025/05/31 09:01:39  Container created: ff33b2bbd91b
2025/05/31 09:01:39  Starting container: ff33b2bbd91b
2025/05/31 09:01:40  Container started: ff33b2bbd91b
2025/05/31 09:01:40  Waiting for container id ff33b2bbd91b image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000e81c00 Strategies:[0xc000b4ecc0 0xc000b0ed50]}
2025/05/31 09:01:41  Container is ready: ff33b2bbd91b
2025/05/31 09:01:41 NATS container started with resource limits. URL: nats://localhost:39038
Creating score table...
Score table created successfully!
2025/05/31 09:01:41 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:41 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:01:41 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:01:41 Ran round migrations group #4
2025/05/31 09:01:41 All migrations ran successfully
2025/05/31 09:01:41 newDBServiceWithDB - Registering models
2025/05/31 09:01:41 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:41 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007ccb8 RoundDB:0xc00007ccc0 ScoreDB:0xc00007ccc8 LeaderboardDB:0xc00007ccd0 db:0xc000446c00}
2025/05/31 09:01:41 Truncating tables: users
2025/05/31 09:01:41 Truncating tables: users
    user_role_test.go:249: Waiting for 1 messages on topic "discord.user.role.updated" with timeout 5s
2025/05/31 09:01:42 Test received message 5e8a5bdb-ed9c-4f08-985e-f7cbb3240152 on topic "discord.user.role.updated"
    user_role_test.go:249: Successfully received 1 messages on topic "discord.user.role.updated"
2025/05/31 09:01:42 Test Case "TestHandleUserRoleUpdateRequest/Success_-_role_updated": Canceling subscription context.
2025/05/31 09:01:42 Test Case "TestHandleUserRoleUpdateRequest/Success_-_role_updated": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:42 Test Case "TestHandleUserRoleUpdateRequest/Success_-_role_updated": Subscriber goroutines finished.
2025/05/31 09:01:42 Running user handler test cleanup...
2025/05/31 09:01:43 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:01:43 User handler router goroutine finished.
2025/05/31 09:01:43 User handler test cleanup finished.
2025/05/31 09:01:43 Cleaning up test environment...
2025/05/31 09:01:43 Context cancelled.
2025/05/31 09:01:43 EventBus closed.
2025/05/31 09:01:43 NATS connection closed.
2025/05/31 09:01:43 DB connection closed.
2025/05/31 09:01:43  Stopping container: ff33b2bbd91b
2025/05/31 09:01:44  Container stopped: ff33b2bbd91b
2025/05/31 09:01:44  Terminating container: ff33b2bbd91b
2025/05/31 09:01:44  Container terminated: ff33b2bbd91b
2025/05/31 09:01:44 NATS container terminated.
2025/05/31 09:01:44  Stopping container: 2845859fb0b1
2025/05/31 09:01:44  Container stopped: 2845859fb0b1
2025/05/31 09:01:44  Terminating container: 2845859fb0b1
2025/05/31 09:01:44  Container terminated: 2845859fb0b1
2025/05/31 09:01:44 PostgreSQL container terminated.
2025/05/31 09:01:44 Cleanup complete.
=== RUN   TestHandleUserRoleUpdateRequest/Failure_-_invalid_role
2025/05/31 09:01:44 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:44  Creating container for image postgres:16-alpine
2025/05/31 09:01:45  Container created: 850d6a24d158
2025/05/31 09:01:45  Starting container: 850d6a24d158
2025/05/31 09:01:45  Container started: 850d6a24d158
2025/05/31 09:01:45  Waiting for container id 850d6a24d158 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000b47760 Strategies:[0xc000f0a840]}
2025/05/31 09:01:48  Container is ready: 850d6a24d158
2025/05/31 09:01:48 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39043/testdb?sslmode=disable
2025/05/31 09:01:48 Starting NATS container with resource limits...
2025/05/31 09:01:48  Creating container for image nats:2.10-alpine
2025/05/31 09:01:48  Container created: 76a7de838ffc
2025/05/31 09:01:48  Starting container: 76a7de838ffc
2025/05/31 09:01:49  Container started: 76a7de838ffc
2025/05/31 09:01:49  Waiting for container id 76a7de838ffc image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000d11ed8 Strategies:[0xc000c11c20 0xc0004a0b70]}
2025/05/31 09:01:50  Container is ready: 76a7de838ffc
2025/05/31 09:01:50 NATS container started with resource limits. URL: nats://localhost:39050
Creating score table...
Score table created successfully!
2025/05/31 09:01:50 Ran score migrations group #1
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:50 Ran leaderboard migrations group #2
Creating user table...
User table created successfully!
2025/05/31 09:01:50 Ran user migrations group #3
Creating round table...
Round table created successfully!
2025/05/31 09:01:50 Ran round migrations group #4
2025/05/31 09:01:50 All migrations ran successfully
2025/05/31 09:01:50 newDBServiceWithDB - Registering models
2025/05/31 09:01:50 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:50 newDBServiceWithDB - DBService initialized: &{UserDB:0xc000618688 RoundDB:0xc000618690 ScoreDB:0xc000618698 LeaderboardDB:0xc0006186a0 db:0xc00068e9c0}
2025/05/31 09:01:50 Truncating tables: users
2025/05/31 09:01:50 Truncating tables: users
    user_role_test.go:249: Waiting for 1 messages on topic "discord.user.role.update.failed" with timeout 5s
2025/05/31 09:01:51 Test received message 417b1842-b0aa-40fb-a60a-32084936d3c2 on topic "discord.user.role.update.failed"
    user_role_test.go:249: Successfully received 1 messages on topic "discord.user.role.update.failed"
2025/05/31 09:01:51 Test Case "TestHandleUserRoleUpdateRequest/Failure_-_invalid_role": Canceling subscription context.
2025/05/31 09:01:51 Test Case "TestHandleUserRoleUpdateRequest/Failure_-_invalid_role": Waiting for subscriber goroutines to finish.
2025/05/31 09:01:51 Test Case "TestHandleUserRoleUpdateRequest/Failure_-_invalid_role": Subscriber goroutines finished.
2025/05/31 09:01:51 Running user handler test cleanup...
2025/05/31 09:01:52 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:01:52 User handler router goroutine finished.
2025/05/31 09:01:52 User handler test cleanup finished.
2025/05/31 09:01:52 Cleaning up test environment...
2025/05/31 09:01:52 Context cancelled.
2025/05/31 09:01:52 EventBus closed.
2025/05/31 09:01:52 NATS connection closed.
2025/05/31 09:01:52 DB connection closed.
2025/05/31 09:01:52  Stopping container: 76a7de838ffc
2025/05/31 09:01:53  Container stopped: 76a7de838ffc
2025/05/31 09:01:53  Terminating container: 76a7de838ffc
2025/05/31 09:01:53  Container terminated: 76a7de838ffc
2025/05/31 09:01:53 NATS container terminated.
2025/05/31 09:01:53  Stopping container: 850d6a24d158
2025/05/31 09:01:53  Container stopped: 850d6a24d158
2025/05/31 09:01:53  Terminating container: 850d6a24d158
2025/05/31 09:01:53  Container terminated: 850d6a24d158
2025/05/31 09:01:53 PostgreSQL container terminated.
2025/05/31 09:01:53 Cleanup complete.
=== RUN   TestHandleUserRoleUpdateRequest/Failure_-_user_not_found
2025/05/31 09:01:53 Starting PostgreSQL container with resource limits...
2025/05/31 09:01:53  Creating container for image postgres:16-alpine
2025/05/31 09:01:53  Container created: 377229569ce2
2025/05/31 09:01:53  Starting container: 377229569ce2
2025/05/31 09:01:54  Container started: 377229569ce2
2025/05/31 09:01:54  Waiting for container id 377229569ce2 image: postgres:16-alpine. Waiting for: &{timeout:<nil> deadline:0xc000285df8 Strategies:[0xc0009c3d40]}
2025/05/31 09:01:56  Container is ready: 377229569ce2
2025/05/31 09:01:56 PostgreSQL container started with resource limits and init script. URL: postgres://testuser:testpass@localhost:39055/testdb?sslmode=disable
2025/05/31 09:01:56 Starting NATS container with resource limits...
2025/05/31 09:01:56  Creating container for image nats:2.10-alpine
2025/05/31 09:01:57  Container created: 843450068a24
2025/05/31 09:01:57  Starting container: 843450068a24
2025/05/31 09:01:57  Container started: 843450068a24
2025/05/31 09:01:57  Waiting for container id 843450068a24 image: nats:2.10-alpine. Waiting for: &{timeout:<nil> deadline:0xc000389058 Strategies:[0xc000aa63c0 0xc000a9e240]}
2025/05/31 09:01:59  Container is ready: 843450068a24
2025/05/31 09:01:59 NATS container started with resource limits. URL: nats://localhost:39061
Creating user table...
User table created successfully!
2025/05/31 09:01:59 Ran user migrations group #1
Creating round table...
Round table created successfully!
2025/05/31 09:01:59 Ran round migrations group #2
Creating score table...
Score table created successfully!
2025/05/31 09:01:59 Ran score migrations group #3
Creating leaderboard table...
Leaderboard table created successfully!
2025/05/31 09:01:59 Ran leaderboard migrations group #4
2025/05/31 09:01:59 All migrations ran successfully
2025/05/31 09:01:59 newDBServiceWithDB - Registering models
2025/05/31 09:01:59 newDBServiceWithDB - Models registered successfully
2025/05/31 09:01:59 newDBServiceWithDB - DBService initialized: &{UserDB:0xc00007cc20 RoundDB:0xc00007cc28 ScoreDB:0xc00007cc30 LeaderboardDB:0xc00007cc40 db:0xc0007a8dc0}
2025/05/31 09:01:59 Truncating tables: users
2025/05/31 09:01:59 Truncating tables: users
    user_role_test.go:249: Waiting for 1 messages on topic "discord.user.role.update.failed" with timeout 5s
2025/05/31 09:02:00 Test received message 36d4aeb2-845a-4671-8945-f0f5654be8a4 on topic "discord.user.role.update.failed"
    user_role_test.go:249: Successfully received 1 messages on topic "discord.user.role.update.failed"
2025/05/31 09:02:00 Test Case "TestHandleUserRoleUpdateRequest/Failure_-_user_not_found": Canceling subscription context.
2025/05/31 09:02:00 Test Case "TestHandleUserRoleUpdateRequest/Failure_-_user_not_found": Waiting for subscriber goroutines to finish.
2025/05/31 09:02:00 Test Case "TestHandleUserRoleUpdateRequest/Failure_-_user_not_found": Subscriber goroutines finished.
2025/05/31 09:02:00 Running user handler test cleanup...
2025/05/31 09:02:01 Error closing User module: error closing UserRouter: router close timeout
2025/05/31 09:02:01 User handler router goroutine finished.
2025/05/31 09:02:01 User handler test cleanup finished.
2025/05/31 09:02:01 Cleaning up test environment...
2025/05/31 09:02:01 Context cancelled.
2025/05/31 09:02:01 EventBus closed.
2025/05/31 09:02:01 NATS connection closed.
2025/05/31 09:02:01 DB connection closed.
2025/05/31 09:02:01  Stopping container: 843450068a24
2025/05/31 09:02:02  Container stopped: 843450068a24
2025/05/31 09:02:02  Terminating container: 843450068a24
2025/05/31 09:02:02  Container terminated: 843450068a24
2025/05/31 09:02:02 NATS container terminated.
2025/05/31 09:02:02  Stopping container: 377229569ce2
2025/05/31 09:02:02  Container stopped: 377229569ce2
2025/05/31 09:02:02  Terminating container: 377229569ce2
2025/05/31 09:02:02  Container terminated: 377229569ce2
2025/05/31 09:02:02 PostgreSQL container terminated.
2025/05/31 09:02:02 Cleanup complete.
--- PASS: TestHandleUserRoleUpdateRequest (26.85s)
    --- PASS: TestHandleUserRoleUpdateRequest/Success_-_role_updated (9.12s)
    --- PASS: TestHandleUserRoleUpdateRequest/Failure_-_invalid_role (8.65s)
    --- PASS: TestHandleUserRoleUpdateRequest/Failure_-_user_not_found (9.08s)
PASS
coverage: 8.6% of statements in ./app/...
2025/05/31 09:02:02 TestMain: finished with exit code: 0
ok  	github.com/Black-And-White-Club/frolf-bot/integration_tests/modules/user/handler_tests	166.358s	coverage: 8.6% of statements in ./app/...
?   	github.com/Black-And-White-Club/frolf-bot/integration_tests/testutils	[no test files]
FAIL
